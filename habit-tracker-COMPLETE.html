<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a12">
  <title>Habit Tracker</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #0a0a12;
      color: #fff;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    input, textarea, select, button {
      font-family: inherit;
      color: inherit;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 8px;
      padding: 8px 12px;
      outline: none;
    }
    input:focus, textarea:focus, select:focus {
      border-color: #c9a227;
      background: rgba(255,255,255,0.08);
    }
    button { cursor: pointer; transition: all 0.2s; }
    button:hover { opacity: 0.8; }
    textarea { resize: vertical; min-height: 60px; }
    .habit-row {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 11px 14px;
      background: rgba(255,255,255,0.025);
      border: 1.5px solid rgba(255,255,255,0.07);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .habit-row:hover {
      background: rgba(255,255,255,0.04);
      border-color: rgba(255,255,255,0.12);
    }
    .card {
      background: rgba(255,255,255,0.025);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      padding: 14px 16px;
      margin-bottom: 10px;
    }
    .loge {
      background: rgba(255,255,255,0.025);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .loge:hover {
      background: rgba(255,255,255,0.04);
      border-color: rgba(255,255,255,0.1);
    }
    .nav-btn {
      background: none;
      border: none;
      padding: 8px 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      cursor: pointer;
      transition: all 0.2s;
    }
    #root { max-width: 100vw; margin: 0 auto; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;
    
// â”€â”€â”€ ALL 2026 JOURNAL DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const JOURNAL_DATA = {
  "2026-01-01": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Cleaned and cooked for everyone after New Year's Eve", gratitude: ["Liz and a fresh start", "Family gathering", "A clean home"], affirmation: "", finance: false, retainer: true, floss: false, workWin: "Hosted New Year's gathering, set intentions for 2026", workoutDetails: "", notes: "Cut up Charlie's food. Cooked scrambled eggs, bacon, hash browns & pancakes. 4 loads of laundry. Watched CFB playoffs.", mood: 8 },
  "2026-01-02": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["First easy day back at work", "Good team energy", "Charlie"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Discussed standardizing custom opportunity tracking, Salesforce/DBSync improvements, Jira re-integration", workoutDetails: "", notes: "First day back at office. Caught up with team. Discussed strategy with Dan.", mood: 7 },
  "2026-01-03": { workout: true, water: 7, reading: 40, journal: true, meditation: false, mitzvah: "Quality time with Holden & Emily", gratitude: ["Finished HTWFAIP", "Home gym", "Good friends"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Shoulders: 3Ã—10 seated military press, reverse butterflies, bent-over raises, 25lb drive the bus, straight-arm front raises", notes: "Finished 'How to Win Friends & Influence People'. Read 40+ pages of The 5AM Club. Ninja Sushi with Holden & Emily.", mood: 9, bookPages: 40, bookTitle: "The 5AM Club" },
  "2026-01-04": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Dropped off clothes for Caleb before he went back to dental school", gratitude: ["Family", "Home organization", "Myles Garrett NFL record"], affirmation: "", finance: true, retainer: false, floss: false, workWin: "Updated monthly expense tracking Excel, paid all bills & credit cards", workoutDetails: "Legs: Free squats (30 warmup), kettlebell squats w/ drop sets (25LBâ†’35LB), deadlifts (3Ã—10 adding 10LB each), calf raises 3Ã—30-40", notes: "Updated expense tracker. Set up tower speakers in basement with optical AV cable. Myles Garrett 23rd sack NFL record.", mood: 8 },
  "2026-01-05": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Cleaned kitchen for Liz. Gave dad & Liz compliments.", gratitude: ["Home gym", "Solid workouts 3 days in a row", "Liz"], affirmation: "I am grateful. I am forgiving. I am giving. My life is beautiful, creative, productive, prosperous and magical.", finance: false, retainer: false, floss: true, workWin: "Created all new 2026 Salesforce reports & dashboards. Monday meeting minutes. East Region dashboards.", workoutDetails: "Chest & Tris: DB chest press (20Ã—30, 18Ã—40, 15Ã—50LB), butterflies 3Ã—10 20LB, upper chest cable 3Ã—10 20LB, tricep preacher curls EZ bar 3Ã—10, tricep pulldown 4Ã—10 20LB", notes: "First full week back. Stomach felt off. Liz made crock pot salsa chicken burrito bowls.", mood: 7 },
  "2026-01-06": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Trained Liz in the home gym workout", gratitude: ["Liz worked out with me", "Matt (sorry for loss)", "Dave and the challenges he brings"], affirmation: "This day and year marks an evolution in my being. I am tuned in.", finance: false, retainer: false, floss: false, workWin: "Handled Mike's partial case deal. Created Google Maps of all customers & prospects. Cold calling training with Dave & Cole.", workoutDetails: "Back with Liz: Lat pulldown 3Ã—10 (60/70/90LB), seated rows 3Ã—10 (60/70/90LB), pull-up lat pulldowns 3Ã—10, bent over DB rows 3Ã—10 30LB", notes: "Started gratitude practice. Feeling evolution coming. Dave challenges. Matt's godmother passed away.", mood: 9 },
  "2026-01-07": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Give me more levels!", "Liz didn't get fired", "Progress at work"], affirmation: "Get comfortable being uncomfortable.", finance: false, retainer: false, floss: false, workWin: "Gameplanned Verano deal with Mike. Google reviews strategy with Jalen. Schedule 3 positioning for Grove Bags. Built leadership meeting slides with Dan.", workoutDetails: "", notes: "First leadership meeting slides prep. Excited/nervous about tomorrow. 3-6:30pm with Dan on Tableau.", mood: 8 },
  "2026-01-08": { workout: false, water: 5, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Career progression â€” started nervous, finished strong", "Developing relationship with Lance", "JJ â€” genuinely good person"], affirmation: "I know what I'm doing, I have a solid plan, and this will work if I own it.", finance: false, retainer: false, floss: false, workWin: "First leadership meeting at Union Club. Presented 2026 Rocks. Covered best practices, trials, data accountability. Dinner with Lance at Li Wah.", workoutDetails: "", notes: "Union Club leadership meeting. Shaky start, finished strong. Biannual performance review discussion. Lance dinner - solid relationship building.", mood: 9 },
  "2026-01-09": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Sent flowers to Mike V whose family member passed away", gratitude: ["Evan's amazing gift", "Matt winning employee of the year", "The whole team & great holiday party"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Presented annual rocks to full sales & marketing team. Helped team finish orders. Got Lance Random Access Memories by Daft Punk on vinyl.", workoutDetails: "", notes: "Holiday party â€” everyone had best time. Matt won employee of the year. Chris in town at Barley after.", mood: 9 },
  "2026-01-10": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Put Shane through a workout â€” investing in his confidence & consistency", gratitude: ["The Davis family", "Sarah & Ari", "Braelyn"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Biceps: Wide grip barbell 3Ã—10 45LB, EZ bar wide/close 3Ã—10 45+10LB, reverse curl 3Ã—10 45+5LB, DB curls 3Ã—10 20LB, GHD curls, cable curls, pro/supinated rotations 8LB", notes: "Shane came over to work out. Game night at parents â€” Hitster & Rummikub.", mood: 8 },
  "2026-01-11": { workout: true, water: 7, reading: 20, journal: true, meditation: false, mitzvah: "Gave Mike good advice about the jar situation", gratitude: ["My parents", "Charlie", "Mike Henderson"], affirmation: "Strong leadership is a force multiplier.", finance: false, retainer: false, floss: false, workWin: "Watered house plants. Read leadership article on force multiplication. Gave Mike solid advice.", workoutDetails: "Shoulders: 5LB rotations 3Ã—10, DB military press (30/40LB), bent over extensions 35LB 3Ã—10, drive the bus 25LB, rear delt raises 8LB, front raises cable 5LB, lateral series 30/20/5LB", notes: "Liz made eggs & hashbrowns. Watched playoffs. Read Admired Leadership article. Chicken parm at parents.", mood: 8, bookPages: 20, bookTitle: "The 5AM Club" },
  "2026-01-12": { workout: true, water: 6, reading: 30, journal: true, meditation: false, mitzvah: "Positivity with Mike", gratitude: ["Dad â€” the fucking man", "Mike â€” relentless optimism", "Liz â€” patience and another bomb dinner"], affirmation: "It's a NEW DAY FULL OF OPPORTUNITY! I'll continue growing, advancing my career, and I'll be BEYOND SUCCESSFUL!", finance: false, retainer: false, floss: false, workWin: "Handled comp plan discussion with class & professionalism. Accepted outcome. Started Q1 rocks early.", workoutDetails: "Legs: Free squats ~40, KB squats 35LB (15+drop sets), deadlifts 95/115/135LB 3Ã—10, monkey feet hamstring curls 5LB 3Ã—10, calf raises 3Ã—20", notes: "Comp plan conversation with Dan. Dad upset but supportive. Read 'Elite production without quiet vacation causes lasting depletion.'", mood: 7, bookPages: 30, bookTitle: "The 5AM Club" },
  "2026-01-13": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Grove Bags is fortunate to receive the work & professionalism I bring", gratitude: ["Brent â€” appreciated sense of urgency", "Shane â€” working out again", "Mom dropped off my pills"], affirmation: "On the tough days I'll use it as inspiration.", finance: false, retainer: false, floss: false, workWin: "First leadership/traction call. East Move the Needle meeting. Completed custom dashboards & KPI trackers. Assigned team tasks.", workoutDetails: "Chest & Tris with Shane: DB chest press (30/40/50LB), barbell bench (45/65/85LB), EZ skull crushers 3Ã—10 45LB, butterflies/barrel 3Ã—10 20LB, low cable fly, rope pulldown, triangle grip", notes: "Brent rated meeting 9.75/10. Tension with Liz over vacation discussion.", mood: 7 },
  "2026-01-14": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Called Ilan and caught up despite past differences", gratitude: ["Lindsi â€” said I'm motivational", "Ilan â€” baby boy congrats, JBall league", "Jalen â€” great work meeting & heart to heart"], affirmation: "There is a tsunami of success I am excited to receive!", finance: false, retainer: false, floss: false, workWin: "Matt & Lindsi reviews â€” both positive. SF sync audit with Dan. B2B/B2C marketing strategy with Jalen. 'Store your weed here' campaign â€” Jalen's eyes lit up.", workoutDetails: "Back with Shane: Lat pulldown 3Ã—10 (70/80/90LB), Double D rows (70/80/90LB), reverse grip + bent over rows superset, barbell rows (45/65/75LB), DB rows with twist 3Ã—10 30LB", notes: "Feeling like caterpillar â†’ butterfly transformation. Parallels to basketball journey in 7th-8th grade.", mood: 9 },
  "2026-01-15": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Reached out to Cameron Tamjidi after ~7 years â€” offered support", gratitude: ["Cameron hopefully doing better", "Meatball & Shane + fixed electrical panel", "The discipline I'm cultivating"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Full WFH snow day 8:45-9pm. Caught up on all emails. Put Shane & Meatball through shoulder workout while working.", workoutDetails: "", notes: "Snow day â€” foot of snow. Shoveled 1.5 hours. Liz out for Blake's birthday.", mood: 7 },
  "2026-01-16": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Called Meatball and thanked him, offered gym access anytime", gratitude: ["Julie (Liz's mom)", "Trump doing solid job", "UFC starting Paramount+ deal"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Solid sales momentum building. Drove to Cincinnati.", workoutDetails: "", notes: "Drove to Cinci to visit Liz's family. Political debates in the car â€” honestly fun.", mood: 7 },
  "2026-01-17": { workout: true, water: 5, reading: 0, journal: true, meditation: false, mitzvah: "Went to Joe & Shelby's wedding even when exhausted. Went to Erika's after.", gratitude: ["Michael", "Evie", "Linus â€” very nice taking us home"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Shoulders at Planet Fitness: 5LB rotations 2 ways, military press (14Ã—35/2Ã—10 45LB), EZ real felt raise 35LB, EZ bar pull to chin 35LB, seated T's 15LB, drive the bus 25LB, seated curls 25LB, hands together raise 25LB, lateral raise machine 25/20/15LB, rope 25/20/15LB, oblique raises, straight leg raises, 5 pull-ups", notes: "Planet Fitness â†’ lunch at Oak Tavern â†’ Joe & Shelby's wedding â†’ Erika's bday at Oak Tavern.", mood: 8 },
  "2026-01-18": { workout: false, water: 4, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Liz", "Our home", ""], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "", notes: "Bagels/lox breakfast at Allison & Linus's. Rough stomach. Drove back to Cleveland. Bears vs Rams overtime thriller.", mood: 6 },
  "2026-01-19": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["A day off to think & invest", "Bluetooth speaker app idea", "MLK Jr."], affirmation: "", finance: true, retainer: false, floss: false, workWin: "Researched SoundSeeder bluetooth app. Recapped 2025 financials. Updated 2026 investment strategy: S&P500 focus, BTC/ETH crypto.", workoutDetails: "Legs with Liz: Squats BW & 25LB KB (4 sets), back squat (45/65/85LB), deadlifts (95/115/135LB), calf raises 3Ã—20-30, lunges superset, medicine ball balance 1 min each foot", notes: "MLK Jr. Day. Researched bluetooth speaker app idea. Financial planning session.", mood: 7 },
  "2026-01-20": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Bought Liz flowers and complimented Trader Joe's cashier on their glasses", gratitude: ["Work â€” East off to hot start", "Liz â€” my valentine", "Shane â€” staying consistent"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Leadership traction call + Monday sales call. SF meeting set. DBSync follow-up planned.", workoutDetails: "Chest & Tris with Shane: DB press + reverse grip bench superset (40/50LB + 95LB), skull crushers 3Ã—10 45LB, flys & barrel press 3Ã—10 20LB, triangle grip pulldown 30LB, rope pulldown 20LB", notes: "Went to Trader Joes to buy Liz flowers. Liz made chili & cornbread. Watched rest of KillTony Netflix special.", mood: 8 },
  "2026-01-21": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Something nice â€” can't remember lol", gratitude: ["Liz", "Domas", "Jon â€” makes life easy"], affirmation: "I believe in the law of attraction, manifestation, and creating from a higher vibration.", finance: false, retainer: false, floss: false, workWin: "Created cross-department initiative tracker. Downloaded Jira board with Gemini to categorize. Good 1:1 with Dave & Jack.", workoutDetails: "", notes: "Very productive meeting-heavy day. Jack asked 'magic wand' question â€” answered beautifully about the journey.", mood: 9 },
  "2026-01-22": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["The work being done", "Dan", "Progress"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Spent 3hrs with Dan on custom & lead process dashboards. SF updated. Dave near-loss customer situation handled.", workoutDetails: "Back with Shane: Lat pulldown (70/90/110LB), D Bar rows (70/90/110LB), supinated lat pulldown (50/70/90LB), DB rows with twist 3Ã—10 30LB, GHD back extensions (15/13/13 reps)", notes: "Eventful day. Dan and I grinding on dashboards.", mood: 7 },
  "2026-01-23": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Bringing John to the Cavs game", gratitude: ["Domas â€” great game, humble & down to earth", "Funderburke â€” invited to fundraiser", "Shashana"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Cole review â€” went very well. Friday sales team call. Strategy meeting with Jake/Jon/Lindsi/Cole on lead lists.", workoutDetails: "", notes: "Cole review. Cavs game with John â€” Domas had a great game. Met Leandro Barbosa & Lawrence Funderburke. Dad & Shane there too.", mood: 9 },
  "2026-01-24": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Saturday vibes", "Shane", "Liz"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Biceps with Shane: Wide grip barbell 3Ã—10 45LB, EZ bar inner/outer 3Ã—10 (35/45/45LB), reverse EZ 3Ã—10 35LB, 5LB rotations 3Ã—20, DB curls (30LB 10-20 reps), cable curls 3Ã—10 10LB, 25LB plate holds (50s/30s/1min)", notes: "Slept in, talked with Holden, Shane came over. Liz and Charlie watched. UFC commentary.", mood: 7 },
  "2026-01-25": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Rest day vibes", "Working out together", "Home"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Shoulders with Liz: Military press (14Ã—30/10Ã—40/10Ã—40LB), seated lateral raises 3Ã—10 2LB, lying lateral raises 3Ã—10 5-8LB, behind-back barbell 3Ã—10 35LB, front cable raise 3Ã—10 20LB, EZ bar raises 3Ã—10 55LB, standing lat raise 30Â° 3Ã—10 30LB, 90Â° 3Ã—10 10LB, >90Â° 3Ã—10 5LB, drive the bus 3Ã—10 25LB, rotations 3Ã—10 5LB, GHD abs & obliques", notes: "Shoveled driveway ~1.5hrs. Read UFC commentary.", mood: 7 },
  "2026-01-26": { workout: false, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Liz shoveling and making dinner", "Brad â€” said he'd come help", "Mom â€” always looking out"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "WFH snow day 8:30-6pm. Full focus mode â€” caught up on ALL emails. Totally locked in.", workoutDetails: "", notes: "Another snow storm WFH. Pure locked-in focus day. Felt amazing.", mood: 9 },
  "2026-01-29": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Getting back at it", "Shane showing up", "Leg day progress"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Legs with Shane: BW squats 30, KB squats 25LB (4 sets w/ drops), back squat (45/95/115/135LB 10-8-10-10 reps), deadlifts (45/95/115/135LB 4Ã—10), calf raises 3Ã—25 BW", notes: "Back after a little hiatus. Hitting legs with Shane.", mood: 7 },
  "2026-01-30": { workout: false, water: 5, reading: 0, journal: true, meditation: false, mitzvah: "Teaching Chris about financial plans & long-term career thinking", gratitude: ["Jack â€” everything he did that night", "Chris â€” great friend", "Joe Orvek â€” comped the meal"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Natural history museum event. Town Hall dinner (Joe Orvek comped). Jack bought table at Lost.", workoutDetails: "", notes: "Dan told Matt & me we were selected for Calyx lawsuit deposition. Night out with Chris, Baylee, Blake, Julian, JJ, Jack. Up until 3am.", mood: 7 },
  "2026-01-31": { workout: false, water: 4, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Watching Volk fight", "Liz", "Our home â€” nice to take 2 naps"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "", notes: "Two naps. Shane no-showed. Burger King disaster (45 min wait, left, got refund). Made French onion soup & pizza. Watched UFC 325 â€” Ruffy beat Fiziev, Hooker TKO loss.", mood: 5 },
  "2026-02-01": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Helped mom cook. Cooked for the family.", gratitude: ["Mom", "Charlie", "Shane"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Picked up chicken/produce for family dinner.", workoutDetails: "Chest & Tris with Liz: DB chest press 4 sets (20Ã—30/16Ã—40/14Ã—50/12Ã—50LB), supinated barbell (45/95/105/115LB), flys + barrel press 3Ã—10 20LB, skull crushers 3Ã—10 45LB, low cable fly + rope pulldown superset, triangle pulldown 3Ã—10 40LB, high cable fly 3Ã—10, GHD abs/obliques 3Ã—8", notes: "Worked out with Liz. Dinner at parents. Mom clipped my nails.", mood: 8 },
  "2026-02-02": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Training Shane", gratitude: ["Liz making another bomb dinner", "Challenges â€” constantly growing", "Shane â€” staying consistent"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Calypso meeting with Mike. Monday sales minutes. Deposition call with lawyers. First Move the Needle meeting with new Tableau reports.", workoutDetails: "Back with Shane: Lat pulldown (50/70/90LB 14-12-10 reps), Double D rows (70/90/110LB 14-10-10 reps), bent over barbell rows 3Ã—10 95LB, double handle cable (50/60/70LB), back extensions 3Ã—10 BW", notes: "Deposition confirmed. Liz made dinner. Journaled after.", mood: 8 },
  "2026-02-03": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Going to pack Mike coffee tomorrow", gratitude: ["Basketball community", "Another day making it happen", "The momentum I'm building"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Leadership call 10-11am. Ops call. Blue Harvest call with Lindsi â€” successful. Interview with Joe Z. Tableau reporting. West Move the Needle meeting. Bench PR: 1Ã—175LB!", workoutDetails: "Biceps with Shane: Barbell curls 3Ã—10 (45/55/55LB), EZ bar inner/outer 3Ã—10 each 45LB, reverse EZ 3Ã—10 (35/45/45LB), DB curls 3Ã—10 20LB, cable curls 3Ã—10 10LB, rotations 3Ã—15 8LB. Bench press: 20Ã—45 / 10Ã—95 / 3Ã—135 / 5Ã—155 / 1Ã—175LB ðŸ”¥", notes: "Going to start waking up earlier. 7:15 the last two days â€” improvement.", mood: 8 },
  "2026-02-04": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Meatball â€” coming to work out", "Matt â€” crushing it", "Dan â€” great help"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "SF chatter notifications configured. CH Robinson training course. Cannabist call with Matt & Dave â€” successful, expanding Fresh Frozen.", workoutDetails: "Shoulders with Meatball & Shane: Military press 3Ã—10 40LB, seated delt raise 3Ã—10 20LB, EZ bar reverse delt raise 3Ã—10 35LB, drive the bus 3Ã—10 25LB, laying delt raise 3Ã—10 8LB, EZ bar pull front 3Ã—10 45LB, lateral series (30LB partial/10LB 90Â°/5LB >90Â°), cable pull front delt 3Ã—10 5LB, rotations 3Ã—10 5LB", notes: "Figured out SF chatter â†’ email notifications. Trained Jon on Fresh Frozen / Safevac. Abbott episode with Liz.", mood: 8 },
  "2026-02-05": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Gave Mike and Lindsi Marley coffee", gratitude: ["Rocket League + Liz letting me play", "Costco â€” great place", "Dan â€” don't credit enough"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Walked Cole & Lindsi through custom consultation areas. China/design meeting with John & Dan. Budget meeting â€” implementing trip form. Helped sticker bags.", notes: "No workout. Costco run. Rocket League with Holden.", mood: 7 },
  "2026-02-06": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Helping Jake with relationship issues & being understanding", gratitude: ["Jalen â€” great working relationship", "Jake â€” hope the best", "Myself and the consistency I'm building"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Transferred accounts from Mike to Lindsi/Jake. Rootdown (MS) new customer onboarded. Good traction with Suncrafted (MA). 1:1 with Jalen.", workoutDetails: "Legs with Shane: Squats heels raised (30 BW, 3 sets 25LB + drops), back squat (45/95/115/135LB 4Ã—10), hamstring curl (35/25/30LB), deadlifts (95/115/135LB 3Ã—10), quad curls (40/60/60/40LB), calf raises 3Ã—30 BW", notes: "Solid Friday momentum. Chill day.", mood: 8 },
  "2026-02-07": { workout: true, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["A good workout", "Charlie", "Weekend"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Chest: DB press 4 sets (16Ã—40/14Ã—50/12Ã—50/10Ã—50LB), DB flys + barrel press superset 3 sets 16LB, high cable fly 3Ã—10 10LB, low cable fly 3Ã—10 10LB, incline DB press (10Ã—30/10Ã—40/15Ã—40LB)", notes: "Cleaned house. Shoveled area for Charlie. Picked him up. Worked out with Liz.", mood: 7 },
  "2026-02-08": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "Let someone check out in front of me in line at the grocery store", gratitude: ["Julian â€” great person and friend", "John â€” good dude", "Charlie â€” best dog in the world"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Super Bowl watch party with John & Julian. Healthy snack spread. Good bonding with leadership team.", workoutDetails: "Triceps: Reverse grip bench (45LB warmup, 3Ã—10 95LB), skull crushers wide/inner 3Ã—10 each 45LB, rope pulldowns (20/25/30LB 10 reps), parallete dips to failure (20/15/20 reps), triangle pulldown 3Ã—10 40LB, pronated cable 3Ã—10 10LB, supinated cable 3Ã—10 5LB", notes: "Lazy Olympics morning with Liz & Charlie. Grocery run for SB snacks. John & Julian came over.", mood: 9 },
  "2026-02-09": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["JJ â€” great person to work with", "Todd/Arete â€” solid relationship now", "My heritage â€” researched Lipari"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Handled Arete delayed bags diplomatically. Called Jara at HeadyTree. Caught up on all emails. Suncrafted call â€” very well. East Move the Needle meeting.", notes: "Dropped Charlie at parents on way to work. Productive + dialed-in day. Researched Italian heritage â€” Lipari.", mood: 8 },
  "2026-02-10": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Jake â€” making me better", "Matt â€” works hard & receptive", "Cole â€” working hard, close to first sale"], affirmation: "About time to join the 5AM Club. Own my morning and elevate my life.", finance: false, retainer: false, floss: false, workWin: "West Move the Needle meeting with Tableau review. Long discussion with Dan about Jake performance plan.", notes: "Getting up at 7:15 now â€” improvement. Need even earlier start. Considering firing Jake.", mood: 6 },
  "2026-02-11": { workout: false, water: 6, reading: 0, journal: true, meditation: false, mitzvah: "Got Liz azaleas from Trader Joe's", gratitude: ["Growth every day", "Liz", "Progress"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Jake meeting â€” final opportunity warning with specific 30-call target. HSA meeting with Dan. Meetings with Jon, Jalen, Lance.", notes: "Got Liz azaleas from Trader Joe's. Target exchange. Barnes & Noble return. Made dinner together.", mood: 7 },
  "2026-02-12": { workout: false, water: 5, reading: 120, journal: true, meditation: false, mitzvah: "", gratitude: ["Travel with work even though annoying", "Ethan â€” he's cool", "Hunter â€” good convo"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Flower Expo in Boston. Connected with Kyle/Nova, Cache, Rec Roots, Fernway, Jeremy Ortiz, Hunter Bean Fiends. Budget meeting with Dan & Lance.", notes: "Flew out. Read entire flight. Checked into hotel. Flower Expo. Dinner with Ethan.", mood: 8, bookPages: 120, bookTitle: "The 5AM Club" },
  "2026-02-13": { workout: false, water: 5, reading: 100, journal: true, meditation: false, mitzvah: "Treating Liz to an amazing Valentine's Day dinner", gratitude: ["Liz â€” best dinner", "Work â€” ability to provide", "Just my growth in general"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "Read entire flight back. Handled all important work items. Dinner at The Standard (oysters, mussels, bronzino, bone-in ribeye, tiramisu). 2 Brothers Brewing after.", notes: "Terrible sleep. Flight home. Valentine's dinner at The Standard â†’ 2 Brothers Brewing (skeeball, pool). Rocket League with Mike & Shane after.", mood: 9, bookPages: 100, bookTitle: "The 5AM Club" },
  "2026-02-14": { workout: true, water: 7, reading: 20, journal: true, meditation: false, mitzvah: "", gratitude: ["Valentine's Day with Liz", "Our home", "Health"], affirmation: "", finance: true, retainer: false, floss: false, workWin: "Posted Valentine's Day pics of Liz. Checked utilities and mail.", workoutDetails: "Back: Lat pulldown (70/90/110LB 3Ã—10), Double D rows (70/90/110LB 3Ã—10), bent over barbell rows (95/105/115LB 3Ã—10), straight arm lat pulldown (20/30/40LB 3Ã—10), DB rows (30/40/40LB 3Ã—10), GHD back extensions 3Ã—10 BW", notes: "Valentine's Day. Gold Zone Winter Olympics with Liz. Read a chapter. Tried intake breathing gadget. Liz made eggs & avocado toast. Picked up Charlie.", mood: 9, bookPages: 20, bookTitle: "The 5AM Club" },
  "2026-02-15": { workout: true, water: 7, reading: 0, journal: true, meditation: false, mitzvah: "", gratitude: ["Shane showing up", "Another workout done", "Consistency"], affirmation: "", finance: false, retainer: false, floss: false, workWin: "", workoutDetails: "Biceps with Shane: Wide barbell (45/55/65LB 3Ã—10), EZ bar inner/outer 3Ã—10 55LB, reverse EZ 3Ã—10 40LB, DB curls 3Ã—20 25LB, cable curls (10LB 3 sets w/ acute curls), Bosu ball balance 3Ã—1min each foot, cable curl rope 3Ã—10 10LB, DB rotations 3Ã—20 8LB", notes: "Bicep day with Shane.", mood: 8 },
};

// â”€â”€â”€ SCHEDULE DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SCHEDULE_BLOCKS = [
  {
    id: "s1", phase: "PRE-DAWN", label: "Victory Hour (20/20/20)", time: "4:45 â€“ 6:00 AM",
    color: "#c9a227", icon: "âš¡",
    desc: "Own your morning. Elevate your life. No snooze, no negotiation.",
    items: [
      { time: "4:45", label: "WAKE UP", detail: "No snooze. Feet on the floor. Let Charlie out + feed him. Coffee brewing. Tight Bubble begins â€” phone on DND.", key: "wake" },
      { time: "5:00â€“5:20", label: "RUN (20 min)", detail: "Get outside and run. Activates BDNF, serotonin, dopamine. Sets the tone for the whole day.", key: "move" },
      { time: "5:20â€“5:40", label: "MEDITATE / REFLECT (20 min)", detail: "Sit in stillness. Breathe. Then: gratitude Ã— 3, affirmation, One Mitzvah intention, tomorrow's #1 priority. This is your REFLECT block.", key: "reflect" },
      { time: "5:40â€“6:00", label: "READ / GROW (20 min)", detail: "The 5AM Club or next book. 20 pages minimum. No phone, no news. Pure input.", key: "grow" },
    ]
  },
  {
    id: "s2", phase: "MORNING PREP", label: "Victory Hour Extension", time: "6:00 â€“ 7:20 AM",
    color: "#ff6b6b", icon: "ðŸš€",
    desc: "Look sharp, fuel right, then drive focused â€” arrive ready to dominate.",
    items: [
      { time: "6:00â€“6:30", label: "SHOWER + PERSONAL CARE", detail: "Retainer in, floss, brush, whitening strips (3Ã—/wk), beard trim as needed. Walk out sharp.", key: "shower" },
      { time: "6:30â€“7:00", label: "BREAKFAST + MAKE LUNCH", detail: "Solid breakfast â€” protein forward. Pack lunch you prepped. Coffee #2. Quick Monarch Money snapshot.", key: "fuel" },
      { time: "7:00â€“7:20", label: "DRIVE TO OFFICE", detail: "No calls. Podcast or music. Let the morning sink in. Arrive 7:30 sharp â€” 90/90/1 starts the moment you sit down.", key: "drive" },
    ]
  },
  {
    id: "s3", phase: "WORK", label: "Office Block", time: "7:30 AM â€“ 5:00 PM",
    color: "#38bdf8", icon: "ðŸ’¼",
    desc: "Excellence in individual responsibilities keeps all the plates spinning.",
    items: [
      { time: "7:30â€“9:00", label: "DEEP WORK â€” 90/90/1 RULE", detail: "Sit down and immediately start your #1 most important project. 90 min, no email, no interruptions. This is your peak cognitive window. Salesforce, dashboards, Tableau, strategy.", key: "deepwork9011" },
      { time: "9:00â€“9:15", label: "SAY HI TO THE TEAM", detail: "Walk the floor. Good morning to everyone. Set the tone as a leader. Check 3 high-priority emails only.", key: "arrival" },
      { time: "9:15â€“10:15", label: "60 MIN FOCUS â€” 60/10 RULE", detail: "Regular tasks, emails, follow-ups. 60 minutes of solid work. Then a 10-min break â€” walk, breathe, stretch. No sitting through it.", key: "saleswork" },
      { time: "10:15â€“10:30", label: "BREAK", detail: "Step outside. Walk Charlie mentally. Fresh air. Stretch. Refill water. Reset.", key: "break1030" },
      { time: "10:30â€“12:30", label: "WORK BLOCK", detail: "Move the Needle calls (East Mon / West Tue), 1:1s, deals, pipeline reviews, team support. Cole, Jake, Lindsi, Mike, Dave, Lance, Jalen, Jon.", key: "selling" },
      { time: "12:30â€“1:45", label: "LUNCH", detail: "Eat what you packed. Step away from the desk. Recharge â€” this is recovery time. Walk if weather allows.", key: "lunch" },
      { time: "1:45â€“5:00", label: "AFTERNOON BLOCK", detail: "Work, emails, meetings, follow-ups. Leadership/Traction (Tue), Ops call, SF cleanup. Close-out: write tomorrow's #1 priority. HARD STOP 5:00.", key: "closeout" },
    ]
  },
  {
    id: "s4", phase: "EVENING", label: "Evening Ritual", time: "5:00 â€“ 9:45 PM",
    color: "#34d399", icon: "ðŸŒ™",
    desc: "Elite production without quiet vacation causes lasting depletion.",
    items: [
      { time: "5:00â€“5:20", label: "DRIVE HOME", detail: "No calls. Music or silence. Let the workday fully close. Decompress before you walk in the door.", key: "decompress" },
      { time: "5:30â€“6:15", label: "WORKOUT", detail: "Home gym session. Rotating split. Rotating split â€” see schedule below.", key: "eveworkout" },
      { time: "6:15â€“7:30", label: "MAKE DINNER + EAT + CLEAN UP", detail: "Take turns cooking with Liz. Eat together. You always clean the kitchen after â€” it's your thing.", key: "cook" },
      { time: "7:30â€“8:00", label: "SHOWER", detail: "Evening shower. Wind down physically. Transition from active to rest mode.", key: "eveShower" },
      { time: "8:00â€“9:45", label: "EVENING RITUAL + LIZ TIME", detail: "Evening journal: gratitude, wins, tomorrow's intention. Then chill with Liz â€” Abbott, Hitster, hang. Screen curfew 9:30. Get ready for bed. Retainer in. Phone away.", key: "winddown" },
    ]
  },
  {
    id: "s5", phase: "PRE-SLEEP", label: "Pre-Sleep Ritual", time: "9:45 â€“ 10:00 PM",
    color: "#c084fc", icon: "ðŸŒŸ",
    desc: "How iconic producers close the day â€” prepare the mind for tomorrow's victory.",
    items: [
      { time: "9:45", label: "DENTAL ROUTINE", detail: "Retainer IN. Floss. Brush. Whitening strips (3Ã—/week rotating schedule). Non-negotiable.", key: "dental" },
      { time: "9:50", label: "REVIEW TOMORROW'S #1", detail: "Write one clear priority. This primes the subconscious overnight.", key: "priority" },
      { time: "9:53", label: "VISUALIZATION (60 sec)", detail: "Eyes closed. See tomorrow's best version of yourself executing perfectly.", key: "visualize" },
      { time: "9:55", label: "PHONE AWAY", detail: "Phone in another room or airplane mode. No doomscrolling. Period.", key: "phoneaway" },
      { time: "10:00", label: "LIGHTS OUT", detail: "7 hours to 4:45 AM. Non-negotiable. This is how champions are made.", key: "sleep" },
    ]
  },
];

const TACTICS = [
  { n: 1, name: "Tight Bubble of Total Focus", desc: "Phone off / DND from 5â€“8:45 AM and 9â€“11 AM office block", icon: "ðŸ«§" },
  { n: 2, name: "The 90/90/1 Rule", desc: "First 90 min of work = your #1 most important project only. No email, no Slack.", icon: "â±ï¸" },
  { n: 3, name: "The 60/10 Method", desc: "60 min deep focus â†’ 10 min full recovery (walk, breathe, stretch)", icon: "ðŸ”„" },
  { n: 4, name: "The Daily 5", desc: "5 small actions daily that directly move your biggest 2026 goals forward", icon: "5ï¸âƒ£" },
  { n: 5, name: "The 2nd Wind Workout", desc: "If you worked out AM, an evening walk or light movement still counts", icon: "ðŸ’¨" },
  { n: 6, name: "The Recovery Protocol", desc: "Weekly stretching & foam rolling after heavy leg/back days. Rest = growth.", icon: "ðŸ§Š" },
  { n: 7, name: "Own Your Calendar", desc: "Schedule workouts, Liz time, Udemy blocks, vacation planning", icon: "ðŸ“…" },
  { n: 8, name: "The Dream Team", desc: "Protect your inner circle: Liz, John, your dad. Invest in these intentionally.", icon: "ðŸ‘¥" },
  { n: 9, name: "The Air Diet", desc: "10-min nature/fresh air break each day â€” walk Charlie, step outside at work", icon: "ðŸŒ¿" },
  { n: 10, name: "The Brave Conversation", desc: "One hard thing per week. Jake's PIP, comp plan boundary, Liz dynamic. Don't avoid.", icon: "ðŸ¦" },
];

const SUCCESS_FORMULA = [
  { step: 1, label: "OPTIMAL MINDSET", color: "#c9a227", icon: "ðŸ§ ", checks: ["Affirmation written", "Gratitude done", "Vibration raised", "Today's #1 priority set"] },
  { step: 2, label: "HEROIC HEALTH", color: "#ff6b6b", icon: "ðŸ’ª", checks: ["Workout done", "8 glasses water", "Sleep protected (10pm)", "Fuel clean"] },
  { step: 3, label: "CONTINUOUS LEARNING", color: "#34d399", icon: "ðŸ“–", checks: ["Pages read (20+ min)", "Skill developed", "One insight applied", "Masterclass/Udemy session"] },
];

// â”€â”€â”€ HABIT INSTALLATION PHASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PROTOCOL_START = "2026-01-01";
function getHabitPhase(manualDay, manualPhase) {
  if (manualDay && manualPhase) {
    const day = manualDay;
    const phaseMap = {
      destruction: { phase: "Destruction", color: "#ff6b6b", label: "Days 1â€“22", desc: "Expect resistance. Journal through it. This is where most quit.", max: 22 },
      installation: { phase: "Installation", color: "#fbbf24", label: "Days 23â€“44", desc: "Getting automatic. The new you is emerging.", max: 44 },
      integration: { phase: "Integration", color: "#34d399", label: "Days 45â€“66", desc: "This is your new identity. Lock it in forever.", max: 66 },
    };
    const p = phaseMap[manualPhase];
    const offset = manualPhase === "installation" ? 22 : manualPhase === "integration" ? 44 : 0;
    const pct = Math.min(Math.max((day - offset) / 22, 0), 1);
    return { ...p, days: day, next: p.max, pct };
  }
  return { phase: "Not Set", color: "#60a5fa", days: 0, next: 66, pct: 0, label: "Configure in Protocol", desc: "Set your starting phase manually in the Protocol section" };
}

// â”€â”€â”€ STORAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadData(key, fallback) {
  try { const r = await window.storage.get(key); return r ? JSON.parse(r.value) : fallback; } catch { return fallback; }
}
async function saveData(key, value) {
  try { await window.storage.set(key, JSON.stringify(value)); } catch {}
}

// â”€â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function todayStr() { return new Date().toISOString().split("T")[0]; }
function formatDate(d) {
  const dt = new Date(d + "T12:00:00");
  return dt.toLocaleDateString("en-US", { weekday: "short", month: "short", day: "numeric" });
}
function getCalendarDays(year, month) {
  return { first: new Date(year, month, 1).getDay(), days: new Date(year, month + 1, 0).getDate() };
}
function totalPages(logs) { return Object.values(logs).reduce((s, d) => s + (d.bookPages || d.reading || 0), 0); }
function getJournalStreak(logs) {
  let streak = 0;
  const today = new Date();
  for (let i = 0; i < 200; i++) {
    const d = new Date(today); d.setDate(d.getDate() - i);
    const k = d.toISOString().split("T")[0];
    if (logs[k]?.journal) streak++; else if (i > 0) break;
  }
  return streak;
}
function getWorkoutStreak(logs) {
  let streak = 0;
  const today = new Date();
  for (let i = 0; i < 200; i++) {
    const d = new Date(today); d.setDate(d.getDate() - i);
    const k = d.toISOString().split("T")[0];
    if (logs[k]?.workout) streak++; else if (i > 0) break;
  }
  return streak;
}

// â”€â”€â”€ COMPONENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Radial({ val, max, color, size = 52 }) {
  const r = (size - 8) / 2, circ = 2 * Math.PI * r;
  const pct = Math.min(Math.max(val / max, 0), 1);
  return (
    <svg width={size} height={size} style={{ transform: "rotate(-90deg)", display: "block" }}>
      <circle cx={size/2} cy={size/2} r={r} fill="none" stroke="rgba(255,255,255,0.06)" strokeWidth={5} />
      <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={color} strokeWidth={5}
        strokeDasharray={`${pct * circ} ${circ}`} strokeLinecap="round"
        style={{ transition: "stroke-dasharray 0.6s cubic-bezier(.4,0,.2,1)" }} />
    </svg>
  );
}

function PhaseBar({ pct, color }) {
  return (
    <div style={{ height: 6, background: "rgba(255,255,255,0.07)", borderRadius: 3, overflow: "hidden", flex: 1 }}>
      <div style={{ height: "100%", width: `${pct * 100}%`, background: color, borderRadius: 3, transition: "width 0.8s cubic-bezier(.4,0,.2,1)" }} />
    </div>
  );
}

// Business Ideas constant (used by both App and LifeOS)
const BUSINESS_IDEAS = [
  { id: "hemp", title: "Hemp paper producer", category: "Manufacturing", description: "Sustainable hemp-based paper production facility", icon: "ðŸŒ¿", stage: "idea" },
  { id: "semi", title: "Semi-conductors", category: "Technology", description: "Semiconductor manufacturing or distribution", icon: "ðŸ’»", stage: "idea" },
  { id: "consulting", title: "Consulting", category: "Services", description: "Professional consulting services", icon: "ðŸ¤", stage: "idea" },
  { id: "broker", title: "Broker", category: "Finance", description: "Brokerage services", icon: "ðŸ“Š", stage: "idea" },
  { id: "lithium", title: "Lithium refinery", category: "Energy", description: "Lithium extraction and refining operations", icon: "âš¡", stage: "idea" },
  { id: "cleanflops", title: "Clean Flops", category: "Product", description: "UV sanitize & dry footwear cleaning service", icon: "ðŸ‘¡", stage: "developing" },
  { id: "supersnacks", title: "Super Snacks", category: "Food", description: "Healthy snack product line", icon: "ðŸ¿", stage: "developing" },
  { id: "bluetooth", title: "Bluetooth speaker hub app", category: "Software", description: "Multi-speaker control application", icon: "ðŸ“±", stage: "researching" },
  { id: "tshirt", title: "Easy Custom Apparel", category: "E-commerce", description: "T-shirt printing and custom apparel service", icon: "ðŸ‘•", stage: "active" },
];

function WorkoutHabitRow({ habit, val, today, onToggle, onDetails, exerciseLibrary, exerciseLogs, setExerciseLogs, todayStr }) {
  const [open, setOpen] = useState(false);
  const [selectedMuscle, setSelectedMuscle] = useState(null);
  const [addingExercise, setAddingExercise] = useState(null);
  
  const todayExercises = exerciseLogs[todayStr] || {};
  
  const logExercise = (exerciseId, setData) => {
    const updated = {
      ...exerciseLogs,
      [todayStr]: {
        ...todayExercises,
        [exerciseId]: [...(todayExercises[exerciseId] || []), setData]
      }
    };
    setExerciseLogs(updated);
    saveData("exercise_logs_v1", updated);
  };
  
  const deleteSet = (exerciseId, setIndex) => {
    const exerciseSets = [...(todayExercises[exerciseId] || [])];
    exerciseSets.splice(setIndex, 1);
    const updated = {
      ...exerciseLogs,
      [todayStr]: {
        ...todayExercises,
        [exerciseId]: exerciseSets
      }
    };
    setExerciseLogs(updated);
    saveData("exercise_logs_v1", updated);
  };
  
  return (
    <div style={{ marginBottom: open ? 0 : 8 }}>
      <div className="habit-row"
        style={{ borderColor: val ? habit.color + "35" : "rgba(255,255,255,0.07)", boxShadow: val ? `0 0 20px ${habit.color}10` : "none", borderRadius: open ? "14px 14px 0 0" : 14, marginBottom: 0 }}
        onClick={onToggle}>
        <span style={{ fontSize: 20 }}>{habit.icon}</span>
        <span style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, flex: 1 }}>{habit.label}</span>
        <span onClick={e => { e.stopPropagation(); setOpen(o => !o); }}
          style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", padding: "4px 10px", marginRight: 4, cursor: "pointer", borderRadius: 8, background: "rgba(255,255,255,0.05)" }}>
          {open ? "â–² hide" : "â–¼ details"}
        </span>
        <div style={{ width: 22, height: 22, borderRadius: "50%", background: val ? habit.color : "rgba(255,255,255,0.06)", border: `2px solid ${val ? habit.color : "rgba(255,255,255,0.12)"}`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 11, color: "#000" }}>{val ? "âœ“" : ""}</div>
      </div>
      {open && (
        <div style={{ background: "rgba(255,107,107,0.04)", border: "1.5px solid rgba(255,107,107,0.2)", borderTop: "none", borderRadius: "0 0 14px 14px", padding: "12px 14px", marginBottom: 8 }}>
          <div style={{ fontSize: 10, color: "rgba(255,107,107,0.6)", fontWeight: 700, letterSpacing: "0.08em", marginBottom: 10 }}>ðŸ’ª EXERCISE TRACKING</div>
          
          {/* Muscle Group Selection */}
          <div style={{ display: "flex", gap: 6, flexWrap: "wrap", marginBottom: 12 }}>
            {Object.keys(exerciseLibrary).map(muscle => (
              <button key={muscle} onClick={() => setSelectedMuscle(selectedMuscle === muscle ? null : muscle)}
                style={{ padding: "6px 12px", fontSize: 11, fontWeight: 700, background: selectedMuscle === muscle ? "rgba(255,107,107,0.2)" : "rgba(255,255,255,0.05)", border: `1px solid ${selectedMuscle === muscle ? "rgba(255,107,107,0.4)" : "rgba(255,255,255,0.1)"}`, borderRadius: 8, color: selectedMuscle === muscle ? "#ff6b6b" : "rgba(255,255,255,0.6)", cursor: "pointer", textTransform: "capitalize" }}>
                {muscle}
              </button>
            ))}
          </div>
          
          {/* Exercise Selection */}
          {selectedMuscle && (
            <div style={{ marginBottom: 12 }}>
              <div style={{ fontSize: 10, color: "rgba(255,107,107,0.5)", marginBottom: 6, textTransform: "uppercase" }}>Select Exercise</div>
              <div style={{ display: "flex", flexDirection: "column", gap: 4 }}>
                {exerciseLibrary[selectedMuscle].map(ex => (
                  <button key={ex.id} onClick={() => setAddingExercise(addingExercise === ex.id ? null : ex.id)}
                    style={{ padding: "8px 12px", fontSize: 12, background: addingExercise === ex.id ? "rgba(255,107,107,0.15)" : "rgba(255,255,255,0.03)", border: `1px solid ${addingExercise === ex.id ? "rgba(255,107,107,0.3)" : "rgba(255,255,255,0.08)"}`, borderRadius: 8, color: "#fff", textAlign: "left", cursor: "pointer" }}>
                    {ex.name}
                  </button>
                ))}
                <button onClick={() => {
                  const name = prompt(`Add custom exercise to ${selectedMuscle}:`);
                  if (name && name.trim()) {
                    const id = selectedMuscle + "_" + name.toLowerCase().replace(/\s+/g, '_');
                    const updated = {
                      ...exerciseLibrary,
                      [selectedMuscle]: [...exerciseLibrary[selectedMuscle], { id, name: name.trim() }]
                    };
                    setExerciseLibrary(updated);
                    saveData("exercise_library_v1", updated);
                  }
                }} style={{ padding: "8px 12px", fontSize: 11, fontWeight: 700, background: "rgba(201,162,39,0.1)", border: "1px dashed rgba(201,162,39,0.3)", borderRadius: 8, color: "#c9a227", cursor: "pointer" }}>
                  + Add Custom Exercise
                </button>
              </div>
            </div>
          )}
          
          {/* Add Set Form */}
          {addingExercise && (
            <div style={{ background: "rgba(255,107,107,0.1)", border: "1px solid rgba(255,107,107,0.25)", borderRadius: 10, padding: 10, marginBottom: 12 }}>
              <div style={{ fontSize: 11, fontWeight: 700, color: "#ff6b6b", marginBottom: 8 }}>
                {exerciseLibrary[selectedMuscle]?.find(e => e.id === addingExercise)?.name}
              </div>
              <div style={{ display: "flex", gap: 6, marginBottom: 6 }}>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 9, color: "rgba(255,107,107,0.6)", marginBottom: 3, textAlign: "center" }}>Weight (lbs)</div>
                  <input id={`weight-${addingExercise}`} type="number" placeholder="135" style={{ width: "100%", fontSize: 12, padding: "6px 8px", textAlign: "center" }} />
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 9, color: "rgba(255,107,107,0.6)", marginBottom: 3, textAlign: "center" }}>Reps</div>
                  <input id={`reps-${addingExercise}`} type="number" placeholder="10" style={{ width: "100%", fontSize: 12, padding: "6px 8px", textAlign: "center" }} />
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 9, color: "rgba(255,107,107,0.6)", marginBottom: 3, textAlign: "center" }}>Sets</div>
                  <input id={`sets-${addingExercise}`} type="number" placeholder="3" defaultValue="1" style={{ width: "100%", fontSize: 12, padding: "6px 8px", textAlign: "center" }} />
                </div>
              </div>
              <button onClick={() => {
                const weight = parseInt(document.getElementById(`weight-${addingExercise}`).value) || 0;
                const reps = parseInt(document.getElementById(`reps-${addingExercise}`).value) || 0;
                const numSets = parseInt(document.getElementById(`sets-${addingExercise}`).value) || 1;
                if (weight > 0 && reps > 0 && numSets > 0) {
                  // Add multiple sets
                  for (let i = 0; i < numSets; i++) {
                    logExercise(addingExercise, { weight, reps, timestamp: Date.now() + i });
                  }
                  // Keep weight for next set, clear reps
                  document.getElementById(`weight-${addingExercise}`).value = weight;
                  document.getElementById(`reps-${addingExercise}`).value = '';
                  document.getElementById(`sets-${addingExercise}`).value = '1';
                }
              }} style={{ width: "100%", padding: "8px 14px", background: "#ff6b6b", border: "none", borderRadius: 8, color: "#000", fontWeight: 700, cursor: "pointer", fontSize: 12 }}>
                + Add Sets
              </button>
            </div>
          )}
          
          {/* Today's Logged Exercises */}
          {Object.keys(todayExercises).length > 0 && (
            <div style={{ marginBottom: 12 }}>
              <div style={{ fontSize: 10, color: "rgba(255,107,107,0.5)", marginBottom: 6, textTransform: "uppercase" }}>Today's Exercises</div>
              {Object.entries(todayExercises).map(([exId, sets]) => {
                if (!sets || sets.length === 0) return null;
                const exName = Object.values(exerciseLibrary).flat().find(e => e.id === exId)?.name || exId;
                return (
                  <div key={exId} style={{ background: "rgba(255,255,255,0.02)", border: "1px solid rgba(255,255,255,0.08)", borderRadius: 8, padding: 8, marginBottom: 6 }}>
                    <div style={{ fontSize: 11, fontWeight: 700, color: "#ff6b6b", marginBottom: 4 }}>{exName}</div>
                    {sets.map((set, idx) => (
                      <div key={idx} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", fontSize: 11, color: "rgba(255,255,255,0.6)", padding: "3px 0" }}>
                        <span>Set {idx + 1}: {set.weight}lb Ã— {set.reps} reps</span>
                        <button onClick={() => deleteSet(exId, idx)} style={{ fontSize: 12, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 4, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                      </div>
                    ))}
                  </div>
                );
              })}
            </div>
          )}
          
          {/* Total Workout Summary */}
          <div style={{ borderTop: "1px solid rgba(255,107,107,0.2)", paddingTop: 12, marginTop: 12 }}>
            <div style={{ fontSize: 10, color: "rgba(255,107,107,0.6)", fontWeight: 700, letterSpacing: "0.08em", marginBottom: 8 }}>ðŸ“‹ TOTAL WORKOUT SUMMARY</div>
            <textarea rows={2} placeholder="Additional workout notes..." value={today.workoutDetails||""} onChange={e => onDetails(e.target.value)} style={{ borderColor: "rgba(255,107,107,0.25)", fontSize: 12, marginBottom: 8 }} />
            <div style={{ display: "flex", gap: 8 }}>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: 10, color: "rgba(255,107,107,0.6)", marginBottom: 4 }}>Total Duration (min)</div>
                <input type="number" placeholder="45" value={today.workoutDuration||""} onChange={e => onDetails("workoutDuration", parseInt(e.target.value) || 0)} style={{ width: "100%", textAlign: "center", fontSize: 13 }} />
              </div>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: 10, color: "rgba(255,107,107,0.6)", marginBottom: 4 }}>Total Calories</div>
                <input type="number" placeholder="350" value={today.workoutCalories||""} onChange={e => onDetails("workoutCalories", parseInt(e.target.value) || 0)} style={{ width: "100%", textAlign: "center", fontSize: 13 }} />
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

// Generic habit row with details
function HabitRowWithDetails({ habit, val, today, onToggle, onDetails, detailsKey, isNulled, onSkip }) {
  const [open, setOpen] = useState(false);
  return (
    <div style={{ display: "flex", gap: 8, alignItems: "flex-start", marginBottom: 8 }}>
      <div style={{ flex: 1 }}>
        <div className="habit-row"
          style={{ borderColor: val ? habit.color + "35" : "rgba(255,255,255,0.07)", boxShadow: val ? `0 0 20px ${habit.color}10` : "none", opacity: isNulled ? 0.4 : 1, borderRadius: open ? "14px 14px 0 0" : 14, marginBottom: 0 }}
          onClick={() => !isNulled && onToggle()}>
          <span style={{ fontSize: 20 }}>{habit.icon}</span>
          <span style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, flex: 1 }}>{habit.label}</span>
          <span onClick={e => { e.stopPropagation(); setOpen(o => !o); }}
            style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", padding: "4px 10px", marginRight: 4, cursor: "pointer", borderRadius: 8, background: "rgba(255,255,255,0.05)" }}>
            {open ? "â–²" : "â–¼"}
          </span>
          <div style={{ width: 22, height: 22, borderRadius: "50%", background: val ? habit.color : "rgba(255,255,255,0.06)", border: `2px solid ${val ? habit.color : "rgba(255,255,255,0.12)"}`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 11, color: "#000" }}>{val ? "âœ“" : ""}</div>
        </div>
        {open && (
          <div style={{ background: `${habit.color}08`, border: `1.5px solid ${habit.color}30`, borderTop: "none", borderRadius: "0 0 14px 14px", padding: "12px 14px", marginBottom: 0 }}>
            <div style={{ fontSize: 10, color: `${habit.color}99`, fontWeight: 700, letterSpacing: "0.08em", marginBottom: 6 }}>DETAILS</div>
            <textarea rows={3} placeholder={`Notes about ${habit.label.toLowerCase()}...`} value={today[detailsKey]||""} onChange={e => onDetails(detailsKey, e.target.value)} style={{ borderColor: `${habit.color}40`, fontSize: 12 }} />
          </div>
        )}
      </div>
      <button onClick={onSkip} style={{ fontSize: 10, padding: "6px 10px", background: isNulled ? "rgba(255,255,255,0.15)" : "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.1)", borderRadius: 8, color: isNulled ? "#c9a227" : "rgba(255,255,255,0.4)", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>
        {isNulled ? "Skipped" : "Skip"}
      </button>
    </div>
  );
}

// â”€â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App() {
  const [view, setView] = useState("today");
  const [logs, setLogs] = useState(JOURNAL_DATA);
  const [selectedDate, setSelectedDate] = useState(todayStr());
  const [calMonth, setCalMonth] = useState({ year: 2026, month: 1 });
  const [editing, setEditing] = useState(false);
  const [editData, setEditData] = useState(null);
  const [editHabitModal, setEditHabitModal] = useState(null);
  const [loaded, setLoaded] = useState(false);
  const [expandedLog, setExpandedLog] = useState(null);
  const [scheduleChecks, setScheduleChecks] = useState({});
  const [expandedBlock, setExpandedBlock] = useState("s1");
  const [schedSection, setSchedSection] = useState("schedule"); // schedule | tactics | formula | protocol
  const [tacticsDone, setTacticsDone] = useState({});
  const [protocolSettings, setProtocolSettings] = useState({ currentDay: 1, phase: "destruction" });
  const [lifeOSTasks, setLifeOSTasks] = useState({});
  const [ventureFocus, setVentureFocus] = useState({ activeId: null, ventures: {} });
  const [statsDrillDown, setStatsDrillDown] = useState(null); // { habitKey, label, icon, color }
  const [showMealModal, setShowMealModal] = useState(false);
  const [nulledHabits, setNulledHabits] = useState({});
  const [financialData, setFinancialData] = useState({ assets: {}, liabilities: {}, monthlyIncome: 0, monthlySpend: 0 });
  const [exercisePRs, setExercisePRs] = useState({});
  const [selectedExercise, setSelectedExercise] = useState("");
  const [customHabits, setCustomHabits] = useState([]);
  const [customPT, setCustomPT] = useState([]);
  const [customGoals, setCustomGoals] = useState([]);
  const [customInvestments, setCustomInvestments] = useState([]);
  const [customExpenses, setCustomExpenses] = useState([]);
  const [exerciseLibrary, setExerciseLibrary] = useState({});
  const [exerciseLogs, setExerciseLogs] = useState({});
  const [editableHabits, setEditableHabits] = useState([
    { key: "workout", label: "Workout", icon: "ðŸ‹ï¸", color: "#ff6b6b" },
    { key: "journal", label: "Journal", icon: "ðŸ““", color: "#c084fc" },
    { key: "meditation", label: "Meditation", icon: "ðŸ§˜", color: "#34d399" },
    { key: "retainer", label: "Retainer", icon: "ðŸ˜", color: "#38bdf8" },
    { key: "dental", label: "Dental", icon: "ðŸ¦·", color: "#60a5fa" },
  ]);
  const [editablePT, setEditablePT] = useState([
    { key: "pt_jaw", label: "Jaw Exercise", icon: "ðŸ’ª", color: "#f97316" },
    { key: "pt_nose", label: "Nose Breathing Device", icon: "ðŸ‘ƒ", color: "#38bdf8" },
    { key: "pt_cardioMask", label: "Cardio Mask", icon: "ðŸ˜·", color: "#60a5fa" },
    { key: "pt_whitening", label: "Teeth Whitening Strips", icon: "âœ¨", color: "#fbbf24" },
    { key: "pt_neck", label: "Neck Strengthening", icon: "ðŸ¦’", color: "#ff6b6b" },
    { key: "pt_balance", label: "Balance / Bosu Ball", icon: "âš–ï¸", color: "#34d399" },
    { key: "pt_grip", label: "Grip Training", icon: "âœŠ", color: "#c084fc" },
  ]);

  useEffect(() => {
    (async () => {
      const stored = await loadData("hb_logs_v3", null);
      if (stored && Object.keys(stored).length > 0) setLogs({ ...JOURNAL_DATA, ...stored });
      const sc = await loadData("hb_sched_v1", {});
      setScheduleChecks(sc);
      const td = await loadData("hb_tactics_v1", {});
      setTacticsDone(td);
      const ps = await loadData("protocol_settings_v1", { currentDay: 1, phase: "destruction" });
      setProtocolSettings(ps);
      const lot = await loadData("lifeos_tasks_v1", {});
      setLifeOSTasks(lot);
      const vf = await loadData("venture_focus_v1", { activeId: null, ventures: {} });
      setVentureFocus(vf);
      const nh = await loadData("hb_nulled_v1", {});
      setNulledHabits(nh);
      const fd = await loadData("financial_data_v1", { assets: {}, liabilities: {}, monthlyIncome: 0, monthlySpend: 0 });
      setFinancialData(fd);
      const eprs = await loadData("exercise_prs_v1", {});
      setExercisePRs(eprs);
      const ch = await loadData("custom_habits_v1", []);
      setCustomHabits(ch);
      const cpt = await loadData("custom_pt_v1", []);
      setCustomPT(cpt);
      const cg = await loadData("custom_goals_v1", []);
      setCustomGoals(cg);
      const ci = await loadData("custom_investments_v1", []);
      setCustomInvestments(ci);
      const ce = await loadData("custom_expenses_v1", []);
      setCustomExpenses(ce);
      const eh = await loadData("editable_habits_v1", null);
      if (eh) setEditableHabits(eh);
      const ept = await loadData("editable_pt_v1", null);
      if (ept) setEditablePT(ept);
      
      // Load exercise library and logs
      const exLib = await loadData("exercise_library_v1", {
        chest: [
          { id: "bench_press", name: "Barbell Bench Press" },
          { id: "db_press", name: "Dumbbell Chest Press" },
          { id: "incline_press", name: "Incline Bench Press" },
          { id: "cable_fly", name: "Cable Flys" },
        ],
        back: [
          { id: "deadlift", name: "Deadlift" },
          { id: "pull_up", name: "Pull-Ups" },
          { id: "bent_row", name: "Bent Over Row" },
          { id: "lat_pulldown", name: "Lat Pulldown" },
        ],
        shoulders: [
          { id: "ohp", name: "Overhead Press" },
          { id: "lateral_raise", name: "Lateral Raises" },
          { id: "front_raise", name: "Front Raises" },
          { id: "face_pull", name: "Face Pulls" },
        ],
        arms: [
          { id: "bicep_curl", name: "Bicep Curls" },
          { id: "hammer_curl", name: "Hammer Curls" },
          { id: "tricep_extension", name: "Tricep Extensions" },
          { id: "dips", name: "Dips" },
        ],
        legs: [
          { id: "squat", name: "Barbell Squat" },
          { id: "leg_press", name: "Leg Press" },
          { id: "leg_curl", name: "Leg Curls" },
          { id: "calf_raise", name: "Calf Raises" },
        ],
        core: [
          { id: "plank", name: "Plank" },
          { id: "hanging_leg_raise", name: "Hanging Leg Raises" },
          { id: "ab_wheel", name: "Ab Wheel" },
          { id: "side_plank", name: "Side Plank" },
        ],
      });
      setExerciseLibrary(exLib);
      
      const exLogs = await loadData("exercise_logs_v1", {});
      setExerciseLogs(exLogs);
      
      setLoaded(true);
    })();
  }, []);

  // Chart rendering for stats drill-down
  useEffect(() => {
    if (!statsDrillDown) return;
    
    const chartCanvas = document.getElementById('statsChart');
    if (!chartCanvas) return;
    
    // Destroy previous chart
    if (window.statsChartInstance) {
      window.statsChartInstance.destroy();
    }
    
    // Prepare data - last 30 days
    const dates = [];
    const values = [];
    const today = new Date();
    
    for (let i = 29; i >= 0; i--) {
      const date = new Date(today);
      date.setDate(date.getDate() - i);
      const dateStr = date.toISOString().split('T')[0];
      const log = logs[dateStr];
      
      dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
      
      if (!log) {
        values.push(0);
      } else if (statsDrillDown.key === "bookPages") {
        values.push(log.bookPages || log.reading || 0);
      } else if (statsDrillDown.key === "waterOz") {
        values.push(log.waterOz || 0);
      } else if (statsDrillDown.muscleGroup) {
        const w = (log.workoutDetails || "").toLowerCase();
        values.push(w.includes(statsDrillDown.muscleGroup) ? 1 : 0);
      } else {
        values.push(log[statsDrillDown.key] ? 1 : 0);
      }
    }
    
    // Register Chart.js components
    if (!window.chartJsRegistered) {
      Chart.Chart.register(
        Chart.LineController,
        Chart.LineElement,
        Chart.PointElement,
        Chart.LinearScale,
        Chart.CategoryScale,
        Chart.Tooltip,
        Chart.Filler
      );
      window.chartJsRegistered = true;
    }
    
    // Create chart
    const ctx = chartCanvas.getContext('2d');
    window.statsChartInstance = new Chart.Chart(ctx, {
      type: 'line',
      data: {
        labels: dates,
        datasets: [{
          label: statsDrillDown.label,
          data: values,
          borderColor: statsDrillDown.color,
          backgroundColor: `${statsDrillDown.color}20`,
          tension: 0.4,
          fill: true,
          pointRadius: 3,
          pointHoverRadius: 6,
          pointBackgroundColor: statsDrillDown.color,
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: 'rgba(0,0,0,0.9)',
            titleColor: statsDrillDown.color,
            bodyColor: '#fff',
            borderColor: statsDrillDown.color,
            borderWidth: 1,
            padding: 10,
            displayColors: false
          }
        },
        scales: {
          x: {
            ticks: { 
              color: 'rgba(255,255,255,0.5)', 
              maxRotation: 45,
              minRotation: 45,
              font: { size: 9 }
            },
            grid: { color: 'rgba(255,255,255,0.05)' }
          },
          y: {
            ticks: { 
              color: 'rgba(255,255,255,0.5)',
              font: { size: 10 }
            },
            grid: { color: 'rgba(255,255,255,0.05)' },
            beginAtZero: true
          }
        }
      }
    });
  }, [statsDrillDown, logs]);

  const updateLog = useCallback(async (date, field, val) => {
    setLogs(prev => {
      const updated = { ...prev, [date]: { ...(prev[date] || {}), [field]: val } };
      saveData("hb_logs_v3", updated);
      return updated;
    });
  }, []);

  const saveEdit = useCallback(async () => {
    setLogs(prev => {
      const updated = { ...prev, [selectedDate]: { ...(prev[selectedDate] || {}), ...editData } };
      saveData("hb_logs_v3", updated);
      return updated;
    });
    setEditing(false); setEditData(null);
  }, [editData, selectedDate]);

  const toggleScheduleCheck = useCallback((key) => {
    const todayKey = todayStr() + "_" + key;
    setScheduleChecks(prev => {
      const updated = { ...prev, [todayKey]: !prev[todayKey] };
      saveData("hb_sched_v1", updated);
      
      // Auto-update tactics based on schedule completion
      if (updated[todayKey]) { // Only when checking items
        const tacticMappings = {
          "move": "t2", // Move block â†’ 90/90/1 Rule
          "learn": "t7", // Learn block â†’ Learning/Growth
          "cold": "t8", // Cold shower â†’ Uncomfort training
          "journal": "t4", // Journal â†’ Reflection
        };
        
        if (tacticMappings[key]) {
          const tacticKey = todayStr() + "_" + tacticMappings[key];
          setTacticsDone(prevTactics => {
            const updatedTactics = { ...prevTactics, [tacticKey]: true };
            saveData("hb_tactics_v1", updatedTactics);
            return updatedTactics;
          });
        }
      }
      
      return updated;
    });
  }, []);

  const toggleTactic = useCallback((n) => {
    const todayKey = todayStr() + "_t" + n;
    setTacticsDone(prev => {
      const updated = { ...prev, [todayKey]: !prev[todayKey] };
      saveData("hb_tactics_v1", updated);
      return updated;
    });
  }, []);

  const updateProtocol = useCallback((updates) => {
    setProtocolSettings(prev => {
      const updated = { ...prev, ...updates };
      saveData("protocol_settings_v1", updated);
      return updated;
    });
  }, []);

  const toggleLifeOSTask = useCallback((id) => {
    setLifeOSTasks(prev => {
      const task = prev[id] || {};
      const updated = { ...prev, [id]: { ...task, done: !task.done, doneDate: !task.done ? todayStr() : null } };
      saveData("lifeos_tasks_v1", updated);
      return updated;
    });
  }, []);

  const scheduleLifeOSTask = useCallback((id, date) => {
    setLifeOSTasks(prev => {
      const updated = { ...prev, [id]: { ...prev[id], scheduledDate: date } };
      saveData("lifeos_tasks_v1", updated);
      return updated;
    });
  }, []);

  const toggleVentureFocus = useCallback((ventureId) => {
    setVentureFocus(prev => {
      const isActive = prev.activeId === ventureId;
      const updated = {
        ...prev,
        activeId: isActive ? null : ventureId,
        ventures: {
          ...prev.ventures,
          [ventureId]: prev.ventures[ventureId] || { status: "idea", notes: [], updates: [], reading: [] }
        }
      };
      saveData("venture_focus_v1", updated);
      return updated;
    });
  }, []);

  const updateVentureData = useCallback((ventureId, updates) => {
    setVentureFocus(prev => {
      const updated = {
        ...prev,
        ventures: {
          ...prev.ventures,
          [ventureId]: { ...prev.ventures[ventureId], ...updates }
        }
      };
      saveData("venture_focus_v1", updated);
      return updated;
    });
  }, []);

  const toggleNulled = useCallback((habitKey) => {
    const key = todayStr() + "_" + habitKey;
    setNulledHabits(prev => {
      const updated = { ...prev, [key]: !prev[key] };
      saveData("hb_nulled_v1", updated);
      return updated;
    });
  }, []);

  const updateFinancialData = useCallback((category, key, value) => {
    setFinancialData(prev => {
      const updated = { ...prev, [category]: { ...prev[category], [key]: value } };
      saveData("financial_data_v1", updated);
      return updated;
    });
  }, []);

  if (!loaded) return (
    <div style={{ background: "#080810", minHeight: "100vh", display: "flex", alignItems: "center", justifyContent: "center" }}>
      <div style={{ color: "#c9a227", fontFamily: "'Syne', sans-serif", fontSize: 18, letterSpacing: "0.3em" }}>LOADINGâ€¦</div>
    </div>
  );

  const today = logs[todayStr()] || {};
  const sel = logs[selectedDate] || {};
  const workoutDays = Object.values(logs).filter(d => d.workout).length;
  const journalDays = Object.values(logs).filter(d => d.journal).length;
  const mitzvahs = Object.values(logs).filter(d => d.mitzvah && d.mitzvah.trim()).length;
  const financeDays = Object.values(logs).filter(d => d.finance).length;
  const totalPagesRead = totalPages(logs);
  const journalStreak = getJournalStreak(logs);
  const workoutStreak = getWorkoutStreak(logs);
  const habitPhase = getHabitPhase(protocolSettings.currentDay, protocolSettings.phase);

  const todayScore = () => {
    const t = logs[todayStr()] || {};
    
    // Personal Habits
    const habitChecks = [
      { key: "workout", value: t.workout },
      { key: "journal", value: t.journal },
      { key: "meditation", value: t.meditation },
      { key: "retainer", value: t.retainer },
      { key: "dental", value: t.dental },
      { key: "waterOz", value: (t.waterOz||0)>=100 },
      { key: "bookPages", value: (t.bookPages||t.reading||0)>0 },
      { key: "mitzvah", value: !!(t.mitzvah?.trim()) },
      { key: "affirmation", value: !!(t.affirmation?.trim()) }
    ];
    
    // PT/Superlatives
    const ptChecks = [
      { key: "pt_jaw", value: t.pt_jaw },
      { key: "pt_nose", value: t.pt_nose },
      { key: "pt_cardioMask", value: t.pt_cardioMask },
      { key: "pt_whitening", value: t.pt_whitening },
      { key: "pt_neck", value: t.pt_neck },
      { key: "pt_balance", value: t.pt_balance },
      { key: "pt_grip", value: t.pt_grip }
    ];
    
    // Count completed habits (excluding skipped)
    const habitScore = habitChecks.filter(h => {
      const nullKey = todayStr() + "_" + h.key;
      return !nulledHabits[nullKey] && h.value;
    }).length;
    
    const ptScore = ptChecks.filter(h => {
      const nullKey = todayStr() + "_" + h.key;
      return !nulledHabits[nullKey] && h.value;
    }).length;
    
    // Custom habits
    const customHabitScore = customHabits.filter(h => {
      const nullKey = todayStr() + "_" + h.key;
      return !nulledHabits[nullKey] && t[h.key];
    }).length;
    
    // Custom PT
    const customPTScore = customPT.filter(pt => {
      const nullKey = todayStr() + "_" + pt.key;
      return !nulledHabits[nullKey] && t[pt.key];
    }).length;
    
    // Scheduled tasks for today (completed ones only)
    const scheduledScore = Object.values(lifeOSTasks).filter(task => 
      task.scheduledDate === todayStr() && task.done
    ).length;
    
    return habitScore + ptScore + customHabitScore + customPTScore + scheduledScore;
  };

  const HABITS = editableHabits; // Now editable!

  // Count today's schedule items done
  const schedTodayDone = SCHEDULE_BLOCKS.reduce((sum, block) =>
    sum + block.items.filter(item => scheduleChecks[todayStr() + "_" + item.key]).length, 0);
  const schedTodayTotal = SCHEDULE_BLOCKS.reduce((sum, block) => sum + block.items.length, 0);

  return (
    <div style={{ background: "#080810", minHeight: "100vh", maxWidth: 430, margin: "0 auto", fontFamily: "'DM Sans', sans-serif", color: "#fff", paddingBottom: 84 }}>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500&display=swap');
        * { box-sizing: border-box; margin: 0; padding: 0; }
        ::-webkit-scrollbar { width: 0; }
        input, textarea { background: rgba(255,255,255,0.055); border: 1px solid rgba(255,255,255,0.1); color: #fff; border-radius: 10px; padding: 10px 12px; font-family: 'DM Sans', sans-serif; font-size: 13px; width: 100%; outline: none; resize: none; transition: border 0.2s; }
        input:focus, textarea:focus { border-color: rgba(201,162,39,0.4); }
        .card { background: rgba(255,255,255,0.035); border: 1px solid rgba(255,255,255,0.07); border-radius: 16px; padding: 16px; margin-bottom: 10px; }
        .chip { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 600; }
        .nav-btn { background: none; border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 2px; padding: 5px 8px; border-radius: 10px; transition: all 0.2s; flex: 1; }
        .habit-row { background: rgba(255,255,255,0.035); border: 1.5px solid rgba(255,255,255,0.07); border-radius: 14px; padding: 13px 15px; display: flex; align-items: center; gap: 12px; cursor: pointer; transition: all 0.22s; margin-bottom: 8px; }
        .habit-row:active { transform: scale(0.97); }
        .cnt-btn { width: 28px; height: 28px; border-radius: 50%; border: none; cursor: pointer; font-size: 15px; display: flex; align-items: center; justify-content: center; font-weight: 700; transition: transform 0.12s; }
        .cnt-btn:active { transform: scale(0.85); }
        .ghost { background: rgba(255,255,255,0.055); border: 1px solid rgba(255,255,255,0.1); color: #fff; border-radius: 10px; padding: 9px 16px; font-family: 'Syne', sans-serif; font-weight: 700; font-size: 11px; cursor: pointer; letter-spacing: 0.06em; }
        .primary { background: #c9a227; color: #080810; border: none; border-radius: 12px; padding: 13px 24px; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 13px; letter-spacing: 0.08em; cursor: pointer; transition: all 0.18s; width: 100%; }
        .primary:active { transform: scale(0.97); opacity: 0.9; }
        .loge { border-bottom: 1px solid rgba(255,255,255,0.05); padding: 13px 0; cursor: pointer; }
        .loge:last-child { border-bottom: none; }
        .stab { background: none; border: none; cursor: pointer; font-family: 'Syne', sans-serif; font-size: 10px; font-weight: 700; letter-spacing: 0.08em; padding: 7px 12px; border-radius: 20px; transition: all 0.2s; }
        .sched-item { display: flex; gap: 12px; align-items: flex-start; padding: 11px 0; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: all 0.15s; }
        .sched-item:last-child { border-bottom: none; }
        .check-circle { width: 22px; height: 22px; border-radius: 50%; border: 2px solid; display: flex; align-items: center; justify-content: center; font-size: 11px; flex-shrink: 0; margin-top: 1px; transition: all 0.2s; }
        input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; }
      `}</style>

      {/* â”€â”€ HEADER â”€â”€ */}
      <div style={{ padding: "18px 18px 12px", borderBottom: "1px solid rgba(255,255,255,0.05)", position: "sticky", top: 0, background: "#080810", zIndex: 50 }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
          <div>
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 20, letterSpacing: "-0.02em" }}>
              {view === "today" && "Today"}
              {view === "schedule" && "5AM Club"}
              {view === "cal" && "Calendar"}
              {view === "stats" && "Overview"}
              {view === "lifeos" && "Life OS"}
              {view === "journal_day" && "Entry"}
            </div>
            <div style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", marginTop: 1, letterSpacing: "0.04em" }}>
              {view === "today" ? formatDate(todayStr()) : view === "schedule" ? "DAILY OPERATING SYSTEM" : view === "lifeos" ? "YOUR MASTER PLAN" : view === "journal_day" ? formatDate(selectedDate) : "2026 TRACKER"}
            </div>
          </div>
          <div style={{ textAlign: "right" }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: "#c9a227" }}>ðŸ”¥ {journalStreak}d</div>
            <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)" }}>journal streak</div>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* â”€â”€ TODAY VIEW â”€â”€ */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {view === "today" && (
        <div style={{ padding: "14px 18px" }}>

          {/* Score card */}
          {(() => {
            const score = todayScore();
            const t = logs[todayStr()] || {};
            
            // Calculate total possible (non-skipped items)
            const totalHabits = 9; // workout, journal, meditation, retainer, dental, water, reading, mitzvah, affirmation
            const totalPT = 7; // 7 PT items
            const totalCustomHabits = customHabits.length;
            const totalCustomPT = customPT.length;
            const scheduledTasks = Object.values(lifeOSTasks).filter(task => task.scheduledDate === todayStr()).length;
            
            // Count skipped items
            const skippedCount = Object.keys(nulledHabits).filter(key => 
              key.startsWith(todayStr() + "_") && nulledHabits[key]
            ).length;
            
            const totalPossible = totalHabits + totalPT + totalCustomHabits + totalCustomPT + scheduledTasks - skippedCount;
            
            const msgs = ["Start. Own the day.", "Building momentumâ€¦", "Solid start ðŸ’ª", "Locked in!", "Dialing in ðŸ”¥", "Strong day!", "Elite execution!", "5AM Club energy ðŸ”¥"];
            const msgIndex = Math.min(Math.floor((score / totalPossible) * msgs.length), msgs.length - 1);
            
            return (
              <div style={{ background: "linear-gradient(135deg, rgba(201,162,39,0.1) 0%, rgba(201,162,39,0.03) 100%)", border: "1px solid rgba(201,162,39,0.18)", borderRadius: 18, padding: "14px 16px", display: "flex", alignItems: "center", gap: 14, marginBottom: 14 }}>
                <div style={{ position: "relative", width: 60, height: 60, flexShrink: 0 }}>
                  <Radial val={score} max={totalPossible} color="#c9a227" size={60} />
                  <div style={{ position: "absolute", inset: 0, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 15, color: "#c9a227" }}>{score}</div>
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: "#c9a227", lineHeight: 1 }}>{score}<span style={{ fontSize: 13, opacity: 0.6 }}>/{totalPossible}</span></div>
                  <div style={{ fontSize: 12, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{msgs[msgIndex]}</div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.25)", marginTop: 2 }}>Schedule: {schedTodayDone}/{schedTodayTotal} blocks done</div>
                </div>
              </div>
            );
          })()}

          {/* 3-Step Formula Quick Check */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10 }}>THE 3-STEP SUCCESS FORMULA</div>
          <div style={{ display: "flex", gap: 8, marginBottom: 16 }}>
            {SUCCESS_FORMULA.map(s => {
              const done = s.step === 1
                ? !!(today.affirmation && today.gratitude?.filter(Boolean).length >= 1)
                : s.step === 2
                ? !!(today.workout && (today.water||0) >= 6)
                : !!(today.bookPages || today.reading);
              return (
                <div key={s.step} style={{ flex: 1, background: done ? `${s.color}15` : "rgba(255,255,255,0.03)", border: `1px solid ${done ? s.color + "40" : "rgba(255,255,255,0.07)"}`, borderRadius: 12, padding: "10px 8px", textAlign: "center", transition: "all 0.3s" }}>
                  <div style={{ fontSize: 18, marginBottom: 4 }}>{s.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 10, color: done ? s.color : "rgba(255,255,255,0.35)", letterSpacing: "0.05em" }}>STEP {s.step}</div>
                  <div style={{ fontSize: 9, color: "rgba(255,255,255,0.35)", marginTop: 2 }}>{s.label}</div>
                  {done && <div style={{ fontSize: 12, marginTop: 4 }}>âœ“</div>}
                </div>
              );
            })}
          </div>

          {/* Scheduled Tasks for Today */}
          {(() => {
            const todayTasks = Object.entries(lifeOSTasks).filter(([_, t]) => t.scheduledDate === todayStr() && !t.done);
            if (todayTasks.length === 0) return null;
            return (
              <div style={{ marginBottom: 14 }}>
                <div style={{ fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 8 }}>ðŸ“… SCHEDULED FOR TODAY</div>
                {todayTasks.map(([id, task]) => {
                  // Use the label stored in the task, or text for custom tasks
                  const displayLabel = task.label || task.text || "Task";
                  
                  return (
                    <div key={id} onClick={() => toggleLifeOSTask(id)}
                      style={{ background: "rgba(201,162,39,0.06)", border: "1px solid rgba(201,162,39,0.2)", borderRadius: 12, padding: "10px 12px", marginBottom: 6, cursor: "pointer", display: "flex", alignItems: "center", gap: 10, transition: "all 0.15s" }}>
                      <div style={{ width: 18, height: 18, borderRadius: "50%", border: "2px solid #c9a227", background: task.done ? "#c9a227" : "transparent", flexShrink: 0, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000" }}>{task.done && "âœ“"}</div>
                      <div style={{ flex: 1, fontSize: 13, color: task.done ? "rgba(255,255,255,0.4)" : "#fff", textDecoration: task.done ? "line-through" : "none" }}>{displayLabel}</div>
                    </div>
                  );
                })}
              </div>
            );
          })()}

          {/* Focused Business Ideas */}
          {ventureFocus.activeId && (() => {
            const focused = BUSINESS_IDEAS.find(idea => idea.id === ventureFocus.activeId);
            if (!focused) return null;
            return (
              <div style={{ marginBottom: 14 }}>
                <div style={{ fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 8 }}>â­ FOCUSED VENTURE</div>
                <div style={{ background: "rgba(201,162,39,0.08)", border: "1px solid rgba(201,162,39,0.25)", borderRadius: 12, padding: "12px 14px" }}>
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 8 }}>
                    <div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, color: "#c9a227", marginBottom: 2 }}>{focused.title}</div>
                      <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)" }}>{focused.category}</div>
                    </div>
                    <div style={{ fontSize: 10, padding: "4px 8px", background: "rgba(201,162,39,0.2)", borderRadius: 6, color: "#c9a227", fontWeight: 700 }}>
                      {ventureFocus.ventures[ventureFocus.activeId]?.status || "Idea"}
                    </div>
                  </div>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.6)", lineHeight: 1.5 }}>{focused.description}</div>
                </div>
              </div>
            );
          })()}

          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10 }}>PERSONAL HABITS</div>
          {HABITS.map(h => {
            const val = today[h.key];
            const nullKey = todayStr() + "_" + h.key;
            const isNulled = nulledHabits[nullKey];
            if (h.key === "workout") {
              return (
                <div key={h.key} style={{ display: "flex", gap: 8, alignItems: "flex-start" }}>
                  <div style={{ flex: 1 }}>
                    <WorkoutHabitRow habit={h} val={val} today={today} onToggle={() => updateLog(todayStr(), h.key, !val)} onDetails={(field, value) => {
                      if (typeof field === "string" && field.startsWith("workout")) {
                        updateLog(todayStr(), field, value);
                      } else {
                        updateLog(todayStr(), "workoutDetails", field);
                      }
                    }} exerciseLibrary={exerciseLibrary} exerciseLogs={exerciseLogs} setExerciseLogs={setExerciseLogs} todayStr={todayStr()} isNulled={isNulled} onSkip={() => toggleNulled(h.key)} />
                  </div>
                  <button type="button" onClick={(e) => {
                    e.stopPropagation();
                    const newLabel = prompt("Edit habit name:", h.label);
                    if (newLabel && newLabel.trim()) {
                      const newIcon = prompt("Edit emoji:", h.icon);
                      if (newIcon && newIcon.trim()) {
                        const updated = editableHabits.map(habit => 
                          habit.key === h.key ? { ...habit, label: newLabel.trim(), icon: newIcon.trim() } : habit
                        );
                        setEditableHabits(updated);
                        saveData("editable_habits_v1", updated);
                      }
                    }
                  }} style={{ fontSize: 11, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0, fontWeight: 600 }}>âœï¸</button>
                  <button type="button" onClick={(e) => {
                    e.stopPropagation();
                    if (confirm(`Delete "${h.label}" habit? This will remove it permanently.`)) {
                      const updated = editableHabits.filter(habit => habit.key !== h.key);
                      setEditableHabits(updated);
                      saveData("editable_habits_v1", updated);
                    }
                  }} style={{ fontSize: 14, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>Ã—</button>
                </div>
              );
            }
            return (
              <div key={h.key} style={{ display: "flex", gap: 8, alignItems: "flex-start" }}>
                <div style={{ flex: 1 }}>
                  <HabitRowWithDetails 
                    habit={h}
                    val={val}
                    today={today}
                    onToggle={() => updateLog(todayStr(), h.key, !val)}
                    onDetails={(key, value) => updateLog(todayStr(), key, value)}
                    detailsKey={`${h.key}Details`}
                    isNulled={isNulled}
                    onSkip={() => toggleNulled(h.key)}
                  />
                </div>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  setEditHabitModal({ type: 'habit', item: h });
                }} style={{ fontSize: 11, padding: "4px 8px", background: `${h.color}30`, border: `1px solid ${h.color}`, borderRadius: 6, color: h.color, cursor: "pointer", flexShrink: 0, marginTop: 0, fontWeight: 600 }}>âœï¸</button>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  if (confirm(`Delete "${h.label}" habit? This will remove it permanently.`)) {
                    const updated = editableHabits.filter(habit => habit.key !== h.key);
                    setEditableHabits(updated);
                    saveData("editable_habits_v1", updated);
                  }
                }} style={{ fontSize: 14, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>Ã—</button>
              </div>
            );
          })}

          {/* Custom Habits */}
          {customHabits.map(h => {
            const val = today[h.key];
            const nullKey = todayStr() + "_" + h.key;
            const isNulled = nulledHabits[nullKey];
            return (
              <div key={h.key} style={{ display: "flex", gap: 8, alignItems: "flex-start" }}>
                <div style={{ flex: 1 }}>
                  <HabitRowWithDetails 
                    habit={h}
                    val={val}
                    today={today}
                    onToggle={() => updateLog(todayStr(), h.key, !val)}
                    onDetails={(key, value) => updateLog(todayStr(), key, value)}
                    detailsKey={`${h.key}Details`}
                    isNulled={isNulled}
                    onSkip={() => toggleNulled(h.key)}
                  />
                </div>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  const newLabel = prompt("Edit habit name:", h.label);
                  if (newLabel && newLabel.trim()) {
                    const newIcon = prompt("Edit emoji icon:", h.icon);
                    if (newIcon && newIcon.trim()) {
                      const updated = customHabits.map(habit => 
                        habit.key === h.key 
                          ? { ...habit, label: newLabel.trim(), icon: newIcon.trim() }
                          : habit
                      );
                      setCustomHabits(updated);
                      saveData("custom_habits_v1", updated);
                    }
                  }
                }} style={{ fontSize: 11, padding: "4px 8px", background: "rgba(192,132,252,0.15)", border: "1px solid rgba(192,132,252,0.3)", borderRadius: 6, color: "#c084fc", cursor: "pointer", flexShrink: 0, marginTop: 0, fontWeight: 600 }}>âœï¸</button>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  if (confirm(`Delete "${h.label}" habit?`)) {
                    const updated = customHabits.filter(habit => habit.key !== h.key);
                    setCustomHabits(updated);
                    saveData("custom_habits_v1", updated);
                  }
                }} style={{ fontSize: 14, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>Ã—</button>
              </div>
            );
          })}

          {/* Add Custom Habit Button */}
          <button onClick={() => {
            const label = prompt("Habit name (e.g., 'Cold Shower'):");
            if (!label || !label.trim()) return;
            const icon = prompt("Emoji icon (e.g., ðŸ§Š):");
            if (!icon || !icon.trim()) return;
            const key = `custom_habit_${Date.now()}`;
            const color = "#c084fc"; // Purple for custom
            const newHabit = { key, label: label.trim(), icon: icon.trim(), color };
            const updated = [...customHabits, newHabit];
            setCustomHabits(updated);
            saveData("custom_habits_v1", updated);
          }} style={{ width: "100%", padding: "10px", background: "rgba(192,132,252,0.1)", border: "1px solid rgba(192,132,252,0.3)", borderRadius: 10, color: "#c084fc", fontSize: 12, fontWeight: 700, cursor: "pointer", marginBottom: 8, fontFamily: "'Syne', sans-serif" }}>
            + Add Custom Habit
          </button>

          {/* Water â€” ounces */}
          <div className="card" style={{ marginBottom: 10 }}>
            <div style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 10 }}>
              <span style={{ fontSize: 20 }}>ðŸ’§</span>
              <span style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, flex: 1 }}>Water</span>
              <button className="cnt-btn" onClick={() => updateLog(todayStr(), "waterOz", Math.max(0, (today.waterOz||0) - 8))} style={{ background: "rgba(255,255,255,0.07)", color: "#fff" }}>âˆ’</button>
              <input type="number" value={today.waterOz || 0}
                onChange={e => updateLog(todayStr(), "waterOz", Math.max(0, Math.min(300, parseInt(e.target.value)||0)))}
                style={{ width: 58, textAlign: "center", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: "#38bdf8", padding: "4px 6px", borderColor: "rgba(56,189,248,0.3)", background: "rgba(56,189,248,0.07)" }} />
              <button className="cnt-btn" onClick={() => updateLog(todayStr(), "waterOz", Math.min(300, (today.waterOz||0) + 8))} style={{ background: "rgba(56,189,248,0.12)", color: "#38bdf8", border: "1px solid rgba(56,189,248,0.3)" }}>+</button>
            </div>
            {(() => {
              const goal = 100; const oz = today.waterOz || 0; const pct = Math.min(oz / goal, 1);
              const segments = 10;
              return (
                <>
                  <div style={{ display: "flex", gap: 4 }}>
                    {Array.from({ length: segments }).map((_, i) => (
                      <div key={i} onClick={() => updateLog(todayStr(), "waterOz", Math.round((i+1)/segments*goal))}
                        style={{ flex: 1, height: 6, borderRadius: 3, background: i < Math.round(pct * segments) ? "#38bdf8" : "rgba(255,255,255,0.07)", cursor: "pointer", transition: "background 0.2s" }} />
                    ))}
                  </div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.25)", marginTop: 5 }}>
                    Goal: 100 oz/day Â· {oz} oz today ({Math.round(pct*100)}%) Â· +8 oz per tap
                  </div>
                </>
              );
            })()}
          </div>

          {/* Reading */}
          <div className="card" style={{ marginBottom: 10 }}>
            <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
              <span style={{ fontSize: 20 }}>ðŸ“–</span>
              <div style={{ flex: 1 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13 }}>Reading</div>
                <div style={{ fontSize: 10, color: "rgba(192,132,252,0.7)", marginTop: 1 }}>The 5AM Club Â· {totalPagesRead} pages in 2026</div>
              </div>
              <button className="cnt-btn" onClick={() => updateLog(todayStr(), "bookPages", Math.max(0, (today.bookPages||today.reading||0) - 5))} style={{ background: "rgba(255,255,255,0.07)", color: "#fff" }}>âˆ’</button>
              <span style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: "#c084fc", minWidth: 26, textAlign: "center" }}>{today.bookPages||today.reading||0}</span>
              <button className="cnt-btn" onClick={() => updateLog(todayStr(), "bookPages", (today.bookPages||today.reading||0) + 5)} style={{ background: "rgba(192,132,252,0.12)", color: "#c084fc", border: "1px solid rgba(192,132,252,0.3)" }}>+</button>
            </div>
          </div>

          {/* Superlatives / PT */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10, marginTop: 16 }}>SUPERLATIVES / PT</div>
          {editablePT.map(pt => {
            const val = today[pt.key];
            const nullKey = todayStr() + "_" + pt.key;
            const isNulled = nulledHabits[nullKey];
            return (
              <div key={pt.key} style={{ display: "flex", gap: 8, alignItems: "flex-start" }}>
                <div style={{ flex: 1 }}>
                  <HabitRowWithDetails 
                    habit={pt}
                    val={val}
                    today={today}
                    onToggle={() => updateLog(todayStr(), pt.key, !val)}
                    onDetails={(key, value) => updateLog(todayStr(), key, value)}
                    detailsKey={`${pt.key}Details`}
                    isNulled={isNulled}
                    onSkip={() => toggleNulled(pt.key)}
                  />
                </div>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  const newLabel = prompt("Edit PT name:", pt.label);
                  if (newLabel && newLabel.trim()) {
                    const newIcon = prompt("Edit emoji:", pt.icon);
                    if (newIcon && newIcon.trim()) {
                      const updated = editablePT.map(item => 
                        item.key === pt.key ? { ...item, label: newLabel.trim(), icon: newIcon.trim() } : item
                      );
                      setEditablePT(updated);
                      saveData("editable_pt_v1", updated);
                    }
                  }
                }} style={{ fontSize: 11, padding: "4px 8px", background: `${pt.color}30`, border: `1px solid ${pt.color}`, borderRadius: 6, color: pt.color, cursor: "pointer", flexShrink: 0, marginTop: 0, fontWeight: 600 }}>âœï¸</button>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  if (confirm(`Delete "${pt.label}" PT item?`)) {
                    const updated = editablePT.filter(item => item.key !== pt.key);
                    setEditablePT(updated);
                    saveData("editable_pt_v1", updated);
                  }
                }} style={{ fontSize: 14, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>Ã—</button>
              </div>
            );
          })}

          {/* Custom PT Items */}
          {customPT.map(pt => {
            const val = today[pt.key];
            const nullKey = todayStr() + "_" + pt.key;
            const isNulled = nulledHabits[nullKey];
            return (
              <div key={pt.key} style={{ display: "flex", gap: 8, alignItems: "flex-start" }}>
                <div style={{ flex: 1 }}>
                  <HabitRowWithDetails 
                    habit={pt}
                    val={val}
                    today={today}
                    onToggle={() => updateLog(todayStr(), pt.key, !val)}
                    onDetails={(key, value) => updateLog(todayStr(), key, value)}
                    detailsKey={`${pt.key}Details`}
                    isNulled={isNulled}
                    onSkip={() => toggleNulled(pt.key)}
                  />
                </div>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  const newLabel = prompt("Edit PT item name:", pt.label);
                  if (newLabel && newLabel.trim()) {
                    const newIcon = prompt("Edit emoji icon:", pt.icon);
                    if (newIcon && newIcon.trim()) {
                      const updated = customPT.map(item => 
                        item.key === pt.key 
                          ? { ...item, label: newLabel.trim(), icon: newIcon.trim() }
                          : item
                      );
                      setCustomPT(updated);
                      saveData("custom_pt_v1", updated);
                    }
                  }
                }} style={{ fontSize: 11, padding: "4px 8px", background: "rgba(56,189,248,0.15)", border: "1px solid rgba(56,189,248,0.3)", borderRadius: 6, color: "#38bdf8", cursor: "pointer", flexShrink: 0, marginTop: 0, fontWeight: 600 }}>âœï¸</button>
                <button type="button" onClick={(e) => {
                  e.stopPropagation();
                  if (confirm(`Delete "${pt.label}" PT item?`)) {
                    const updated = customPT.filter(item => item.key !== pt.key);
                    setCustomPT(updated);
                    saveData("custom_pt_v1", updated);
                  }
                }} style={{ fontSize: 14, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0, marginTop: 0 }}>Ã—</button>
              </div>
            );
          })}

          {/* Add Custom PT Button */}
          <button onClick={() => {
            const label = prompt("PT item name (e.g., 'Foam Rolling'):");
            if (!label || !label.trim()) return;
            const icon = prompt("Emoji icon (e.g., ðŸ”„):");
            if (!icon || !icon.trim()) return;
            const key = `custom_pt_${Date.now()}`;
            const color = "#38bdf8"; // Sky blue for custom PT
            const newPT = { key, label: label.trim(), icon: icon.trim(), color };
            const updated = [...customPT, newPT];
            setCustomPT(updated);
            saveData("custom_pt_v1", updated);
          }} style={{ width: "100%", padding: "10px", background: "rgba(56,189,248,0.1)", border: "1px solid rgba(56,189,248,0.3)", borderRadius: 10, color: "#38bdf8", fontSize: 12, fontWeight: 700, cursor: "pointer", marginBottom: 16, fontFamily: "'Syne', sans-serif" }}>
            + Add Custom PT Item
          </button>

          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10, marginTop: 16 }}>DAILY RITUAL</div>
          {[
            { key: "affirmation", label: "Affirmation", placeholder: "Today I amâ€¦", rows: 2, color: "#c9a227" },
            { key: "mitzvah", label: "One Mitzvah", placeholder: "One good deed todayâ€¦", rows: 2, color: "#34d399" },
          ].map(f => (
            <div key={f.key} style={{ marginBottom: 10 }}>
              <div style={{ fontSize: 11, color: `${f.color}99`, fontWeight: 600, letterSpacing: "0.06em", marginBottom: 5 }}>{f.label.toUpperCase()}</div>
              <textarea rows={f.rows} placeholder={f.placeholder} value={today[f.key] || ""} onChange={e => updateLog(todayStr(), f.key, e.target.value)} style={{ borderColor: today[f.key] ? `${f.color}33` : "rgba(255,255,255,0.1)" }} />
            </div>
          ))}

          <div style={{ marginBottom: 10 }}>
            <div style={{ fontSize: 11, color: "rgba(52,211,153,0.7)", fontWeight: 600, letterSpacing: "0.06em", marginBottom: 5 }}>GRATEFUL FOR</div>
            {[0,1,2].map(i => (
              <input key={i} placeholder={`${i+1}. I'm grateful forâ€¦`} value={(today.gratitude||[])[i]||""} onChange={e => { const g=[...(today.gratitude||["","",""])]; g[i]=e.target.value; updateLog(todayStr(),"gratitude",g); }} style={{ marginBottom: 5 }} />
            ))}
          </div>

          {/* Meals & Calories */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10, marginTop: 16 }}>MEALS & CALORIES</div>
          <div className="card" style={{ marginBottom: 14 }}>
            <button onClick={() => setShowMealModal(true)} style={{ width: "100%", padding: "10px", background: "rgba(52,211,153,0.1)", border: "1px solid rgba(52,211,153,0.3)", borderRadius: 10, color: "#34d399", fontSize: 12, fontWeight: 700, cursor: "pointer" }}>
              ðŸ“ Log Meals & Calories
            </button>
            {(() => {
              const meals = today.meals || {};
              const totalCals = (meals.breakfast?.calories || 0) + (meals.lunch?.calories || 0) + (meals.dinner?.calories || 0) + (meals.snacks?.calories || 0);
              if (totalCals === 0) return null;
              return (
                <div style={{ marginTop: 10 }}>
                  <div style={{ fontSize: 13, fontWeight: 700, color: "#34d399", marginBottom: 6 }}>Total: {totalCals} calories</div>
                  {["breakfast", "lunch", "dinner", "snacks"].map(m => meals[m] && (
                    <div key={m} style={{ fontSize: 11, color: "rgba(255,255,255,0.5)", marginBottom: 3, display: "flex", justifyContent: "space-between" }}>
                      <span>{m.charAt(0).toUpperCase() + m.slice(1)}: {meals[m].description}</span>
                      <span style={{ color: "#34d399", fontWeight: 600 }}>{meals[m].calories} cal</span>
                    </div>
                  ))}
                </div>
              );
            })()}
          </div>

          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10, marginTop: 16 }}>CAREER + NOTES</div>
          {[
            { key: "workWin", label: "Work Win", placeholder: "Today's career accomplishmentâ€¦", rows: 2, color: "#60a5fa" },
            { key: "notes", label: "Notes", placeholder: "Everything elseâ€¦", rows: 3, color: "rgba(255,255,255,0.3)" },
          ].map(f => (
            <div key={f.key} style={{ marginBottom: 10 }}>
              <div style={{ fontSize: 11, color: f.color, fontWeight: 600, letterSpacing: "0.06em", marginBottom: 5 }}>{f.label.toUpperCase()}</div>
              <textarea rows={f.rows} placeholder={f.placeholder} value={today[f.key]||""} onChange={e => updateLog(todayStr(), f.key, e.target.value)} />
            </div>
          ))}

          <div style={{ marginBottom: 20 }}>
            <div style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", fontWeight: 600, letterSpacing: "0.06em", marginBottom: 8 }}>MOOD</div>
            <div style={{ display: "flex", gap: 4 }}>
              {[1,2,3,4,5,6,7,8,9,10].map(n => (
                <div key={n} onClick={() => updateLog(todayStr(),"mood",n)} style={{ flex:1, height: 28, borderRadius: 6, background: (today.mood||0)>=n ? "#c9a227" : "rgba(255,255,255,0.06)", cursor:"pointer", transition:"all 0.15s" }} />
              ))}
            </div>
            <div style={{ fontSize: 10, color:"rgba(255,255,255,0.25)", marginTop:5 }}>Today: {today.mood||"â€”"}/10</div>
          </div>

          {/* Edit Entry Button */}
          <button className="primary" style={{ marginTop: 8, marginBottom: 20 }} 
            onClick={() => { setSelectedDate(todayStr()); setEditData({...(logs[todayStr()]||{})}); setEditing(true); setView("journal_day"); }}>
            âœï¸ Edit Full Entry
          </button>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* â”€â”€ 5AM CLUB SCHEDULE TAB â”€â”€ */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {view === "schedule" && (
        <div style={{ padding: "14px 18px" }}>

          {/* Sub-nav */}
          <div style={{ display: "flex", gap: 6, marginBottom: 16, background: "rgba(255,255,255,0.04)", borderRadius: 12, padding: 4 }}>
            {[
              { id: "schedule", label: "Schedule" },
              { id: "tactics", label: "10 Tactics" },
              { id: "formula", label: "Formula" },
              { id: "protocol", label: "Protocol" },
            ].map(t => (
              <button key={t.id} className="stab" onClick={() => setSchedSection(t.id)}
                style={{ flex: 1, color: schedSection === t.id ? "#c9a227" : "rgba(255,255,255,0.35)", background: schedSection === t.id ? "rgba(201,162,39,0.12)" : "none" }}>
                {t.label}
              </button>
            ))}
          </div>

          {/* â”€â”€ SCHEDULE SECTION â”€â”€ */}
          {schedSection === "schedule" && (
            <div>
              {/* Today's progress */}
              <div style={{ background: "linear-gradient(135deg, rgba(201,162,39,0.1), rgba(201,162,39,0.03))", border: "1px solid rgba(201,162,39,0.2)", borderRadius: 16, padding: "14px 16px", marginBottom: 16, display: "flex", alignItems: "center", gap: 14 }}>
                <div style={{ position: "relative", width: 56, height: 56, flexShrink: 0 }}>
                  <Radial val={schedTodayDone} max={schedTodayTotal} color="#c9a227" size={56} />
                  <div style={{ position: "absolute", inset: 0, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: "#c9a227" }}>{Math.round(schedTodayDone/schedTodayTotal*100)}%</div>
                </div>
                <div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: "#c9a227" }}>{schedTodayDone}/{schedTodayTotal}</div>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>blocks completed today</div>
                  <div style={{ fontSize: 10, color: "rgba(201,162,39,0.6)", marginTop: 3, fontStyle: "italic" }}>"Own your morning. Elevate your life."</div>
                </div>
              </div>

              {/* Schedule blocks */}
              {(() => {
                const isWeekend = new Date().getDay() === 0 || new Date().getDay() === 6;
                const displaySchedule = isWeekend 
                  ? SCHEDULE_BLOCKS.filter(b => b.id !== "office")
                  : SCHEDULE_BLOCKS;
                
                return displaySchedule.map(block => {
                  const blockDone = block.items.filter(item => scheduleChecks[todayStr() + "_" + item.key]).length;
                  const isOpen = expandedBlock === block.id;
                  return (
                    <div key={block.id} style={{ marginBottom: 10 }}>
                      <div onClick={() => setExpandedBlock(isOpen ? null : block.id)}
                        style={{ background: `${block.color}10`, border: `1px solid ${block.color}25`, borderRadius: isOpen ? "14px 14px 0 0" : 14, padding: "13px 15px", cursor: "pointer", display: "flex", alignItems: "center", gap: 12, transition: "all 0.2s" }}>
                        <div style={{ fontSize: 20 }}>{block.icon}</div>
                        <div style={{ flex: 1 }}>
                        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                          <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: block.color }}>{block.label}</div>
                          <div style={{ fontSize: 11, fontFamily: "'Syne', sans-serif", fontWeight: 700, color: blockDone === block.items.length ? "#34d399" : block.color }}>{blockDone}/{block.items.length}</div>
                        </div>
                        <div style={{ fontSize: 10, color: "rgba(255,255,255,0.35)", marginTop: 2 }}>{block.time}</div>
                      </div>
                      <div style={{ fontSize: 12, color: "rgba(255,255,255,0.3)" }}>{isOpen ? "â–²" : "â–¼"}</div>
                    </div>

                    {isOpen && (
                      <div style={{ background: "rgba(255,255,255,0.025)", border: `1px solid ${block.color}20`, borderTop: "none", borderRadius: "0 0 14px 14px", padding: "4px 15px 12px" }}>
                        <div style={{ fontSize: 11, color: "rgba(255,255,255,0.35)", fontStyle: "italic", padding: "10px 0 6px", borderBottom: "1px solid rgba(255,255,255,0.05)", marginBottom: 4 }}>{block.desc}</div>
                        {block.items.map(item => {
                          const isDone = scheduleChecks[todayStr() + "_" + item.key];
                          return (
                            <div key={item.key} className="sched-item" onClick={() => toggleScheduleCheck(item.key)}>
                              <div className="check-circle" style={{ borderColor: isDone ? block.color : "rgba(255,255,255,0.2)", background: isDone ? block.color : "transparent", color: "#000" }}>
                                {isDone && "âœ“"}
                              </div>
                              <div style={{ flex: 1 }}>
                                <div style={{ display: "flex", gap: 8, alignItems: "center", marginBottom: 3 }}>
                                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12, color: isDone ? block.color : "#fff", textDecoration: isDone ? "line-through" : "none", opacity: isDone ? 0.7 : 1 }}>{item.label}</div>
                                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.25)" }}>{item.time}</div>
                                </div>
                                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", lineHeight: 1.5 }}>{item.detail}</div>
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    )}
                  </div>
                );
                });
              })()}

              {/* Weekly workout split */}
              <div className="card" style={{ marginTop: 6 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 12, color: "#ff6b6b" }}>ðŸ’ª Weekly Workout Split</div>
                {[
                  { day: "Mon", muscle: "Cardio / Basketball" },
                  { day: "Tue", muscle: "Shoulders" },
                  { day: "Wed", muscle: "Legs" },
                  { day: "Thu", muscle: "Chest" },
                  { day: "Fri", muscle: "Triceps" },
                  { day: "Sat", muscle: "Back" },
                  { day: "Sun", muscle: "Biceps" },
                ].map(d => {
                  const today = new Date().getDay();
                  const dayIdx = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].indexOf(d.day);
                  const isToday = today === dayIdx;
                  return (
                    <div key={d.day} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 8, padding: "8px 10px", borderRadius: 10, background: isToday ? "rgba(255,107,107,0.08)" : "transparent", border: isToday ? "1px solid rgba(255,107,107,0.2)" : "1px solid transparent" }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: isToday ? "#ff6b6b" : "rgba(255,255,255,0.4)", width: 30 }}>{d.day}</div>
                      <div style={{ flex: 1, fontSize: 13, color: isToday ? "#fff" : "rgba(255,255,255,0.6)" }}>{d.muscle}</div>
                      {isToday && <div style={{ fontSize: 10, color: "#ff6b6b", fontWeight: 700 }}>TODAY</div>}
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {/* â”€â”€ 10 TACTICS SECTION â”€â”€ */}
          {schedSection === "tactics" && (
            <div>
              <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, color: "rgba(255,255,255,0.3)", marginBottom: 14, lineHeight: 1.6 }}>
                10 Tactics of Lifelong Genius â€” check off each one you apply today
              </div>
              {TACTICS.map(t => {
                const done = tacticsDone[todayStr() + "_t" + t.n];
                return (
                  <div key={t.n} onClick={() => toggleTactic(t.n)} style={{ display: "flex", gap: 12, alignItems: "flex-start", padding: "13px 14px", background: done ? "rgba(201,162,39,0.07)" : "rgba(255,255,255,0.03)", border: `1px solid ${done ? "rgba(201,162,39,0.25)" : "rgba(255,255,255,0.07)"}`, borderRadius: 13, marginBottom: 8, cursor: "pointer", transition: "all 0.2s" }}>
                    <div style={{ display: "flex", gap: 8, alignItems: "center", flexShrink: 0, paddingTop: 1 }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 11, color: done ? "#c9a227" : "rgba(255,255,255,0.25)", width: 16 }}>#{t.n}</div>
                      <div className="check-circle" style={{ borderColor: done ? "#c9a227" : "rgba(255,255,255,0.2)", background: done ? "#c9a227" : "transparent", color: "#000", width: 20, height: 20 }}>{done && "âœ“"}</div>
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, color: done ? "#c9a227" : "#fff", marginBottom: 4 }}>{t.icon} {t.name}</div>
                      <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", lineHeight: 1.5 }}>{t.desc}</div>
                    </div>
                  </div>
                );
              })}
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, textAlign: "center", color: "#c9a227", marginTop: 8 }}>
                {Object.values(tacticsDone).filter((v,k) => v && Object.keys(tacticsDone)[k]?.startsWith(todayStr())).length}/10 tactics applied today
              </div>
            </div>
          )}

          {/* â”€â”€ 3-STEP SUCCESS FORMULA SECTION â”€â”€ */}
          {schedSection === "formula" && (
            <div>
              <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, color: "rgba(255,255,255,0.3)", marginBottom: 16, lineHeight: 1.6 }}>
                "Dedication and discipline beats brilliance and giftedness every day of the week." Complete all 3 steps to activate a world-class day.
              </div>
              {SUCCESS_FORMULA.map(s => {
                const doneCt = s.step === 1
                  ? [!!(today.affirmation?.trim()), today.gratitude?.filter(Boolean).length >= 3, !!(today.journal), !!(today.mitzvah?.trim())].filter(Boolean).length
                  : s.step === 2
                  ? [!!(today.workout), (today.water||0) >= 8, !!(today.meditation), !!(today.floss && today.retainer)].filter(Boolean).length
                  : [(today.bookPages||today.reading||0) >= 20, false, false, false].filter(Boolean).length;
                return (
                  <div key={s.step} style={{ background: `${s.color}08`, border: `1px solid ${s.color}25`, borderRadius: 16, padding: "16px", marginBottom: 12 }}>
                    <div style={{ display: "flex", gap: 10, alignItems: "center", marginBottom: 12 }}>
                      <div style={{ fontSize: 28 }}>{s.icon}</div>
                      <div>
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 11, color: s.color, letterSpacing: "0.1em" }}>STEP {s.step}</div>
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 16 }}>{s.label}</div>
                      </div>
                      <div style={{ marginLeft: "auto", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: s.color }}>{doneCt}/{s.checks.length}</div>
                    </div>
                    <div style={{ display: "flex", gap: 5, marginBottom: 10 }}>
                      {s.checks.map((_, i) => <div key={i} style={{ flex: 1, height: 4, borderRadius: 2, background: i < doneCt ? s.color : "rgba(255,255,255,0.1)", transition: "background 0.3s" }} />)}
                    </div>
                    {s.checks.map((check, i) => (
                      <div key={i} style={{ display: "flex", gap: 8, alignItems: "center", marginBottom: 6 }}>
                        <div style={{ width: 16, height: 16, borderRadius: "50%", background: i < doneCt ? s.color : "rgba(255,255,255,0.07)", border: `1.5px solid ${i < doneCt ? s.color : "rgba(255,255,255,0.15)"}`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 9, color: "#000", flexShrink: 0 }}>{i < doneCt && "âœ“"}</div>
                        <div style={{ fontSize: 12, color: i < doneCt ? "#fff" : "rgba(255,255,255,0.4)" }}>{check}</div>
                      </div>
                    ))}
                  </div>
                );
              })}

              {/* Daily Abundance Journal Template */}
              <div className="card" style={{ marginTop: 6 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 12, color: "#c9a227" }}>ðŸ“‹ Daily Abundance Journal Template</div>
                {[
                  { n: 1, label: "Gratitude", sub: "1 small Â· 1 meaningful Â· 1 future-oriented (as if already unfolding)" },
                  { n: 2, label: "Identity Statement", sub: "'Today, I showed up as someone whoâ€¦'" },
                  { n: 3, label: "Value Created / Wins", sub: "1â€“3 wins or ways you created value (work, discipline, relationships)" },
                  { n: 4, label: "Lessons or Leverage", sub: "What did today teach me? What worked that I should repeat?" },
                  { n: 5, label: "Clearing Resistance", sub: "'Right now, the thing I'm avoiding or resisting isâ€¦'" },
                  { n: 6, label: "Intention for Tomorrow", sub: "'Tomorrow, the one thing that matters most isâ€¦'" },
                ].map(s => (
                  <div key={s.n} style={{ display: "flex", gap: 10, marginBottom: 10, padding: "8px 0", borderBottom: "1px solid rgba(255,255,255,0.05)" }}>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 14, color: "#c9a227", width: 20, flexShrink: 0 }}>{s.n}.</div>
                    <div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12, marginBottom: 2 }}>{s.label}</div>
                      <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", lineHeight: 1.5 }}>{s.sub}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* â”€â”€ HABIT INSTALLATION PROTOCOL SECTION â”€â”€ */}
          {schedSection === "protocol" && (
            <div>
              {/* Protocol Manual Controls */}
              <div style={{ background: "rgba(201,162,39,0.06)", border: "1px solid rgba(201,162,39,0.2)", borderRadius: 14, padding: "14px 16px", marginBottom: 16 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 10, color: "#c9a227" }}>ðŸ“– Protocol Reference</div>
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)", lineHeight: 1.6, marginBottom: 10 }}>
                  The 66-day protocol for building automatic habits:
                </div>
                <div style={{ display: "flex", flexDirection: "column", gap: 8 }}>
                  <div style={{ padding: "8px 12px", background: "rgba(255,107,107,0.08)", borderRadius: 8, borderLeft: "3px solid #ff6b6b" }}>
                    <div style={{ fontSize: 11, fontWeight: 700, color: "#ff6b6b" }}>Days 1-22: Destruction</div>
                    <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>Expect resistance. This is where most quit.</div>
                  </div>
                  <div style={{ padding: "8px 12px", background: "rgba(251,191,36,0.08)", borderRadius: 8, borderLeft: "3px solid #fbbf24" }}>
                    <div style={{ fontSize: 11, fontWeight: 700, color: "#fbbf24" }}>Days 23-44: Installation</div>
                    <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>Getting automatic. The new you is emerging.</div>
                  </div>
                  <div style={{ padding: "8px 12px", background: "rgba(52,211,153,0.08)", borderRadius: 8, borderLeft: "3px solid #34d399" }}>
                    <div style={{ fontSize: 11, fontWeight: 700, color: "#34d399" }}>Days 45-66: Integration</div>
                    <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>This is your new identity. Lock it in forever.</div>
                  </div>
                </div>
              </div>

              <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, color: "rgba(255,255,255,0.3)", marginBottom: 16, lineHeight: 1.6 }}>
                "All change is hard at first, messy in the middle and gorgeous at the end." â€” Robin Sharma
              </div>

              {/* Current phase big card */}
              <div style={{ background: `${habitPhase.color}12`, border: `2px solid ${habitPhase.color}35`, borderRadius: 18, padding: "18px", marginBottom: 16 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 22, color: habitPhase.color, marginBottom: 4 }}>{habitPhase.phase} Phase</div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 12, color: "rgba(255,255,255,0.5)", marginBottom: 14 }}>{habitPhase.label} Â· Day {habitPhase.days}</div>
                <div style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 10 }}>
                  <PhaseBar pct={habitPhase.pct} color={habitPhase.color} />
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: habitPhase.color, flexShrink: 0 }}>{Math.round(habitPhase.pct * 100)}%</div>
                </div>
                <div style={{ fontSize: 12, color: "rgba(255,255,255,0.5)", lineHeight: 1.6 }}>{habitPhase.desc}</div>
              </div>

              {/* 3 Phases */}
              {[
                { phase: "Destruction", days: "1â€“22", color: "#ff6b6b", icon: "ðŸ”¥", desc: "Your old patterns are fighting back hard. Expect disruption, discomfort, and the voice that says quit. Use it as proof you're changing.", rule: "Rule #5: When you feel like surrendering, continue. Triumph loves the relentless." },
                { phase: "Installation", days: "23â€“44", color: "#fbbf24", icon: "âš™ï¸", desc: "The new behavior is becoming automatic. You'll notice it feels less forced. Your identity is shifting. Keep showing up.", rule: "Rule #2: Small daily improvements done consistently over time lead to stunning results." },
                { phase: "Integration", days: "45â€“66", color: "#34d399", icon: "ðŸŒŸ", desc: "This is now who you are. The 5AM Club member. The journaler. The lifelong genius. Your new standard operating system.", rule: "Rule #3: Everything you now find easy you first found difficult. With practice, this is your new normal." },
              ].map(p => {
                const current = p.phase === habitPhase.phase;
                return (
                  <div key={p.phase} style={{ background: current ? `${p.color}10` : "rgba(255,255,255,0.03)", border: `1px solid ${current ? p.color + "30" : "rgba(255,255,255,0.07)"}`, borderRadius: 14, padding: "14px", marginBottom: 10, opacity: current ? 1 : 0.6 }}>
                    <div style={{ display: "flex", gap: 10, alignItems: "center", marginBottom: 8 }}>
                      <div style={{ fontSize: 22 }}>{p.icon}</div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 14, color: p.color }}>{p.phase} Phase</div>
                        <div style={{ fontSize: 11, color: "rgba(255,255,255,0.35)" }}>Days {p.days}</div>
                      </div>
                      {current && <div style={{ fontSize: 10, background: `${p.color}20`, color: p.color, padding: "3px 8px", borderRadius: 10, fontFamily: "'Syne', sans-serif", fontWeight: 700 }}>YOU ARE HERE</div>}
                    </div>
                    <div style={{ fontSize: 12, color: "rgba(255,255,255,0.5)", lineHeight: 1.6, marginBottom: 8 }}>{p.desc}</div>
                    <div style={{ fontSize: 11, color: p.color, fontStyle: "italic", lineHeight: 1.5 }}>"{p.rule}"</div>
                  </div>
                );
              })}

              {/* Per-habit streaks */}
              <div className="card" style={{ marginTop: 6 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 12 }}>ðŸ”¢ Habit Streaks</div>
                {[
                  { label: "Journal", key: "journal", icon: "ðŸ““", color: "#c084fc" },
                  { label: "Workout", key: "workout", icon: "ðŸ‹ï¸", color: "#ff6b6b" },
                  { label: "Meditation", key: "meditation", icon: "ðŸ§˜", color: "#34d399" },
                  { label: "Retainer", key: "retainer", icon: "ðŸ˜", color: "#38bdf8" },
                  { label: "Floss", key: "floss", icon: "ðŸ¦·", color: "#60a5fa" },
                  { label: "Finance", key: "finance", icon: "ðŸ’°", color: "#fbbf24" },
                ].map(h => {
                  let streak = 0;
                  const td = new Date();
                  for (let i = 0; i < 200; i++) {
                    const d = new Date(td); d.setDate(d.getDate() - i);
                    const k = d.toISOString().split("T")[0];
                    if (logs[k]?.[h.key]) streak++; else if (i > 0) break;
                  }
                  const phase = streak <= 22 ? "#ff6b6b" : streak <= 44 ? "#fbbf24" : "#34d399";
                  return (
                    <div key={h.key} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 10 }}>
                      <span style={{ fontSize: 16 }}>{h.icon}</span>
                      <div style={{ fontSize: 12, color: "rgba(255,255,255,0.6)", width: 70 }}>{h.label}</div>
                      <div style={{ flex: 1, height: 5, background: "rgba(255,255,255,0.07)", borderRadius: 3, overflow: "hidden" }}>
                        <div style={{ height: "100%", width: `${Math.min(streak / 66, 1) * 100}%`, background: phase, borderRadius: 3, transition: "width 0.8s" }} />
                      </div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: phase, width: 26, textAlign: "right" }}>{streak}</div>
                    </div>
                  );
                })}
                
                {/* Custom Habits */}
                {protocolSettings.customHabits && protocolSettings.customHabits.length > 0 && protocolSettings.customHabits.map(ch => {
                  let streak = 0;
                  const td = new Date();
                  for (let i = 0; i < 200; i++) {
                    const d = new Date(td); d.setDate(d.getDate() - i);
                    const k = d.toISOString().split("T")[0];
                    if (logs[k]?.[ch.key]) streak++; else if (i > 0) break;
                  }
                  const phase = streak <= 22 ? "#ff6b6b" : streak <= 44 ? "#fbbf24" : "#34d399";
                  return (
                    <div key={ch.key} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 10 }}>
                      <span style={{ fontSize: 16 }}>{ch.icon}</span>
                      <div style={{ fontSize: 12, color: "rgba(255,255,255,0.6)", width: 70 }}>{ch.label}</div>
                      <div style={{ flex: 1, height: 5, background: "rgba(255,255,255,0.07)", borderRadius: 3, overflow: "hidden" }}>
                        <div style={{ height: "100%", width: `${Math.min(streak / 66, 1) * 100}%`, background: phase, borderRadius: 3, transition: "width 0.8s" }} />
                      </div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: phase, width: 26, textAlign: "right" }}>{streak}</div>
                      <button onClick={() => {
                        if (confirm(`Remove "${ch.label}" from protocol tracking?`)) {
                          const updated = protocolSettings.customHabits.filter(h => h.key !== ch.key);
                          updateProtocol({ customHabits: updated });
                        }
                      }} style={{ fontSize: 11, padding: "4px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                    </div>
                  );
                })}

                {/* Add Custom Habit Button */}
                <button onClick={() => {
                  const label = prompt("Habit name (e.g., 'Cold Shower', 'Yoga'):");
                  if (!label || !label.trim()) return;
                  const icon = prompt("Emoji icon (e.g., ðŸ§Š, ðŸ§˜):");
                  if (!icon || !icon.trim()) return;
                  const key = "custom_" + label.toLowerCase().replace(/\s+/g, "_") + "_" + Date.now();
                  const newHabit = { key, label: label.trim(), icon: icon.trim() };
                  const customHabits = [...(protocolSettings.customHabits || []), newHabit];
                  updateProtocol({ customHabits });
                }} style={{ width: "100%", padding: "10px", marginTop: 8, background: "rgba(201,162,39,0.1)", border: "1px solid rgba(201,162,39,0.3)", borderRadius: 10, color: "#c9a227", fontSize: 12, fontWeight: 700, cursor: "pointer", fontFamily: "'Syne', sans-serif" }}>
                  + Add Custom Habit to Track
                </button>

                <div style={{ fontSize: 10, color: "rgba(255,255,255,0.2)", marginTop: 8, textAlign: "center" }}>
                  ðŸ”´ Days 1â€“22 Â· ðŸŸ¡ Days 23â€“44 Â· ðŸŸ¢ Days 45â€“66
                </div>
              </div>

              {/* Amazing Day Deconstruction */}
              <div className="card" style={{ marginTop: 10 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 10, color: "#c9a227" }}>â­ Amazing Day Deconstruction</div>
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.35)", marginBottom: 12 }}>Your best recent days â€” what made them elite?</div>
                {Object.entries(logs).filter(([_, e]) => (e.mood || 0) >= 9).sort(([a],[b]) => b.localeCompare(a)).slice(0,5).map(([date, e]) => (
                  <div key={date} style={{ padding: "10px 0", borderBottom: "1px solid rgba(255,255,255,0.05)" }}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 4 }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12 }}>{formatDate(date)}</div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, color: "#c9a227", fontSize: 13 }}>ðŸ˜Š {e.mood}/10</div>
                    </div>
                    <div style={{ display: "flex", gap: 4, flexWrap: "wrap", marginBottom: 4 }}>
                      {[e.workout && "ðŸ’ª Workout", e.journal && "ðŸ““ Journal", (e.bookPages||e.reading||0)>0 && `ðŸ“– ${e.bookPages||e.reading}pg`, e.mitzvah && "ðŸ™ Mitzvah"].filter(Boolean).map((c,i) => (
                        <div key={i} style={{ fontSize: 10, background: "rgba(201,162,39,0.12)", color: "#c9a227", padding: "2px 7px", borderRadius: 10 }}>{c}</div>
                      ))}
                    </div>
                    {e.affirmation && <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", fontStyle: "italic" }}>"{e.affirmation.slice(0,80)}â€¦"</div>}
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* â”€â”€ STATS VIEW â”€â”€ */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {view === "stats" && (
        <div style={{ padding: "14px 18px" }}>
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 12 }}>2026 PROGRESS</div>
          
          {/* Personal Habits */}
          <div style={{ fontSize: 11, fontWeight: 700, color: "rgba(255,255,255,0.35)", marginBottom: 8 }}>Personal Habits</div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8, marginBottom: 16 }}>
            {editableHabits.map(h => {
              const count = Object.values(logs).filter(d => d[h.key]).length;
              return (
                <div key={h.key} onClick={() => setStatsDrillDown({ label: h.label, value: count, icon: h.icon, color: h.color, key: h.key })} 
                  style={{ background: `${h.color}10`, border: `1px solid ${h.color}30`, borderRadius: 12, padding: "12px 10px", textAlign: "center", cursor: "pointer", transition: "all 0.2s" }}
                  onMouseEnter={e => e.currentTarget.style.background = `${h.color}20`}
                  onMouseLeave={e => e.currentTarget.style.background = `${h.color}10`}>
                  <div style={{ fontSize: 20, marginBottom: 4 }}>{h.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: h.color, lineHeight: 1 }}>{count}</div>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{h.label}</div>
                </div>
              );
            })}
            {customHabits.map(h => {
              const count = Object.values(logs).filter(d => d[h.key]).length;
              return (
                <div key={h.key} onClick={() => setStatsDrillDown({ label: h.label, value: count, icon: h.icon, color: h.color, key: h.key })} 
                  style={{ background: `${h.color}10`, border: `1px solid ${h.color}30`, borderRadius: 12, padding: "12px 10px", textAlign: "center", cursor: "pointer", transition: "all 0.2s" }}
                  onMouseEnter={e => e.currentTarget.style.background = `${h.color}20`}
                  onMouseLeave={e => e.currentTarget.style.background = `${h.color}10`}>
                  <div style={{ fontSize: 20, marginBottom: 4 }}>{h.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: h.color, lineHeight: 1 }}>{count}</div>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{h.label}</div>
                </div>
              );
            })}
          </div>

          {/* PT / Superlatives */}
          <div style={{ fontSize: 11, fontWeight: 700, color: "rgba(255,255,255,0.35)", marginBottom: 8 }}>PT / Superlatives</div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8, marginBottom: 16 }}>
            {editablePT.map(pt => {
              const count = Object.values(logs).filter(d => d[pt.key]).length;
              return (
                <div key={pt.key} onClick={() => setStatsDrillDown({ label: pt.label, value: count, icon: pt.icon, color: pt.color, key: pt.key })}
                  style={{ background: `${pt.color}10`, border: `1px solid ${pt.color}30`, borderRadius: 12, padding: "12px 10px", textAlign: "center", cursor: "pointer", transition: "all 0.2s" }}
                  onMouseEnter={e => e.currentTarget.style.background = `${pt.color}20`}
                  onMouseLeave={e => e.currentTarget.style.background = `${pt.color}10`}>
                  <div style={{ fontSize: 18, marginBottom: 4 }}>{pt.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: pt.color, lineHeight: 1 }}>{count}</div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{pt.label}</div>
                </div>
              );
            })}
            {customPT.map(pt => {
              const count = Object.values(logs).filter(d => d[pt.key]).length;
              return (
                <div key={pt.key} onClick={() => setStatsDrillDown({ label: pt.label, value: count, icon: pt.icon, color: pt.color, key: pt.key })}
                  style={{ background: `${pt.color}10`, border: `1px solid ${pt.color}30`, borderRadius: 12, padding: "12px 10px", textAlign: "center", cursor: "pointer", transition: "all 0.2s" }}
                  onMouseEnter={e => e.currentTarget.style.background = `${pt.color}20`}
                  onMouseLeave={e => e.currentTarget.style.background = `${pt.color}10`}>
                  <div style={{ fontSize: 18, marginBottom: 4 }}>{pt.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: pt.color, lineHeight: 1 }}>{count}</div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{pt.label}</div>
                </div>
              );
            })}
          </div>

          {/* Other Metrics */}
          <div style={{ fontSize: 11, fontWeight: 700, color: "rgba(255,255,255,0.35)", marginBottom: 8 }}>Other Metrics</div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8, marginBottom: 16 }}>
            {[
              { label: "Mitzvahs", value: mitzvahs, icon: "ðŸ™", color: "#34d399" },
              { label: "Journal Streak", value: journalStreak, icon: "ðŸ”¥", color: "#c9a227" },
            ].map(s => (
              <div key={s.label} style={{ background: "rgba(255,255,255,0.035)", border: "1px solid rgba(255,255,255,0.07)", borderRadius: 12, padding: "12px 10px", textAlign: "center" }}>
                <div style={{ fontSize: 20, marginBottom: 4 }}>{s.icon}</div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: s.color, lineHeight: 1 }}>{s.value}</div>
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{s.label}</div>
              </div>
            ))}
          </div>

          {/* Nutrition */}
          <div style={{ fontSize: 11, fontWeight: 700, color: "rgba(255,255,255,0.35)", marginBottom: 8 }}>Nutrition & Fitness</div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr 1fr", gap: 8, marginBottom: 16 }}>
            {(() => {
              const totalConsumed = Object.values(logs).reduce((sum, day) => {
                const meals = day.meals || {};
                return sum + (meals.breakfast?.calories || 0) + (meals.lunch?.calories || 0) + (meals.dinner?.calories || 0) + (meals.snacks?.calories || 0);
              }, 0);
              const totalBurned = Object.values(logs).reduce((sum, day) => sum + (day.workoutCalories || 0), 0);
              const net = totalConsumed - totalBurned;
              
              return [
                { label: "Consumed", value: totalConsumed, icon: "ðŸ½ï¸", color: "#34d399" },
                { label: "Burned", value: totalBurned, icon: "ðŸ”¥", color: "#ff6b6b" },
                { label: "Net", value: net, icon: "âš–ï¸", color: net > 0 ? "#fbbf24" : "#60a5fa" },
              ].map(s => (
                <div key={s.label} style={{ background: "rgba(255,255,255,0.035)", border: "1px solid rgba(255,255,255,0.07)", borderRadius: 12, padding: "12px 10px", textAlign: "center" }}>
                  <div style={{ fontSize: 18, marginBottom: 4 }}>{s.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 20, color: s.color, lineHeight: 1 }}>{s.value}</div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.45)", marginTop: 3 }}>{s.label}</div>
                </div>
              ));
            })()}
          </div>
          
          <div className="card">
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 12 }}>ðŸ’ª Muscle Groups (2026)</div>
            {(() => {
              const g = { Chest:0, Back:0, Shoulders:0, Legs:0, Biceps:0, Triceps:0 };
              Object.values(logs).forEach(d => {
                const w = (d.workoutDetails||"").toLowerCase();
                if (w.includes("chest")||w.includes("bench")||w.includes("fly")) g.Chest++;
                if (/\bback\b/.test(w)||w.includes("lat")||w.includes("row")||w.includes("pulldown")) g.Back++;
                if (w.includes("shoulder")||w.includes("military")||w.includes("lateral")||w.includes("delt")) g.Shoulders++;
                if (w.includes("leg")||w.includes("squat")||w.includes("deadlift")||w.includes("calf")||w.includes("lunge")) g.Legs++;
                if (w.includes("bicep")||w.includes("curl")) g.Biceps++;
                if (w.includes("tricep")||w.includes("skull")||w.includes("dip")) g.Triceps++;
              });
              const mx = Math.max(...Object.values(g));
              return Object.entries(g).map(([nm, n]) => (
                <div key={nm} onClick={() => setStatsDrillDown({ label: nm, key: "muscle", icon: "ðŸ’ª", color: "#ff6b6b", muscleGroup: nm.toLowerCase() })} 
                  style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 9, cursor: "pointer", transition: "all 0.2s" }}
                  onMouseEnter={e => e.currentTarget.style.opacity = "0.8"}
                  onMouseLeave={e => e.currentTarget.style.opacity = "1"}>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.45)", width: 70, flexShrink: 0 }}>{nm}</div>
                  <div style={{ flex: 1, height: 6, background: "rgba(255,255,255,0.07)", borderRadius: 3, overflow: "hidden" }}>
                    <div style={{ height: "100%", width: `${mx ? (n/mx)*100 : 0}%`, background: "#ff6b6b", borderRadius: 3, transition: "width 0.7s" }} />
                  </div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12, color: "#ff6b6b", width: 16, textAlign: "right" }}>{n}</div>
                </div>
              ));
            })()}
          </div>

          {/* Exercise Progress Tracker */}
          <div className="card" style={{ marginTop: 10 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, marginBottom: 12, color: "#ff6b6b" }}>ðŸ† Exercise Progress</div>
            <div style={{ fontSize: 11, color: "rgba(255,255,255,0.35)", marginBottom: 10 }}>Track your lifts and view progression</div>
            {(() => {
              // Calculate best lifts from exerciseLogs
              const exerciseStats = {};
              Object.entries(exerciseLogs).forEach(([date, dayExercises]) => {
                Object.entries(dayExercises).forEach(([exId, sets]) => {
                  if (!sets || !sets.length) return;
                  sets.forEach(set => {
                    if (!exerciseStats[exId]) {
                      exerciseStats[exId] = { 
                        maxWeight: set.weight, 
                        maxVolume: set.weight * set.reps,
                        totalSets: 0,
                        lastDate: date
                      };
                    }
                    exerciseStats[exId].maxWeight = Math.max(exerciseStats[exId].maxWeight, set.weight);
                    exerciseStats[exId].maxVolume = Math.max(exerciseStats[exId].maxVolume, set.weight * set.reps);
                    exerciseStats[exId].totalSets++;
                    exerciseStats[exId].lastDate = date;
                  });
                });
              });
              
              if (Object.keys(exerciseStats).length === 0) {
                return (
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", textAlign: "center", padding: "20px 0", fontStyle: "italic" }}>
                    No exercises logged yet. Click "details" on your workout to start tracking!
                  </div>
                );
              }
              
              return Object.entries(exerciseStats).map(([exId, stats]) => {
                const exName = Object.values(exerciseLibrary).flat().find(e => e.id === exId)?.name || exId;
                return (
                  <div key={exId} 
                    onClick={() => setSelectedExercise(exId)}
                    style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 8, padding: "10px 12px", background: selectedExercise === exId ? "rgba(255,107,107,0.15)" : "rgba(255,107,107,0.05)", border: `1px solid ${selectedExercise === exId ? "rgba(255,107,107,0.4)" : "rgba(255,107,107,0.15)"}`, borderRadius: 10, cursor: "pointer", transition: "all 0.2s" }}>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 12, fontWeight: 700, color: "#fff", marginBottom: 2 }}>{exName}</div>
                      <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)" }}>
                        {stats.totalSets} total sets Â· Last: {new Date(stats.lastDate + "T12:00:00").toLocaleDateString("en-US", { month: "short", day: "numeric" })}
                      </div>
                    </div>
                    <div style={{ textAlign: "right" }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 16, color: "#ff6b6b" }}>
                        {stats.maxWeight} lbs
                      </div>
                      <div style={{ fontSize: 9, color: "rgba(255,107,107,0.5)", letterSpacing: "0.05em" }}>
                        MAX WEIGHT
                      </div>
                    </div>
                  </div>
                );
              });
            })()}
            
            {selectedExercise && (() => {
              const exName = Object.values(exerciseLibrary).flat().find(e => e.id === selectedExercise)?.name || selectedExercise;
              const history = [];
              Object.entries(exerciseLogs).forEach(([date, dayExercises]) => {
                if (dayExercises[selectedExercise]) {
                  dayExercises[selectedExercise].forEach(set => {
                    history.push({ date, ...set });
                  });
                }
              });
              history.sort((a, b) => a.date.localeCompare(b.date));
              
              return (
                <div style={{ marginTop: 12, padding: 12, background: "rgba(255,107,107,0.08)", border: "1px solid rgba(255,107,107,0.2)", borderRadius: 10 }}>
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 10 }}>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12, color: "#ff6b6b" }}>{exName} Progress</div>
                    <button onClick={(e) => { e.stopPropagation(); setSelectedExercise(null); }} style={{ fontSize: 10, padding: "4px 8px", background: "rgba(255,255,255,0.1)", border: "none", borderRadius: 6, color: "rgba(255,255,255,0.5)", cursor: "pointer" }}>Close</button>
                  </div>
                  <div style={{ maxHeight: 200, overflowY: "auto" }}>
                    {history.slice(-15).reverse().map((set, idx) => (
                      <div key={idx} style={{ display: "flex", justifyContent: "space-between", fontSize: 11, color: "rgba(255,255,255,0.6)", padding: "4px 0", borderBottom: idx < history.slice(-15).length - 1 ? "1px solid rgba(255,255,255,0.05)" : "none" }}>
                        <span>{new Date(set.date + "T12:00:00").toLocaleDateString("en-US", { month: "short", day: "numeric" })}</span>
                        <span style={{ color: "#ff6b6b", fontWeight: 600 }}>{set.weight} lbs Ã— {set.reps} reps</span>
                      </div>
                    ))}
                  </div>
                </div>
              );
            })()}
          </div>

          <div className="card">
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 12 }}>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13 }}>ðŸŽ¯ 2026 Goals</div>
              <button type="button" onClick={(e) => {
                e.stopPropagation();
                const goal = prompt("Enter new 2026 goal:");
                if (goal && goal.trim()) {
                  const updated = [...customGoals, goal.trim()];
                  setCustomGoals(updated);
                  saveData("custom_goals_v1", updated);
                }
              }} style={{ fontSize: 11, padding: "4px 10px", background: "rgba(52,211,153,0.15)", border: "1px solid rgba(52,211,153,0.3)", borderRadius: 6, color: "#34d399", cursor: "pointer", fontWeight: 600 }}>+ Add Goal</button>
            </div>
            {(() => {
              const monthsPassed = new Date().getMonth() + 1;
              const daysPassed = Math.floor((new Date() - new Date('2026-01-01')) / (1000 * 60 * 60 * 24));
              const meditationDays = Object.values(logs).filter(d => d.meditation).length;
              const retainerDays = Object.values(logs).filter(d => d.retainer).length;
              const dentalDays = Object.values(logs).filter(d => d.dental).length;
              
              const defaultGoals = [
                { g: "Work out more consistently ðŸ‹ï¸", done: workoutDays >= daysPassed * 0.7 },
                { g: "Journal daily ðŸ““", done: journalStreak >= 10 },
                { g: "Read every day ðŸ“–", done: totalPagesRead >= daysPassed * 15 },
                { g: "Meditate more ðŸ§˜", done: meditationDays >= daysPassed * 0.5 },
                { g: "Wear retainer consistently ðŸ˜", done: retainerDays >= daysPassed * 0.8 },
                { g: "Dental routine daily ðŸ¦·", done: dentalDays >= daysPassed * 0.85 },
                { g: "Track finances monthly ðŸ’°", done: financeDays >= monthsPassed },
                { g: "Max Roth IRA contribution ðŸ“ˆ", done: false },
                { g: "T-shirt printing side hustle ðŸ‘•", done: false },
                { g: "Bluetooth speaker app ðŸ“±", done: false },
                { g: "5AM Club morning routine â°", done: workoutDays >= 20 && journalDays >= 20 },
                { g: "Jiu Jitsu / Boxing / Shooting ðŸ¥‹", done: false },
                { g: "Take Udemy/Masterclass courses ðŸŽ“", done: false },
                { g: "Plan great vacations âœˆï¸", done: false },
              ];
              
              const allGoals = [...defaultGoals, ...customGoals.map(g => ({ g, done: false, custom: true }))];
              
              return allGoals.map(({ g, done, custom }) => (
                <div key={g} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 8 }}>
                  <div style={{ width: 18, height: 18, borderRadius: "50%", background: done ? "#34d399" : "rgba(255,255,255,0.07)", border: `2px solid ${done ? "#34d399" : "rgba(255,255,255,0.12)"}`, flexShrink: 0, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000" }}>{done ? "âœ“" : ""}</div>
                  <div style={{ fontSize: 12, color: done ? "#fff" : "rgba(255,255,255,0.45)", flex: 1 }}>{g}</div>
                  {custom && (
                    <button onClick={() => {
                      const updated = customGoals.filter(goal => goal !== g);
                      setCustomGoals(updated);
                      saveData("custom_goals_v1", updated);
                    }} style={{ fontSize: 14, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 4, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                  )}
                </div>
              ));
            })()}
          </div>
        </div>
      )}

      {/* â”€â”€ STATS DRILL-DOWN MODAL â”€â”€ */}
      {statsDrillDown && (
        <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.9)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 9999, padding: 20 }} onClick={() => setStatsDrillDown(null)}>
          <div onClick={e => e.stopPropagation()} style={{ background: "#0a0a12", border: `2px solid ${statsDrillDown.color}40`, borderRadius: 16, padding: 20, maxWidth: 400, width: "100%", maxHeight: "80vh", overflow: "auto" }}>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }}>
              <div>
                <div style={{ fontSize: 24, marginBottom: 4 }}>{statsDrillDown.icon}</div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: statsDrillDown.color }}>{statsDrillDown.label}</div>
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>{statsDrillDown.value} total in 2026</div>
              </div>
              <button onClick={() => setStatsDrillDown(null)} style={{ fontSize: 18, padding: "6px 12px", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.15)", borderRadius: 8, color: "#fff", cursor: "pointer" }}>Ã—</button>
            </div>
            
            <div style={{ fontSize: 10, fontWeight: 700, color: "rgba(255,255,255,0.3)", marginBottom: 10, letterSpacing: "0.08em" }}>COMPLETED DATES</div>
            {(() => {
              let filteredLogs;
              if (statsDrillDown.muscleGroup) {
                // Muscle group drill-down
                filteredLogs = Object.entries(logs).filter(([_, log]) => {
                  const w = (log.workoutDetails || "").toLowerCase();
                  return w.includes(statsDrillDown.muscleGroup);
                });
              } else if (statsDrillDown.key === "bookPages") {
                filteredLogs = Object.entries(logs).filter(([_, log]) => (log.bookPages || log.reading || 0) > 0);
              } else {
                filteredLogs = Object.entries(logs).filter(([_, log]) => log[statsDrillDown.key]);
              }
              
              return filteredLogs.sort(([a], [b]) => b.localeCompare(a)).map(([date, log]) => (
                <div key={date} style={{ background: `${statsDrillDown.color}08`, border: `1px solid ${statsDrillDown.color}20`, borderRadius: 10, padding: "10px 12px", marginBottom: 8 }}>
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 4 }}>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, color: statsDrillDown.color }}>{formatDate(date)}</div>
                    {statsDrillDown.key === "bookPages" && (
                      <div style={{ fontSize: 11, color: statsDrillDown.color, fontWeight: 600 }}>{log.bookPages || log.reading} pages</div>
                    )}
                  </div>
                  {statsDrillDown.key === "workout" && log.workoutDetails && (
                    <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)", lineHeight: 1.5, marginTop: 4, paddingTop: 6, borderTop: "1px solid rgba(255,255,255,0.06)" }}>
                      <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)", fontWeight: 700, marginBottom: 3 }}>WORKOUT DETAILS</div>
                      {log.workoutDetails}
                    </div>
                  )}
                  {log.notes && (
                    <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)", lineHeight: 1.5, marginTop: 4, paddingTop: 6, borderTop: "1px solid rgba(255,255,255,0.06)" }}>
                      <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)", fontWeight: 700, marginBottom: 3 }}>NOTES</div>
                      {log.notes}
                    </div>
                  )}
                  {log.mood && (
                    <div style={{ fontSize: 10, color: "rgba(255,255,255,0.35)", marginTop: 4 }}>Mood: {log.mood}/10</div>
                  )}
                </div>
              ));
            })()}
            
            {/* LINE CHART */}
            <div style={{ marginTop: 20, padding: 16, background: "rgba(255,255,255,0.02)", borderRadius: 12 }}>
              <div style={{ fontSize: 10, fontWeight: 700, color: "rgba(255,255,255,0.4)", marginBottom: 12, letterSpacing: "0.08em" }}>30-DAY PROGRESS CHART</div>
              <canvas id="statsChart" style={{ maxHeight: 200 }}></canvas>
            </div>
          </div>
        </div>
      )}

      {/* â”€â”€ MEAL TRACKING MODAL â”€â”€ */}
      {showMealModal && (
        <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.85)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 9999, padding: 20 }} onClick={() => setShowMealModal(false)}>
          <div onClick={e => e.stopPropagation()} style={{ background: "#0a0a12", border: "2px solid rgba(52,211,153,0.3)", borderRadius: 16, padding: 20, maxWidth: 400, width: "100%", maxHeight: "80vh", overflow: "auto" }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 16, marginBottom: 16, color: "#34d399" }}>Log Meals</div>
            
            {/* Schedule Meals Toggle */}
            <div style={{ marginBottom: 14, padding: "10px", background: "rgba(201,162,39,0.08)", borderRadius: 10 }}>
              <label style={{ display: "flex", alignItems: "center", gap: 8, cursor: "pointer" }}>
                <input type="checkbox" id="schedule-meals" defaultChecked={false} style={{ cursor: "pointer" }} />
                <span style={{ fontSize: 12, color: "#c9a227" }}>Schedule for future date</span>
              </label>
              <input type="date" id="meal-schedule-date" style={{ width: "100%", marginTop: 6, fontSize: 12 }} />
            </div>

            {["breakfast", "lunch", "dinner", "snacks"].map(meal => {
              const existing = (today.meals || {})[meal];
              return (
                <div key={meal} style={{ marginBottom: 14, background: "rgba(52,211,153,0.05)", padding: 12, borderRadius: 10 }}>
                  <div style={{ fontSize: 11, color: "#34d399", fontWeight: 700, marginBottom: 6, letterSpacing: "0.06em" }}>{meal.toUpperCase()}</div>
                  <input id={`meal-${meal}-desc`} placeholder="What did you eat?" defaultValue={existing?.description || ""} style={{ width: "100%", marginBottom: 6, fontSize: 13 }} />
                  <input id={`meal-${meal}-cal`} type="number" placeholder="Calories" defaultValue={existing?.calories || ""} style={{ width: "100%", fontSize: 13 }} />
                </div>
              );
            })}
            <div style={{ display: "flex", gap: 8, marginTop: 16 }}>
              <button onClick={() => {
                const meals = {};
                ["breakfast", "lunch", "dinner", "snacks"].forEach(m => {
                  const desc = document.getElementById(`meal-${m}-desc`).value;
                  const cal = parseInt(document.getElementById(`meal-${m}-cal`).value) || 0;
                  if (desc || cal) meals[m] = { description: desc, calories: cal };
                });
                
                const scheduleEnabled = document.getElementById("schedule-meals").checked;
                const scheduleDate = document.getElementById("meal-schedule-date").value;
                const targetDate = scheduleEnabled && scheduleDate ? scheduleDate : todayStr();
                
                updateLog(targetDate, "meals", meals);
                
                // Auto-sync with evening ritual if it's today
                if (targetDate === todayStr() && Object.keys(meals).length > 0) {
                  const dinnerKey = todayStr() + "_dinner";
                  setScheduleChecks(prev => {
                    const updated = { ...prev, [dinnerKey]: true };
                    saveData("hb_sched_v1", updated);
                    return updated;
                  });
                }
                
                setShowMealModal(false);
              }} className="primary" style={{ flex: 1 }}>Save Meals</button>
              <button onClick={() => setShowMealModal(false)} className="ghost" style={{ flex: 1 }}>Cancel</button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* â”€â”€ CALENDAR VIEW â”€â”€ */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {view === "cal" && (
        <div style={{ padding: "14px 18px" }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
            <button className="ghost" onClick={() => setCalMonth(m => m.month === 0 ? {year:m.year-1,month:11} : {year:m.year,month:m.month-1})}>â€¹</button>
            <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 15 }}>
              {new Date(calMonth.year, calMonth.month).toLocaleString("en-US", { month: "long", year: "numeric" })}
            </div>
            <button className="ghost" onClick={() => setCalMonth(m => m.month === 11 ? {year:m.year+1,month:0} : {year:m.year,month:m.month+1})}>â€º</button>
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(7, 1fr)", gap: 2, marginBottom: 6 }}>
            {["Su","Mo","Tu","We","Th","Fr","Sa"].map(d => <div key={d} style={{ textAlign: "center", fontSize: 10, color: "rgba(255,255,255,0.25)", padding: "4px 0", fontFamily: "'Syne', sans-serif", fontWeight: 700 }}>{d}</div>)}
          </div>
          {(() => {
            const { first, days } = getCalendarDays(calMonth.year, calMonth.month);
            const cells = [...Array(first).fill(null), ...Array.from({length:days},(_,i)=>i+1)];
            return (
              <div style={{ display: "grid", gridTemplateColumns: "repeat(7, 1fr)", gap: 4 }}>
                {cells.map((d, i) => {
                  if (!d) return <div key={i} />;
                  const ds = `${calMonth.year}-${String(calMonth.month+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
                  const e = logs[ds] || {};
                  const isToday = ds === todayStr();
                  const isFuture = ds > todayStr();
                  const checks = [e.workout,e.journal,(e.water||0)>=6,(e.bookPages||e.reading||0)>0].filter(Boolean).length;
                  const dotColors = ["rgba(255,255,255,0.2)","#fbbf24","#c9a227","#34d399","#34d399"];
                  
                  // Collect completed habit/PT emojis for this day
                  const completedEmojis = [];
                  if (!isFuture && e) {
                    editableHabits.forEach(h => { if (e[h.key]) completedEmojis.push(h.icon); });
                    editablePT.forEach(pt => { if (e[pt.key]) completedEmojis.push(pt.icon); });
                    customHabits.forEach(h => { if (e[h.key]) completedEmojis.push(h.icon); });
                    customPT.forEach(pt => { if (e[pt.key]) completedEmojis.push(pt.icon); });
                  }
                  
                  return (
                    <div key={i} onClick={() => { if(!isFuture){setSelectedDate(ds);setView("journal_day");} }}
                      style={{ aspectRatio:"1", borderRadius:10, display:"flex", flexDirection:"column", alignItems:"center", justifyContent:"center", background: isToday ? "rgba(201,162,39,0.1)" : checks>0&&!isFuture ? "rgba(255,255,255,0.035)" : "transparent", border: isToday ? "1.5px solid rgba(201,162,39,0.35)" : "1px solid transparent", cursor: isFuture?"default":"pointer", opacity: isFuture?0.25:1, transition:"all 0.15s", position:"relative" }}>
                      <div style={{ fontFamily:"'Syne',sans-serif", fontWeight: isToday?800:500, fontSize:13, color: isToday?"#c9a227":"#fff" }}>{d}</div>
                      {checks>0&&!isFuture && <div style={{ width:5,height:5,borderRadius:"50%",background:dotColors[checks],marginTop:2 }} />}
                      {e.workout&&!isFuture && <div style={{ position:"absolute",top:2,right:3,fontSize:7 }}>ðŸ’ª</div>}
                      {e.meals&&Object.keys(e.meals).length>0&&!isFuture && <div style={{ position:"absolute",top:2,left:3,fontSize:7 }}>ðŸ½ï¸</div>}
                      {completedEmojis.length > 0 && (
                        <div style={{ position: "absolute", bottom: 2, left: 0, right: 0, display: "flex", flexWrap: "wrap", justifyContent: "center", gap: 1, fontSize: 8, lineHeight: 1 }}>
                          {completedEmojis.slice(0, 6).map((emoji, idx) => (
                            <span key={idx}>{emoji}</span>
                          ))}
                          {completedEmojis.length > 6 && <span style={{ color: "#c9a227", fontWeight: 700 }}>+{completedEmojis.length - 6}</span>}
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>
            );
          })()}
          <div style={{ display:"flex",gap:10,marginTop:14,flexWrap:"wrap" }}>
            {[["ðŸŸ¡","Entry logged"],["ðŸ’ª","Workout"],["ðŸŸ¢","All habits"]].map(([icon,label]) => (
              <div key={label} style={{ display:"flex",alignItems:"center",gap:5 }}>
                <span style={{ fontSize:11 }}>{icon}</span>
                <span style={{ fontSize:10,color:"rgba(255,255,255,0.35)" }}>{label}</span>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* â”€â”€ JOURNAL LOGBOOK â”€â”€ */}
      {view === "journal" && (
        <div style={{ padding: "14px 18px" }}>
          <div style={{ fontFamily:"'Syne',sans-serif",fontSize:10,fontWeight:700,letterSpacing:"0.12em",color:"rgba(255,255,255,0.25)",marginBottom:12 }}>ALL ENTRIES Â· 2026</div>
          {Object.keys(logs).filter(d => d <= todayStr()).sort().reverse().map(date => {
            const e = logs[date];
            const isExp = expandedLog === date;
            const chips = [e.workout&&"ðŸ’ª",e.journal&&"ðŸ““",e.meditation&&"ðŸ§˜",(e.water||0)>=6&&"ðŸ’§",(e.bookPages||e.reading||0)>0&&"ðŸ“–"].filter(Boolean);
            return (
              <div key={date} className="loge" onClick={() => setExpandedLog(isExp ? null : date)}>
                <div style={{ display:"flex",justifyContent:"space-between",alignItems:"flex-start" }}>
                  <div>
                    <div style={{ fontFamily:"'Syne',sans-serif",fontWeight:700,fontSize:13,marginBottom:4 }}>{formatDate(date)}</div>
                    <div style={{ display:"flex",gap:4 }}>{chips.map((c,i)=><span key={i} style={{ fontSize:13 }}>{c}</span>)}</div>
                  </div>
                  <div style={{ display:"flex",gap:8,alignItems:"center" }}>
                    {e.mood && <div style={{ fontFamily:"'Syne',sans-serif",fontSize:12,color:"#c9a227" }}>{e.mood}/10</div>}
                    <div style={{ color:"rgba(255,255,255,0.25)",fontSize:12 }}>{isExp?"â–²":"â–¼"}</div>
                  </div>
                </div>
                {isExp && (
                  <div style={{ marginTop:10 }}>
                    {e.affirmation && <div style={{ fontSize:12,fontStyle:"italic",color:"rgba(201,162,39,0.7)",marginBottom:5 }}>"{e.affirmation}"</div>}
                    {e.mitzvah && <div style={{ fontSize:12,color:"rgba(52,211,153,0.7)",marginBottom:4 }}>ðŸ™ {e.mitzvah}</div>}
                    {e.workWin && <div style={{ fontSize:12,color:"rgba(96,165,250,0.7)",marginBottom:4 }}>ðŸ’¼ {e.workWin.slice(0,100)}{e.workWin.length>100?"â€¦":""}</div>}
                    {e.workoutDetails && <div style={{ fontSize:11,color:"rgba(255,107,107,0.6)",marginBottom:4 }}>ðŸ‹ï¸ {e.workoutDetails.slice(0,100)}{e.workoutDetails.length>100?"â€¦":""}</div>}
                    {e.notes && <div style={{ fontSize:12,color:"rgba(255,255,255,0.35)",lineHeight:1.5 }}>{e.notes.slice(0,120)}{e.notes.length>120?"â€¦":""}</div>}
                    <button className="ghost" style={{ marginTop:10,fontSize:11,padding:"6px 14px" }}
                      onClick={ev=>{ ev.stopPropagation(); setSelectedDate(date); setView("journal_day"); setEditing(false); }}>
                      View Full Entry â†’
                    </button>
                  </div>
                )}
              </div>
            );
          })}
        </div>
      )}

      {/* â”€â”€ INDIVIDUAL DAY LOG â”€â”€ */}
      {view === "journal_day" && (
        <div style={{ padding: "14px 18px" }}>
          <div style={{ display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14 }}>
            <button className="ghost" onClick={() => { const d=new Date(selectedDate+"T12:00:00"); d.setDate(d.getDate()-1); setSelectedDate(d.toISOString().split("T")[0]); setEditing(false); }}>â€¹ Prev</button>
            <div style={{ fontFamily:"'Syne',sans-serif",fontWeight:700,fontSize:13 }}>{formatDate(selectedDate)}</div>
            <button className="ghost" onClick={() => { const d=new Date(selectedDate+"T12:00:00"); d.setDate(d.getDate()+1); const nd=d.toISOString().split("T")[0]; if(nd<=todayStr()){setSelectedDate(nd);setEditing(false);} }}>Next â€º</button>
          </div>
          {editing && editData ? (
            <div>
              <div style={{ fontFamily:"'Syne',sans-serif",fontSize:11,fontWeight:700,color:"#c9a227",marginBottom:12,letterSpacing:"0.08em" }}>âœï¸ EDITING {formatDate(selectedDate)}</div>
              
              {/* Personal Habits */}
              <div style={{ fontSize:10,color:"rgba(255,255,255,0.25)",fontWeight:700,letterSpacing:"0.08em",marginBottom:8,marginTop:12 }}>PERSONAL HABITS</div>
              {HABITS.map(h => (
                <div key={h.key} style={{ display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,padding:"10px 14px",background:"rgba(255,255,255,0.035)",borderRadius:12 }}>
                  <span style={{ fontSize:13 }}>{h.icon} {h.label}</span>
                  <input type="checkbox" checked={!!editData[h.key]} onChange={e => setEditData(d=>({...d,[h.key]:e.target.checked}))} style={{ width:18,height:18,cursor:"pointer",accentColor:"#c9a227" }} />
                </div>
              ))}
              
              {/* PT / Superlatives */}
              <div style={{ fontSize:10,color:"rgba(255,255,255,0.25)",fontWeight:700,letterSpacing:"0.08em",marginBottom:8,marginTop:12 }}>SUPERLATIVES / PT</div>
              {[
                { key: "pt_jaw", label: "Jaw Exercise", icon: "ðŸ’ª" },
                { key: "pt_nose", label: "Nose Breathing Device", icon: "ðŸ‘ƒ" },
                { key: "pt_cardioMask", label: "Cardio Mask", icon: "ðŸ˜·" },
                { key: "pt_whitening", label: "Teeth Whitening Strips", icon: "âœ¨" },
                { key: "pt_neck", label: "Neck Strengthening", icon: "ðŸ¦’" },
                { key: "pt_balance", label: "Balance / Bosu Ball", icon: "âš–ï¸" },
                { key: "pt_grip", label: "Grip Training", icon: "âœŠ" },
              ].map(pt => (
                <div key={pt.key} style={{ display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,padding:"10px 14px",background:"rgba(255,255,255,0.035)",borderRadius:12 }}>
                  <span style={{ fontSize:13 }}>{pt.icon} {pt.label}</span>
                  <input type="checkbox" checked={!!editData[pt.key]} onChange={e => setEditData(d=>({...d,[pt.key]:e.target.checked}))} style={{ width:18,height:18,cursor:"pointer",accentColor:"#c9a227" }} />
                </div>
              ))}
              
              {/* Numbers */}
              <div style={{ fontSize:10,color:"rgba(255,255,255,0.25)",fontWeight:700,letterSpacing:"0.08em",marginBottom:8,marginTop:12 }}>TRACKERS</div>
              {[{key:"waterOz",label:"ðŸ’§ Water (ounces)"},{key:"bookPages",label:"ðŸ“– Pages Read"},{key:"mood",label:"ðŸ˜Š Mood (1-10)"}].map(f => (
                <div key={f.key} style={{ marginBottom:8 }}>
                  <div style={{ fontSize:11,color:"rgba(255,255,255,0.4)",marginBottom:4 }}>{f.label}</div>
                  <input type="number" value={editData[f.key]||""} onChange={e => setEditData(d=>({...d,[f.key]:Number(e.target.value)}))} />
                </div>
              ))}
              
              {/* Gratitude */}
              <div style={{ marginBottom:8 }}>
                <div style={{ fontSize:11,color:"rgba(255,255,255,0.4)",marginBottom:4 }}>Grateful For (3 items)</div>
                {[0,1,2].map(i => (
                  <input key={i} placeholder={`${i+1}. I'm grateful forâ€¦`} value={(editData.gratitude||[])[i]||""} 
                    onChange={e => { const g=[...(editData.gratitude||["","",""])]; g[i]=e.target.value; setEditData(d=>({...d,gratitude:g})); }} 
                    style={{ marginBottom: 5 }} />
                ))}
              </div>
              
              {/* Text fields */}
              {[{key:"affirmation",label:"Affirmation",rows:2},{key:"mitzvah",label:"One Mitzvah",rows:2},{key:"workWin",label:"Work Win",rows:2},{key:"workoutDetails",label:"Workout Details",rows:3},{key:"notes",label:"Notes",rows:3}].map(f => (
                <div key={f.key} style={{ marginBottom:8 }}>
                  <div style={{ fontSize:11,color:"rgba(255,255,255,0.4)",marginBottom:4 }}>{f.label}</div>
                  <textarea rows={f.rows} value={editData[f.key]||""} onChange={e => setEditData(d=>({...d,[f.key]:e.target.value}))} />
                </div>
              ))}
              <div style={{ display:"flex",gap:8,marginTop:14 }}>
                <button className="primary" style={{ flex:1 }} onClick={saveEdit}>Save Entry</button>
                <button className="ghost" style={{ flex:1 }} onClick={() => { setEditing(false); setEditData(null); }}>Cancel</button>
              </div>
            </div>
          ) : (
            <div>
              <div style={{ display:"flex",flexWrap:"wrap",gap:6,marginBottom:14 }}>
                {HABITS.map(h => sel[h.key] ? (
                  <div key={h.key} className="chip" style={{ background:`${h.color}18`,color:h.color,border:`1px solid ${h.color}33` }}>{h.icon} {h.label}</div>
                ) : null)}
                {(sel.water||0)>0 && <div className="chip" style={{ background:"rgba(56,189,248,0.12)",color:"#38bdf8",border:"1px solid rgba(56,189,248,0.25)" }}>ðŸ’§ {sel.water}</div>}
                {(sel.bookPages||sel.reading||0)>0 && <div className="chip" style={{ background:"rgba(192,132,252,0.12)",color:"#c084fc",border:"1px solid rgba(192,132,252,0.25)" }}>ðŸ“– {sel.bookPages||sel.reading}pg</div>}
                {sel.mood && <div className="chip" style={{ background:"rgba(201,162,39,0.12)",color:"#c9a227",border:"1px solid rgba(201,162,39,0.25)" }}>ðŸ˜Š {sel.mood}/10</div>}
              </div>
              {sel.affirmation && <div style={{ borderLeft:"3px solid #c9a227",background:"rgba(201,162,39,0.04)",borderRadius:"0 12px 12px 0",padding:"12px 14px",marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(201,162,39,0.7)",fontWeight:700,letterSpacing:"0.1em",marginBottom:5 }}>AFFIRMATION</div><div style={{ fontSize:13,fontStyle:"italic",lineHeight:1.7 }}>"{sel.affirmation}"</div></div>}
              {sel.gratitude?.filter(g=>g).length>0 && <div className="card" style={{ marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(52,211,153,0.7)",fontWeight:700,letterSpacing:"0.1em",marginBottom:8 }}>GRATEFUL FOR</div>{sel.gratitude.filter(g=>g).map((g,i)=><div key={i} style={{ fontSize:13,color:"rgba(255,255,255,0.7)",marginBottom:4 }}>{i+1}. {g}</div>)}</div>}
              {sel.mitzvah && <div style={{ borderLeft:"3px solid #34d399",background:"rgba(52,211,153,0.04)",borderRadius:"0 12px 12px 0",padding:"12px 14px",marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(52,211,153,0.7)",fontWeight:700,letterSpacing:"0.1em",marginBottom:5 }}>ONE MITZVAH</div><div style={{ fontSize:13,lineHeight:1.7 }}>{sel.mitzvah}</div></div>}
              {sel.workWin && <div style={{ borderLeft:"3px solid #60a5fa",background:"rgba(96,165,250,0.04)",borderRadius:"0 12px 12px 0",padding:"12px 14px",marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(96,165,250,0.7)",fontWeight:700,letterSpacing:"0.1em",marginBottom:5 }}>WORK WIN</div><div style={{ fontSize:13,lineHeight:1.7 }}>{sel.workWin}</div></div>}
              {sel.workoutDetails && <div style={{ borderLeft:"3px solid #ff6b6b",background:"rgba(255,107,107,0.04)",borderRadius:"0 12px 12px 0",padding:"12px 14px",marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(255,107,107,0.7)",fontWeight:700,letterSpacing:"0.1em",marginBottom:5 }}>WORKOUT</div><div style={{ fontSize:12,lineHeight:1.9,color:"rgba(255,255,255,0.7)" }}>{sel.workoutDetails}</div></div>}
              {sel.notes && <div className="card" style={{ marginBottom:10 }}><div style={{ fontSize:10,color:"rgba(255,255,255,0.3)",fontWeight:700,letterSpacing:"0.1em",marginBottom:6 }}>NOTES</div><div style={{ fontSize:13,lineHeight:1.7,color:"rgba(255,255,255,0.55)" }}>{sel.notes}</div></div>}
              {!sel.notes && !sel.workWin && !sel.mitzvah && !sel.affirmation && !sel.workoutDetails && <div style={{ textAlign:"center",padding:"28px 0",color:"rgba(255,255,255,0.2)",fontSize:13 }}>No entry yet.<br/>Tap below to add one.</div>}
              <button className="primary" style={{ marginTop:8 }} onClick={() => { setEditData({...(logs[selectedDate]||{})}); setEditing(true); }}>âœï¸ Edit Entry</button>
            </div>
          )}
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* â”€â”€ LIFE OS TAB â”€â”€ */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {view === "lifeos" && (
        <LifeOS 
          tasks={lifeOSTasks}
          setTasks={setLifeOSTasks}
          ventureFocus={ventureFocus}
          toggleVentureFocus={toggleVentureFocus}
          updateVentureData={updateVentureData}
          financialData={financialData}
          setFinancialData={setFinancialData}
          updateFinancialData={updateFinancialData}
          customExpenses={customExpenses}
          setCustomExpenses={setCustomExpenses}
        />
      )}

      {/* â”€â”€ BOTTOM NAV â”€â”€ */}
      <div style={{ position:"fixed",bottom:0,left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:430,background:"rgba(8,8,16,0.97)",backdropFilter:"blur(20px)",borderTop:"1px solid rgba(255,255,255,0.07)",display:"flex",padding:"8px 2px 18px",zIndex:100 }}>
        {[
          { id:"today", icon:"ðŸ ", label:"Today" },
          { id:"schedule", icon:"âš¡", label:"5AM" },
          { id:"lifeos", icon:"ðŸŒ", label:"Life OS" },
          { id:"cal", icon:"ðŸ“…", label:"Calendar" },
          { id:"stats", icon:"ðŸ“Š", label:"Stats" },
        ].map(tab => (
          <button key={tab.id} className="nav-btn" onClick={() => setView(tab.id)}
            style={{ color: (view===tab.id || (view==="journal_day" && tab.id==="cal")) ? "#c9a227" : "rgba(255,255,255,0.3)" }}>
            <div style={{ fontSize:16,lineHeight:1 }}>{tab.icon}</div>
            <div style={{ fontFamily:"'Syne',sans-serif",fontSize:9,fontWeight:700,letterSpacing:"0.03em",marginTop:2 }}>{tab.label}</div>
          </button>
        ))}
      </div>
      {/* â”€â”€ EDIT HABIT/PT MODAL â”€â”€ */}
      {editHabitModal && (
        <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.9)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 9999, padding: 20 }} onClick={() => setEditHabitModal(null)}>
          <div onClick={e => e.stopPropagation()} style={{ background: "#0a0a12", border: "2px solid #c9a227", borderRadius: 16, padding: 24, maxWidth: 400, width: "100%" }}>
            <div style={{ fontSize: 18, fontWeight: 700, marginBottom: 16, color: "#c9a227" }}>Edit {editHabitModal.type === 'habit' ? 'Habit' : editHabitModal.type === 'pt' ? 'PT Item' : editHabitModal.type === 'customHabit' ? 'Custom Habit' : 'Custom PT'}</div>
            
            <div style={{ marginBottom: 12 }}>
              <label style={{ fontSize: 12, color: "rgba(255,255,255,0.6)", marginBottom: 4, display: "block" }}>Name</label>
              <input type="text" defaultValue={editHabitModal.item.label} id="editLabel" style={{ width: "100%" }} />
            </div>
            
            <div style={{ marginBottom: 16 }}>
              <label style={{ fontSize: 12, color: "rgba(255,255,255,0.6)", marginBottom: 4, display: "block" }}>Emoji</label>
              <input type="text" defaultValue={editHabitModal.item.icon} id="editIcon" style={{ width: "100%" }} />
            </div>
            
            <div style={{ display: "flex", gap: 8 }}>
              <button onClick={() => setEditHabitModal(null)} style={{ flex: 1, padding: "10px", background: "rgba(255,255,255,0.1)", border: "1px solid rgba(255,255,255,0.2)", borderRadius: 8, color: "#fff", cursor: "pointer" }}>Cancel</button>
              <button onClick={() => {
                const newLabel = document.getElementById('editLabel').value;
                const newIcon = document.getElementById('editIcon').value;
                
                if (editHabitModal.type === 'habit') {
                  const updated = editableHabits.map(h => 
                    h.key === editHabitModal.item.key ? { ...h, label: newLabel, icon: newIcon } : h
                  );
                  setEditableHabits(updated);
                  saveData("editable_habits_v1", updated);
                } else if (editHabitModal.type === 'pt') {
                  const updated = editablePT.map(pt => 
                    pt.key === editHabitModal.item.key ? { ...pt, label: newLabel, icon: newIcon } : pt
                  );
                  setEditablePT(updated);
                  saveData("editable_pt_v1", updated);
                } else if (editHabitModal.type === 'customHabit') {
                  const updated = customHabits.map(h => 
                    h.key === editHabitModal.item.key ? { ...h, label: newLabel, icon: newIcon } : h
                  );
                  setCustomHabits(updated);
                  saveData("custom_habits_v1", updated);
                } else if (editHabitModal.type === 'customPT') {
                  const updated = customPT.map(pt => 
                    pt.key === editHabitModal.item.key ? { ...pt, label: newLabel, icon: newIcon } : pt
                  );
                  setCustomPT(updated);
                  saveData("custom_pt_v1", updated);
                }
                setEditHabitModal(null);
              }} style={{ flex: 1, padding: "10px", background: "#c9a227", border: "none", borderRadius: 8, color: "#000", cursor: "pointer", fontWeight: 700 }}>Save</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

// â”€â”€â”€ LIFE OS COMPONENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function LifeOS({ tasks: externalTasks, setTasks: setExternalTasks, ventureFocus, toggleVentureFocus, updateVentureData, financialData, setFinancialData, updateFinancialData, customExpenses, setCustomExpenses }) {
  const [section, setSection] = useState("mindset");
  const [tasks, setTasks] = useState(externalTasks || {});
  const [loaded, setLoaded] = useState(false);
  const [expandedCat, setExpandedCat] = useState(null);
  const [newTaskText, setNewTaskText] = useState({});
  const [showDatePicker, setShowDatePicker] = useState(null);
  const [customCategories, setCustomCategories] = useState([]);
  const [showCategoryModal, setShowCategoryModal] = useState(false);
  const [editingCategory, setEditingCategory] = useState(null);
  const [customMilestones, setCustomMilestones] = useState({});

  useEffect(() => {
    (async () => {
      if (externalTasks) {
        setTasks(externalTasks);
      }
      const cats = await loadData("lifeos_categories_v1", []);
      setCustomCategories(cats);
      const milestones = await loadData("custom_milestones_v1", {});
      setCustomMilestones(milestones);
      setLoaded(true);
    })();
  }, [externalTasks]);

  const toggleTask = useCallback((id) => {
    const newTasks = {
      ...tasks,
      [id]: { ...tasks[id], done: !tasks[id]?.done, doneDate: !tasks[id]?.done ? new Date().toISOString().split("T")[0] : null }
    };
    setTasks(newTasks);
    setExternalTasks(newTasks);
    saveData("lifeos_tasks_v1", newTasks);
  }, [tasks, setExternalTasks]);

  const scheduleTask = useCallback((id, date, label) => {
    const existingTask = tasks[id] || {};
    const newTasks = { 
      ...tasks, 
      [id]: { 
        ...existingTask, 
        scheduledDate: date, 
        label: label || existingTask.label || "Task" 
      } 
    };
    setTasks(newTasks);
    setExternalTasks(newTasks);
    saveData("lifeos_tasks_v1", newTasks);
    setShowDatePicker(null);
  }, [tasks, setExternalTasks]);

  const addTask = useCallback((catId, text) => {
    if (!text.trim()) return;
    const id = catId + "_custom_" + Date.now();
    const newTasks = { ...tasks, [id]: { done: false, custom: true, text, cat: catId } };
    setTasks(newTasks);
    setExternalTasks(newTasks);
    saveData("lifeos_tasks_v1", newTasks);
    setNewTaskText(p => ({ ...p, [catId]: "" }));
  }, [tasks, setExternalTasks]);

  // â”€â”€ DATA â”€â”€
  const MINDSET = [
    { icon: "ðŸ“ˆ", text: "Get Better Everyday" },
    { icon: "ðŸŽ¯", text: "Re-center" },
    { icon: "ðŸ“‹", text: "Plan, Plan, Plan" },
    { icon: "ðŸŒ¸", text: "Live a beautiful life" },
    { icon: "ðŸŒŠ", text: "Abundant success" },
    { icon: "ðŸ”¥", text: "Determination to get there" },
    { icon: "ðŸ”", text: "Attention to detail" },
    { icon: "ðŸ”ï¸", text: "A Goal" },
    { icon: "ðŸ—ºï¸", text: "An actionable plan" },
    { icon: "âš”ï¸", text: "Strategy & tactics to get there" },
    { icon: "ðŸ§­", text: "Remember where we started" },
    { icon: "ðŸ™", text: "Fortunately grateful" },
  ];

  const AFFIRMATIONS = [
    "I am grateful. I am forgiving. I am giving. My life is beautiful, creative, productive, prosperous and magical.",
    "There is a tsunami of success I am excited to receive!",
    "It's a NEW DAY FULL OF OPPORTUNITY. I'll continue growing, advancing my career, and I'll be BEYOND SUCCESSFUL!",
    "I know what I'm doing, I have a solid plan, and this will work if I own it.",
    "I believe in the law of attraction, manifestation, and creating from a higher vibration.",
    "Get comfortable being uncomfortable.",
    "On the tough days I'll use it as inspiration.",
    "This day and year marks an evolution in my being. I am tuned in.",
    "Strong leadership is a force multiplier.",
    "Give me more levels!",
  ];

  const LIFE_AREAS = [
    {
      id: "personal", label: "Personal", icon: "â¤ï¸", color: "#ff6b6b",
      items: [
        { id: "fam", label: "Family time scheduled", cadence: "weekly" },
        { id: "friends", label: "Connect with friends", cadence: "weekly" },
        { id: "spiritual", label: "Religion / Spiritual practice", cadence: "daily" },
        { id: "hobbies", label: "Hobbies time (UFC, basketball, Rocket League)", cadence: "weekly" },
        { id: "volunteer", label: "Volunteering / giving back", cadence: "monthly" },
        { id: "vacation", label: "Vacation planned", cadence: "quarterly" },
      ]
    },
    {
      id: "recurring", label: "Recurring Tasks", icon: "ðŸ”„", color: "#38bdf8",
      items: [
        { id: "mail", label: "Go through mail", cadence: "biweekly" },
        { id: "fin_transactions", label: "Review transactions (Monarch Money)", cadence: "weekly" },
        { id: "fin_spend", label: "Spend/save breakdown", cadence: "weekly" },
        { id: "fin_quarterly", label: "Full finance review", cadence: "quarterly" },
        { id: "utilities", label: "Check utilities", cadence: "monthly" },
        { id: "reno_excel", label: "Update home renovation Excel", cadence: "quarterly" },
        { id: "meal_meals", label: "Meal prep â€” meals", cadence: "weekly" },
        { id: "meal_shots", label: "Wellness shots prep", cadence: "weekly" },
        { id: "exercise", label: "Exercise schedule on track", cadence: "daily" },
        { id: "sleep", label: "10pm lights out / 7hrs sleep", cadence: "daily" },
        { id: "diet", label: "Eating clean & meal prepped", cadence: "weekly" },
        { id: "laundry", label: "Laundry", cadence: "weekly" },
        { id: "clean_house", label: "Clean the house", cadence: "weekly" },
        { id: "lawn", label: "Lawn care", cadence: "weekly (summer)" },
        { id: "gutters", label: "Clean gutters / spring yard", cadence: "annual" },
        { id: "furnace", label: "Replace furnace filter", cadence: "quarterly" },
        { id: "ac_maint", label: "A/C yearly maintenance", cadence: "annual" },
        { id: "home_warranty", label: "Review home warranty", cadence: "annual" },
      ]
    },
    {
      id: "personal_care", label: "Personal Care", icon: "ðŸ’…", color: "#c084fc",
      items: [
        { id: "care_nails", label: "Nails (trim/clean)", cadence: "weekly" },
        { id: "care_hair", label: "Haircut", cadence: "monthly" },
        { id: "care_beard", label: "Beard trim", cadence: "weekly" },
        { id: "care_dentist", label: "Dentist checkup", cadence: "6 months" },
        { id: "care_vision", label: "Eye exam", cadence: "annual" },
        { id: "care_ears", label: "Ear cleaning", cadence: "quarterly" },
        { id: "care_physical", label: "Annual physical", cadence: "annual" },
      ]
    },
    {
      id: "spring_clean", label: "Spring Cleaning", icon: "ðŸŒ±", color: "#34d399",
      items: [
        { id: "xmas_tree", label: "Sell old Christmas tree" },
        { id: "old_faucet", label: "Get rid of old faucet" },
        { id: "basement_workout", label: "Organize basement â€” workout equipment" },
        { id: "basement_utility", label: "Organize basement â€” utility storage" },
        { id: "basement_tools", label: "Organize basement â€” tools" },
        { id: "spring_general", label: "General spring clean sweep" },
      ]
    },
  ];

  // Merge default categories with custom ones
  const allCategories = [...LIFE_AREAS, ...customCategories];

  const HOME_RENO = [
    { id: "door_plates", label: "Door plates", priority: "medium" },
    { id: "snow_blower", label: "Fix snow blower", priority: "high" },
    { id: "kitchen_blinds", label: "Kitchen blinds", priority: "medium" },
    { id: "sunroom_blinds", label: "Sunroom door blinds", priority: "medium" },
    { id: "kitchen_floor", label: "Kitchen floor", priority: "high" },
    { id: "entryway_floor", label: "Entryway floor", priority: "high" },
    { id: "back_patio", label: "Back patio", priority: "medium" },
    { id: "garden", label: "Garden", priority: "low" },
    { id: "kitchen_faucet", label: "Kitchen faucet", priority: "high" },
    { id: "bathroom_fan", label: "Bathroom fan", priority: "medium" },
    { id: "heat_wires", label: "Heat wires â€” roof drainage", priority: "high" },
    { id: "insulation", label: "Upstairs insulation", priority: "medium" },
    { id: "sunroom_hvac", label: "Good heater/AC â€” sunroom", priority: "medium" },
    { id: "oven_splash", label: "Kitchen oven splashback", priority: "low" },
    { id: "dryer_vent", label: "Clean dryer vent", priority: "high" },
    { id: "downstairs_bath", label: "Downstairs bathroom â€” sand, paint, toilet & vanity", priority: "high" },
  ];

  const VENTURES = [
    {
      id: "nzv", label: "NZ Ventures", icon: "ðŸš€", color: "#c084fc",
      items: [
        { id: "udemy", label: "Udemy classes", cadence: "ongoing" },
        { id: "stocks_inv", label: "Stocks investing", cadence: "monthly" },
        { id: "crypto_inv", label: "Crypto investing (BTC/ETH)", cadence: "monthly" },
        { id: "re_inv", label: "Real estate investing", cadence: "quarterly" },
        { id: "biz_inv", label: "Other businesses investing", cadence: "quarterly" },
        { id: "nzv_taxes", label: "Taxes", cadence: "annual" },
        { id: "podcast", label: "Podcast: Hit After Hit", cadence: "ongoing" },
        { id: "retirement", label: "Retirement plan / financial planning", cadence: "quarterly" },
        { id: "trust", label: "Trust & financial structure", cadence: "annual" },
        { id: "re_research", label: "Real estate research", cadence: "monthly" },
      ]
    },
    {
      id: "eca", label: "Easy Custom Apparel", icon: "ðŸ‘•", color: "#fbbf24",
      items: [
        { id: "eca_obg", label: "OBG", cadence: "ongoing" },
        { id: "eca_taxes", label: "File taxes", cadence: "annual" },
        { id: "eca_1099", label: "Legal docs â€” 1099", cadence: "annual" },
        { id: "eca_resale", label: "Legal docs â€” Resale certificate", cadence: "annual" },
        { id: "eca_usp", label: "USP / marketing collateral (fast, low qty, inexpensive)", cadence: "project" },
      ]
    },
    {
      id: "grove", label: "Grove Bags", icon: "ðŸŒ¿", color: "#34d399",
      items: [
        { id: "gb_rocks", label: "Q1 Rocks on track", cadence: "quarterly" },
        { id: "gb_tableau", label: "Tableau dashboards updated", cadence: "weekly" },
        { id: "gb_east", label: "East Move the Needle call", cadence: "weekly" },
        { id: "gb_west", label: "West Move the Needle call", cadence: "weekly" },
        { id: "gb_pipeline", label: "Pipeline clean & current", cadence: "weekly" },
        { id: "gb_reviews", label: "Team performance reviews", cadence: "biannual" },
        { id: "gb_deposition", label: "Calyx deposition prep", cadence: "project" },
        { id: "gb_b2c", label: "'Store your weed here' B2C campaign", cadence: "project" },
      ]
    },
  ];

  const INVESTMENTS = [
    { label: "Roth IRA", target: "$7,000/yr", current: "On track", color: "#fbbf24", icon: "ðŸ“ˆ" },
    { label: "HSA", target: "$4,300/yr", current: "On track", color: "#34d399", icon: "ðŸ¥" },
    { label: "S&P 500", target: "$200/mo", current: "Active", color: "#60a5fa", icon: "ðŸ“Š" },
    { label: "BTC / ETH", target: "$200/mo", current: "Active", color: "#f97316", icon: "â‚¿" },
    { label: "Real Estate", target: "Research phase", current: "Pending", color: "#c084fc", icon: "ðŸ " },
    { label: "Businesses", target: "TBD", current: "Exploring", color: "#ff6b6b", icon: "ðŸ’¼" },
  ];

  if (!loaded) return null;

  const today = new Date().toISOString().split("T")[0];
  const todayAff = AFFIRMATIONS[new Date().getDay() % AFFIRMATIONS.length];

  // Count completions
  const countDone = (items) => items.filter(item => tasks[item.id]?.done).length;
  const totalReno = HOME_RENO.length;
  const donReno = HOME_RENO.filter(i => tasks[i.id]?.done).length;

  const stageColors = { idea: "#60a5fa", developing: "#fbbf24", researching: "#c084fc", active: "#34d399" };
  const stageLabels = { idea: "Idea", developing: "Developing", researching: "Researching", active: "Active" };

  const priorityColors = { high: "#ff6b6b", medium: "#fbbf24", low: "#34d399" };

  if (!loaded) {
    return (
      <div style={{ padding: "14px 18px", minHeight: "50vh", display: "flex", alignItems: "center", justifyContent: "center" }}>
        <div style={{ color: "#c9a227", fontFamily: "'Syne', sans-serif", fontSize: 14, letterSpacing: "0.1em" }}>Loading Life OS...</div>
      </div>
    );
  }

  return (
    <div style={{ padding: "14px 18px" }}>
      {/* Sub nav */}
      <div style={{ display: "flex", gap: 5, marginBottom: 16, overflowX: "auto", paddingBottom: 8, WebkitOverflowScrolling: "touch" }}>
        {[
          { id: "mindset", label: "Mindset", icon: "ðŸ§ " },
          { id: "life", label: "Life", icon: "â¤ï¸" },
          { id: "finance", label: "Finance", icon: "ðŸ’°" },
          { id: "ventures", label: "Ventures", icon: "ðŸš€" },
          { id: "ideas", label: "Ideas", icon: "ðŸ’¡" },
        ].map(t => (
          <button key={t.id} onClick={() => setSection(t.id)}
            style={{ background: section === t.id ? "rgba(201,162,39,0.15)" : "rgba(255,255,255,0.04)", border: `1px solid ${section === t.id ? "rgba(201,162,39,0.4)" : "rgba(255,255,255,0.08)"}`, color: section === t.id ? "#c9a227" : "rgba(255,255,255,0.45)", borderRadius: 10, padding: "7px 12px", fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 10, letterSpacing: "0.06em", cursor: "pointer", whiteSpace: "nowrap", transition: "all 0.2s", flexShrink: 0 }}>
            {t.icon} {t.label}
          </button>
        ))}
      </div>

      {/* â”€â”€ MINDSET â”€â”€ */}
      {section === "mindset" && (
        <div>
          {/* Daily affirmation */}
          <div style={{ background: "linear-gradient(135deg, rgba(201,162,39,0.12), rgba(201,162,39,0.03))", border: "1px solid rgba(201,162,39,0.25)", borderRadius: 16, padding: "16px", marginBottom: 16 }}>
            <div style={{ fontSize: 10, color: "#c9a227", fontFamily: "'Syne', sans-serif", fontWeight: 700, letterSpacing: "0.12em", marginBottom: 8 }}>TODAY'S AFFIRMATION</div>
            <div style={{ fontSize: 14, fontStyle: "italic", lineHeight: 1.7, color: "rgba(255,255,255,0.85)" }}>"{todayAff}"</div>
          </div>

          {/* Mindset pillars */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 12 }}>12 MINDSET PILLARS</div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8, marginBottom: 20 }}>
            {MINDSET.map((m, i) => (
              <div key={i} style={{ background: "rgba(255,255,255,0.035)", border: "1px solid rgba(255,255,255,0.07)", borderRadius: 12, padding: "12px 12px", display: "flex", gap: 8, alignItems: "center" }}>
                <span style={{ fontSize: 18 }}>{m.icon}</span>
                <span style={{ fontSize: 11, color: "rgba(255,255,255,0.75)", lineHeight: 1.3, fontWeight: 500 }}>{m.text}</span>
              </div>
            ))}
          </div>

          {/* All affirmations */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 12 }}>YOUR AFFIRMATION LIBRARY</div>
          {AFFIRMATIONS.map((a, i) => (
            <div key={i} style={{ background: "rgba(255,255,255,0.025)", border: "1px solid rgba(255,255,255,0.06)", borderRadius: 12, padding: "12px 14px", marginBottom: 8 }}>
              <div style={{ fontSize: 12, fontStyle: "italic", lineHeight: 1.6, color: "rgba(255,255,255,0.6)" }}>"{a}"</div>
            </div>
          ))}
          
          {/* Custom Quotes */}
          <div style={{ marginTop: 20 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 12 }}>CUSTOM INSPIRATION QUOTES</div>
            {(tasks.customQuotes || []).map((quote, i) => (
              <div key={i} style={{ background: "rgba(201,162,39,0.06)", border: "1px solid rgba(201,162,39,0.2)", borderRadius: 12, padding: "12px 14px", marginBottom: 8, display: "flex", justifyContent: "space-between", alignItems: "flex-start", gap: 10 }}>
                <div style={{ fontSize: 12, fontStyle: "italic", lineHeight: 1.6, color: "rgba(255,255,255,0.7)", flex: 1 }}>"{quote}"</div>
                <button onClick={() => {
                  const updated = (tasks.customQuotes || []).filter((_, idx) => idx !== i);
                  setTasks(prev => {
                    const u = { ...prev, customQuotes: updated };
                    saveData("lifeos_tasks_v1", u);
                    return u;
                  });
                }} style={{ fontSize: 14, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0 }}>Ã—</button>
              </div>
            ))}
            <div style={{ display: "flex", gap: 8 }}>
              <input id="new-quote-input" placeholder="Add inspiring quote..." style={{ flex: 1, fontSize: 13, padding: "10px 12px" }} 
                onKeyDown={e => {
                  if (e.key === "Enter" && e.target.value.trim()) {
                    const newQuotes = [...(tasks.customQuotes || []), e.target.value.trim()];
                    setTasks(prev => {
                      const u = { ...prev, customQuotes: newQuotes };
                      saveData("lifeos_tasks_v1", u);
                      return u;
                    });
                    e.target.value = "";
                  }
                }} />
              <button onClick={() => {
                const input = document.getElementById("new-quote-input");
                if (input.value.trim()) {
                  const newQuotes = [...(tasks.customQuotes || []), input.value.trim()];
                  setTasks(prev => {
                    const u = { ...prev, customQuotes: newQuotes };
                    saveData("lifeos_tasks_v1", u);
                    return u;
                  });
                  input.value = "";
                }
              }} style={{ background: "#c9a227", border: "none", borderRadius: 8, padding: "10px 16px", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: "#000", cursor: "pointer" }}>Add</button>
            </div>
          </div>

          {/* Life wheel */}
          <div style={{ marginTop: 20, fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 12 }}>LIFE BALANCE WHEEL</div>
          <div className="card">
            {[
              { label: "Health", icon: "ðŸ’ª", color: "#ff6b6b", val: 8 },
              { label: "Career", icon: "ðŸ’¼", color: "#60a5fa", val: 9 },
              { label: "Family", icon: "â¤ï¸", color: "#f97316", val: 8 },
              { label: "Finance", icon: "ðŸ’°", color: "#fbbf24", val: 7 },
              { label: "Spiritual", icon: "ðŸ™", color: "#34d399", val: 6 },
              { label: "Learning", icon: "ðŸ“–", color: "#c084fc", val: 7 },
              { label: "Social", icon: "ðŸ‘¥", color: "#38bdf8", val: 8 },
              { label: "Ventures", icon: "ðŸš€", color: "#c9a227", val: 5 },
            ].map(area => (
              <div key={area.label} style={{ display: "flex", alignItems: "center", gap: 10, marginBottom: 10 }}>
                <span style={{ fontSize: 14 }}>{area.icon}</span>
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.55)", width: 60 }}>{area.label}</div>
                <div style={{ flex: 1, height: 7, background: "rgba(255,255,255,0.07)", borderRadius: 4, overflow: "hidden" }}>
                  <div style={{ height: "100%", width: `${area.val * 10}%`, background: area.color, borderRadius: 4, transition: "width 0.8s cubic-bezier(.4,0,.2,1)" }} />
                </div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: area.color, width: 20, textAlign: "right" }}>{area.val}</div>
              </div>
            ))}
            <div style={{ fontSize: 10, color: "rgba(255,255,255,0.2)", marginTop: 6, textAlign: "center" }}>Self-assessed / tap Stats to update</div>
          </div>
        </div>
      )}

      {/* â”€â”€ LIFE AREAS â”€â”€ */}
      {section === "life" && (
        <div>
          {/* Grocery List */}
          <div style={{ marginBottom: 16 }}>
            <div style={{ background: "rgba(52,211,153,0.08)", border: "1px solid rgba(52,211,153,0.25)", borderRadius: 14, padding: 16 }}>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 14, marginBottom: 10, color: "#34d399" }}>ðŸ›’ Grocery List</div>
              <input placeholder="Add item... (press Enter)" onKeyDown={e => {
                if (e.key === "Enter" && e.target.value.trim()) {
                  const id = "grocery_" + Date.now();
                  const newTasks = { ...tasks, [id]: { text: e.target.value, cat: "groceries", type: "list", done: false } };
                  setTasks(newTasks);
                  setExternalTasks(newTasks);
                  saveData("lifeos_tasks_v1", newTasks);
                  e.target.value = "";
                }
              }} style={{ width: "100%", marginBottom: 10, fontSize: 13 }} />
              {Object.entries(tasks).filter(([_, t]) => t.cat === "groceries").map(([id, item]) => (
                <div key={id} style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 6, padding: "6px 8px", background: "rgba(255,255,255,0.03)", borderRadius: 8 }}>
                  <input type="checkbox" checked={item.done} onChange={() => toggleTask(id)} style={{ cursor: "pointer", accentColor: "#34d399" }} />
                  <span style={{ flex: 1, textDecoration: item.done ? "line-through" : "none", color: item.done ? "rgba(255,255,255,0.4)" : "#fff", fontSize: 13 }}>{item.text}</span>
                  <button onClick={() => {
                    const newTasks = { ...tasks };
                    delete newTasks[id];
                    setTasks(newTasks);
                    setExternalTasks(newTasks);
                    saveData("lifeos_tasks_v1", newTasks);
                  }} style={{ fontSize: 14, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                </div>
              ))}
              {Object.entries(tasks).filter(([_, t]) => t.cat === "groceries" && !t.done).length === 0 && (
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", textAlign: "center", marginTop: 8 }}>No items in list</div>
              )}
            </div>
          </div>

          {/* Add Category Button */}
          <button onClick={() => { setEditingCategory(null); setShowCategoryModal(true); }}
            style={{ width: "100%", padding: "12px", marginBottom: 12, background: "rgba(201,162,39,0.1)", border: "1px solid rgba(201,162,39,0.3)", borderRadius: 12, color: "#c9a227", fontSize: 12, fontWeight: 700, cursor: "pointer", fontFamily: "'Syne', sans-serif", letterSpacing: "0.06em" }}>
            + Add Custom Category
          </button>

          {allCategories.map(cat => {
            const done = countDone(cat.items);
            const isOpen = expandedCat === cat.id;
            const customItems = Object.entries(tasks).filter(([k, v]) => v.custom && v.cat === cat.id && !v.deleted);
            const allItems = [...cat.items, ...customItems.map(([k, v]) => ({ id: k, label: v.text }))];
            const totalDone = allItems.filter(item => tasks[item.id]?.done).length;
            const isCustomCat = cat.custom;

            return (
              <div key={cat.id} style={{ marginBottom: 10 }}>
                <div onClick={() => setExpandedCat(isOpen ? null : cat.id)}
                  style={{ background: `${cat.color}10`, border: `1px solid ${cat.color}25`, borderRadius: isOpen ? "14px 14px 0 0" : 14, padding: "13px 15px", cursor: "pointer", display: "flex", alignItems: "center", gap: 12 }}>
                  <span style={{ fontSize: 20 }}>{cat.icon}</span>
                  <div style={{ flex: 1 }}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: cat.color }}>{cat.label}</div>
                      <div style={{ display: "flex", alignItems: "center", gap: 6 }}>
                        {isCustomCat && (
                          <>
                            <button onClick={e => { e.stopPropagation(); setEditingCategory(cat); setShowCategoryModal(true); }}
                              style={{ fontSize: 10, padding: "3px 8px", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.15)", borderRadius: 6, color: "rgba(255,255,255,0.5)", cursor: "pointer" }}>Edit</button>
                            <button onClick={e => { 
                              e.stopPropagation(); 
                              if (confirm(`Delete "${cat.label}" category? All tasks will be removed.`)) {
                                const updated = customCategories.filter(c => c.id !== cat.id);
                                setCustomCategories(updated);
                                saveData("lifeos_categories_v1", updated);
                              }
                            }} style={{ fontSize: 10, padding: "3px 8px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                          </>
                        )}
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 11, color: totalDone === allItems.length && allItems.length > 0 ? "#34d399" : cat.color }}>{totalDone}/{allItems.length}</div>
                      </div>
                    </div>
                    <div style={{ marginTop: 5, height: 3, background: "rgba(255,255,255,0.07)", borderRadius: 2, overflow: "hidden" }}>
                      <div style={{ height: "100%", width: `${allItems.length ? (totalDone / allItems.length) * 100 : 0}%`, background: cat.color, borderRadius: 2, transition: "width 0.6s" }} />
                    </div>
                  </div>
                  <div style={{ fontSize: 12, color: "rgba(255,255,255,0.3)" }}>{isOpen ? "â–²" : "â–¼"}</div>
                </div>

                {isOpen && (
                  <div style={{ background: "rgba(255,255,255,0.02)", border: `1px solid ${cat.color}18`, borderTop: "none", borderRadius: "0 0 14px 14px", padding: "6px 14px 12px" }}>
                    {allItems.sort((a, b) => {
                      const priorityOrder = { high: 0, medium: 1, low: 2 };
                      const aPriority = tasks[a.id]?.priority || "medium";
                      const bPriority = tasks[b.id]?.priority || "medium";
                      return priorityOrder[aPriority] - priorityOrder[bPriority];
                    }).map(item => {
                      const isDone = tasks[item.id]?.done;
                      const scheduled = tasks[item.id]?.scheduledDate;
                      return (
                        <div key={item.id} style={{ position: "relative" }}>
                          <div onClick={() => toggleTask(item.id)}
                            style={{ display: "flex", alignItems: "center", gap: 10, padding: "9px 0", borderBottom: "1px solid rgba(255,255,255,0.04)", cursor: "pointer", transition: "all 0.15s" }}>
                            <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${isDone ? cat.color : "rgba(255,255,255,0.18)"}`, background: isDone ? cat.color : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0, transition: "all 0.2s" }}>{isDone && "âœ“"}</div>
                            <div style={{ flex: 1 }}>
                              <div style={{ fontSize: 13, color: isDone ? "rgba(255,255,255,0.35)" : "#fff", textDecoration: isDone ? "line-through" : "none" }}>{item.label}</div>
                              {item.cadence && <div style={{ fontSize: 10, color: "rgba(255,255,255,0.25)", marginTop: 1 }}>{item.cadence}</div>}
                              {isDone && tasks[item.id]?.doneDate && <div style={{ fontSize: 10, color: `${cat.color}88`, marginTop: 1 }}>âœ“ {tasks[item.id].doneDate}</div>}
                            </div>
                            {/* Priority selector */}
                            <select value={tasks[item.id]?.priority || "medium"} 
                              onClick={e => e.stopPropagation()}
                              onChange={e => {
                                e.stopPropagation();
                                const newTasks = { ...tasks, [item.id]: { ...tasks[item.id], priority: e.target.value } };
                                setTasks(newTasks);
                                setExternalTasks(newTasks);
                                saveData("lifeos_tasks_v1", newTasks);
                              }}
                              style={{ fontSize: 10, padding: "3px 6px", borderRadius: 6, background: tasks[item.id]?.priority === "high" ? "rgba(255,107,107,0.2)" : tasks[item.id]?.priority === "low" ? "rgba(52,211,153,0.2)" : "rgba(251,191,36,0.2)", border: "1px solid rgba(255,255,255,0.1)", color: tasks[item.id]?.priority === "high" ? "#ff6b6b" : tasks[item.id]?.priority === "low" ? "#34d399" : "#fbbf24", cursor: "pointer", flexShrink: 0 }}>
                              <option value="high">High</option>
                              <option value="medium">Med</option>
                              <option value="low">Low</option>
                            </select>
                            <button onClick={e => { e.stopPropagation(); setShowDatePicker(showDatePicker === item.id ? null : item.id); }}
                              style={{ fontSize: 10, padding: "4px 8px", borderRadius: 8, background: scheduled ? "rgba(201,162,39,0.15)" : "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.1)", color: scheduled ? "#c9a227" : "rgba(255,255,255,0.4)", cursor: "pointer", flexShrink: 0 }}>
                              ðŸ“… {scheduled ? new Date(scheduled + "T12:00:00").toLocaleDateString("en-US", { month: "short", day: "numeric" }) : "Plan"}
                            </button>
                            {/* Delete button - all items */}
                            <button onClick={e => {
                              e.stopPropagation();
                              if (confirm(`Delete "${item.label}"?`)) {
                                const newTasks = { ...tasks };
                                delete newTasks[item.id];
                                setTasks(newTasks);
                                setExternalTasks(newTasks);
                                saveData("lifeos_tasks_v1", newTasks);
                              }
                            }} style={{ fontSize: 14, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer", flexShrink: 0 }}>Ã—</button>
                          </div>
                          {showDatePicker === item.id && (
                            <div style={{ position: "absolute", right: 0, top: "100%", zIndex: 1000, background: "#0a0a12", border: "1px solid rgba(201,162,39,0.3)", borderRadius: 12, padding: 12, marginTop: 4, boxShadow: "0 8px 24px rgba(0,0,0,0.5)" }}>
                              <input type="date" value={scheduled || ""} 
                                onChange={e => scheduleTask(item.id, e.target.value, item.label)}
                                style={{ fontSize: 12, padding: "6px" }} />
                              {scheduled && (
                                <button onClick={e => { e.stopPropagation(); scheduleTask(item.id, "", item.label); }} 
                                  style={{ marginLeft: 8, fontSize: 11, padding: "4px 8px", background: "rgba(255,107,107,0.2)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Clear</button>
                              )}
                            </div>
                          )}
                        </div>
                      );
                    })}
                    {/* Add custom task */}
                    <div style={{ display: "flex", gap: 8, marginTop: 10 }}>
                      <input placeholder="Add taskâ€¦" value={newTaskText[cat.id] || ""} onChange={e => setNewTaskText(p => ({ ...p, [cat.id]: e.target.value }))}
                        onKeyDown={e => e.key === "Enter" && addTask(cat.id, newTaskText[cat.id] || "")}
                        style={{ flex: 1, fontSize: 12, padding: "8px 10px" }} />
                      <button onClick={() => addTask(cat.id, newTaskText[cat.id] || "")}
                        style={{ background: cat.color, border: "none", borderRadius: 8, padding: "8px 12px", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: "#000", cursor: "pointer" }}>+</button>
                    </div>
                  </div>
                )}
              </div>
            );
          })}

          {/* Category Modal */}
          {showCategoryModal && (
            <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.8)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 9999, padding: 20 }} onClick={() => setShowCategoryModal(false)}>
              <div onClick={e => e.stopPropagation()} style={{ background: "#0a0a12", border: "2px solid rgba(201,162,39,0.3)", borderRadius: 16, padding: 20, maxWidth: 380, width: "100%" }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 16, marginBottom: 16, color: "#c9a227" }}>
                  {editingCategory ? "Edit Category" : "New Category"}
                </div>
                <div style={{ marginBottom: 12 }}>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginBottom: 4 }}>Name</div>
                  <input id="cat-name" type="text" defaultValue={editingCategory?.label || ""} placeholder="e.g., Health Goals" style={{ width: "100%", fontSize: 14, padding: "10px" }} />
                </div>
                <div style={{ marginBottom: 12 }}>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginBottom: 4 }}>Icon (emoji)</div>
                  <input id="cat-icon" type="text" defaultValue={editingCategory?.icon || ""} placeholder="e.g., ðŸ’ª" style={{ width: "100%", fontSize: 14, padding: "10px", textAlign: "center" }} />
                </div>
                <div style={{ marginBottom: 16 }}>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginBottom: 6 }}>Color</div>
                  <div style={{ display: "grid", gridTemplateColumns: "repeat(6, 1fr)", gap: 8 }}>
                    {["#ff6b6b", "#38bdf8", "#34d399", "#fbbf24", "#c084fc", "#f97316", "#60a5fa", "#10b981"].map(c => (
                      <div key={c} id={`color-${c}`} onClick={() => {
                        document.querySelectorAll('[id^="color-"]').forEach(el => el.style.border = "2px solid transparent");
                        document.getElementById(`color-${c}`).style.border = "2px solid #c9a227";
                      }} style={{ width: "100%", aspectRatio: "1", background: c, borderRadius: 8, cursor: "pointer", border: editingCategory?.color === c ? "2px solid #c9a227" : "2px solid transparent" }} />
                    ))}
                  </div>
                </div>
                <div style={{ display: "flex", gap: 8 }}>
                  <button onClick={() => {
                    const name = document.getElementById("cat-name").value.trim();
                    const icon = document.getElementById("cat-icon").value.trim();
                    const selectedColor = document.querySelector('[id^="color-"][style*="rgb(201, 162, 39)"]');
                    const color = selectedColor ? selectedColor.id.replace("color-", "") : "#38bdf8";
                    
                    if (!name || !icon) { alert("Please fill all fields"); return; }
                    
                    if (editingCategory) {
                      const updated = customCategories.map(c => c.id === editingCategory.id ? { ...c, label: name, icon, color } : c);
                      setCustomCategories(updated);
                      saveData("lifeos_categories_v1", updated);
                    } else {
                      const newCat = { id: "custom_" + Date.now(), label: name, icon, color, custom: true, items: [] };
                      const updated = [...customCategories, newCat];
                      setCustomCategories(updated);
                      saveData("lifeos_categories_v1", updated);
                    }
                    setShowCategoryModal(false);
                    setEditingCategory(null);
                  }} style={{ flex: 1, padding: "12px", background: "#c9a227", border: "none", borderRadius: 10, color: "#000", fontWeight: 700, cursor: "pointer" }}>
                    {editingCategory ? "Save Changes" : "Create Category"}
                  </button>
                  <button onClick={() => { setShowCategoryModal(false); setEditingCategory(null); }} style={{ flex: 1, padding: "12px", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.15)", borderRadius: 10, color: "#fff", cursor: "pointer" }}>
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          )}


          {/* Progress header */}
          <div onClick={() => setExpandedCat(expandedCat === "home_reno" ? null : "home_reno")}
            style={{ background: "rgba(201,162,39,0.08)", border: "1px solid rgba(201,162,39,0.2)", borderRadius: expandedCat === "home_reno" ? "14px 14px 0 0" : 14, padding: "14px 16px", marginBottom: expandedCat === "home_reno" ? 0 : 14, display: "flex", alignItems: "center", gap: 12, cursor: "pointer" }}>
            <div style={{ position: "relative", width: 52, height: 52, flexShrink: 0 }}>
              {(() => {
                const r = 22, circ = 2 * Math.PI * r, pct = donReno / totalReno;
                return (
                  <svg width="52" height="52" style={{ transform: "rotate(-90deg)", display: "block" }}>
                    <circle cx="26" cy="26" r={r} fill="none" stroke="rgba(255,255,255,0.06)" strokeWidth="5" />
                    <circle cx="26" cy="26" r={r} fill="none" stroke="#c9a227" strokeWidth="5" strokeDasharray={`${pct * circ} ${circ}`} strokeLinecap="round" style={{ transition: "stroke-dasharray 0.6s" }} />
                  </svg>
                );
              })()}
              <div style={{ position: "absolute", inset: 0, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: "#c9a227" }}>{donReno}/{totalReno}</div>
            </div>
            <div style={{ flex: 1 }}>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 16, color: "#c9a227" }}>ðŸ  Home Renovation</div>
              <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", marginTop: 2 }}>{totalReno - donReno} items remaining</div>
            </div>
          </div>

          {/* Filter by priority */}
          {expandedCat === "home_reno" && (
          <div style={{ background: "rgba(201,162,39,0.05)", border: "1px solid rgba(201,162,39,0.2)", borderTop: "none", borderRadius: "0 0 14px 14px", padding: "14px 16px", marginBottom: 14 }}>
          {["high", "medium", "low"].map(pri => {
            const items = HOME_RENO.filter(i => i.priority === pri);
            const donePri = items.filter(i => tasks[i.id]?.done).length;
            return (
              <div key={pri} style={{ marginBottom: 14 }}>
                <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 8 }}>
                  <div style={{ width: 8, height: 8, borderRadius: "50%", background: priorityColors[pri] }} />
                  <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, color: priorityColors[pri], letterSpacing: "0.1em", textTransform: "uppercase" }}>{pri} priority Â· {donePri}/{items.length}</div>
                </div>
                {items.sort((a, b) => {
                  const priorityOrder = { high: 0, medium: 1, low: 2 };
                  const aPriority = tasks[a.id]?.priority || a.priority;
                  const bPriority = tasks[b.id]?.priority || b.priority;
                  return priorityOrder[aPriority] - priorityOrder[bPriority];
                }).map(item => {
                  const isDone = tasks[item.id]?.done;
                  const scheduled = tasks[item.id]?.scheduledDate;
                  return (
                    <div key={item.id} style={{ position: "relative" }}>
                      <div onClick={() => toggleTask(item.id)}
                        style={{ display: "flex", alignItems: "center", gap: 10, padding: "11px 14px", background: isDone ? "rgba(255,255,255,0.02)" : `${priorityColors[item.priority]}08`, border: `1px solid ${isDone ? "rgba(255,255,255,0.06)" : priorityColors[item.priority] + "20"}`, borderRadius: 11, marginBottom: 6, cursor: "pointer", transition: "all 0.2s" }}>
                        <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${isDone ? "#34d399" : priorityColors[item.priority]}`, background: isDone ? "#34d399" : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0, transition: "all 0.2s" }}>{isDone && "âœ“"}</div>
                        <div style={{ flex: 1 }}>
                          <div style={{ fontSize: 13, color: isDone ? "rgba(255,255,255,0.3)" : "#fff", textDecoration: isDone ? "line-through" : "none" }}>{item.label}</div>
                          {isDone && tasks[item.id]?.doneDate && <div style={{ fontSize: 10, color: "#34d39988", marginTop: 1 }}>âœ“ {tasks[item.id].doneDate}</div>}
                        </div>
                        <button onClick={e => { e.stopPropagation(); setShowDatePicker(showDatePicker === item.id ? null : item.id); }}
                          style={{ fontSize: 10, padding: "4px 8px", borderRadius: 8, background: scheduled ? "rgba(201,162,39,0.15)" : "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.1)", color: scheduled ? "#c9a227" : "rgba(255,255,255,0.4)", cursor: "pointer", flexShrink: 0 }}>
                          ðŸ“… {scheduled ? new Date(scheduled + "T12:00:00").toLocaleDateString("en-US", { month: "short", day: "numeric" }) : "Plan"}
                        </button>
                        <select value={tasks[item.id]?.priority || item.priority} 
                          onClick={e => e.stopPropagation()}
                          onChange={e => {
                            e.stopPropagation();
                            const newTasks = { ...tasks, [item.id]: { ...tasks[item.id], priority: e.target.value } };
                            setTasks(newTasks);
                            setExternalTasks(newTasks);
                            saveData("lifeos_tasks_v1", newTasks);
                          }}
                          style={{ fontSize: 9, padding: "3px 6px", borderRadius: 6, background: (tasks[item.id]?.priority || item.priority) === "high" ? "rgba(255,107,107,0.2)" : (tasks[item.id]?.priority || item.priority) === "low" ? "rgba(52,211,153,0.2)" : "rgba(251,191,36,0.2)", border: "1px solid rgba(255,255,255,0.1)", color: (tasks[item.id]?.priority || item.priority) === "high" ? "#ff6b6b" : (tasks[item.id]?.priority || item.priority) === "low" ? "#34d399" : "#fbbf24", cursor: "pointer", flexShrink: 0, fontFamily: "'Syne', sans-serif", fontWeight: 700 }}>
                          <option value="high">HIGH</option>
                          <option value="medium">MED</option>
                          <option value="low">LOW</option>
                        </select>
                      </div>
                      {showDatePicker === item.id && (
                        <div style={{ position: "absolute", right: 0, top: "100%", zIndex: 1000, background: "#0a0a12", border: "1px solid rgba(201,162,39,0.3)", borderRadius: 12, padding: 12, marginTop: 4, boxShadow: "0 8px 24px rgba(0,0,0,0.5)" }}>
                          <input type="date" value={scheduled || ""} 
                            onChange={e => scheduleTask(item.id, e.target.value, item.label)}
                            style={{ fontSize: 12, padding: "6px" }} />
                          {scheduled && (
                            <button onClick={e => { e.stopPropagation(); scheduleTask(item.id, "", item.label); }} 
                              style={{ marginLeft: 8, fontSize: 11, padding: "4px 8px", background: "rgba(255,107,107,0.2)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Clear</button>
                          )}
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>
            );
          })}

          {/* Add custom reno item */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.1em", color: "rgba(255,255,255,0.25)", marginBottom: 8, marginTop: 4 }}>ADD ITEM</div>
          <div style={{ display: "flex", gap: 8 }}>
            <input placeholder="New renovation itemâ€¦" value={newTaskText["reno"] || ""} onChange={e => setNewTaskText(p => ({ ...p, reno: e.target.value }))}
              onKeyDown={e => { if (e.key === "Enter" && (newTaskText["reno"] || "").trim()) { const id = "reno_custom_" + Date.now(); setTasks(prev => { const u = { ...prev, [id]: { done: false, custom: true, text: newTaskText["reno"], cat: "reno" } }; saveData("lifeos_tasks_v1", u); return u; }); setNewTaskText(p => ({ ...p, reno: "" })); }}}
              style={{ flex: 1, fontSize: 12 }} />
            <button onClick={() => { if ((newTaskText["reno"] || "").trim()) { const id = "reno_custom_" + Date.now(); setTasks(prev => { const u = { ...prev, [id]: { done: false, custom: true, text: newTaskText["reno"], cat: "reno" } }; saveData("lifeos_tasks_v1", u); return u; }); setNewTaskText(p => ({ ...p, reno: "" })); }}}
              style={{ background: "#c9a227", border: "none", borderRadius: 8, padding: "8px 14px", fontFamily: "'Syne', sans-serif", fontWeight: 800, color: "#000", cursor: "pointer" }}>+</button>
          </div>
          {/* Custom reno items */}
          {Object.entries(tasks).filter(([k, v]) => v.custom && v.cat === "reno" && !v.deleted).map(([k, v]) => (
            <div key={k} onClick={() => toggleTask(k)} style={{ display: "flex", alignItems: "center", gap: 10, padding: "11px 14px", background: "rgba(255,255,255,0.025)", border: "1px solid rgba(255,255,255,0.07)", borderRadius: 11, marginTop: 6, cursor: "pointer" }}>
              <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${tasks[k]?.done ? "#34d399" : "rgba(255,255,255,0.2)"}`, background: tasks[k]?.done ? "#34d399" : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0 }}>{tasks[k]?.done && "âœ“"}</div>
              <div style={{ fontSize: 13, color: tasks[k]?.done ? "rgba(255,255,255,0.3)" : "#fff", textDecoration: tasks[k]?.done ? "line-through" : "none" }}>{v.text}</div>
            </div>
          ))}
          </div>
          )}
        </div>
      )}

      {/* â”€â”€ FINANCE â”€â”€ */}
      {section === "finance" && (
        <div>
          {/* Financial Milestones */}
          <div style={{ marginTop: 24 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 13, fontWeight: 700, marginBottom: 14, color: "#c9a227" }}>ðŸ’° Financial Milestones</div>
            {[
              { stage: 1, label: "Stability", items: ["$1-2k emergency fund", "6mo living expenses saved", "Eliminate high-interest debt", "Basic insurance coverage"], color: "#ff6b6b" },
              { stage: 2, label: "Foundation", items: ["720+ credit score", "Capture 401k match", "Automate Roth IRA", "Save 15-25% of income"], color: "#fbbf24" },
              { stage: 3, label: "Growth", items: ["$25k invested", "$50-100k invested", "Increase earning power"], color: "#34d399" },
              { stage: 4, label: "Opportunity", items: ["Diversified buckets", "Opportunity fund", "$250k liquid (accredited)"], color: "#c084fc" },
              { stage: 5, label: "Independence", items: ["Investments = 1Ã— annual income", "Investments = 3-5Ã— annual income", "Clear FI target"], color: "#60a5fa" },
              { stage: 6, label: "Architecture", items: ["Tax efficiency planning", "Estate basics", "Asset protection", "Lifestyle funded by investments"], color: "#c9a227" },
            ].map(stage => {
              const stageKey = `stage_${stage.stage}`;
              const customItems = customMilestones[stageKey] || [];
              const allItems = [...stage.items, ...customItems];
              
              return (
                <div key={stage.stage} style={{ background: `${stage.color}08`, border: `1px solid ${stage.color}25`, borderRadius: 12, padding: 12, marginBottom: 10 }}>
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 8 }}>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 12, color: stage.color }}>
                      Stage {stage.stage}: {stage.label}
                    </div>
                    <button onClick={() => {
                      const newItem = prompt(`Add milestone to Stage ${stage.stage}:`);
                      if (newItem && newItem.trim()) {
                        const updated = { ...customMilestones, [stageKey]: [...(customMilestones[stageKey] || []), newItem.trim()] };
                        setCustomMilestones(updated);
                        saveData("custom_milestones_v1", updated);
                      }
                    }} style={{ fontSize: 11, padding: "3px 8px", background: `${stage.color}20`, border: `1px solid ${stage.color}`, borderRadius: 6, color: stage.color, cursor: "pointer", fontWeight: 600 }}>+ Add</button>
                  </div>
                  {allItems.map((item, i) => {
                    const key = `milestone_${stage.stage}_${i}`;
                    const isDone = tasks[key]?.done;
                    const isSkipped = tasks[key]?.skipped;
                    const isCustom = i >= stage.items.length;
                    
                    return (
                      <div key={i} style={{ display: "flex", alignItems: "center", gap: 6, marginBottom: 5, padding: "4px 0", opacity: isSkipped ? 0.4 : 1 }}>
                        <div onClick={() => !isSkipped && toggleTask(key)} style={{ width: 16, height: 16, borderRadius: "50%", border: `2px solid ${stage.color}`, background: isDone ? stage.color : "transparent", flexShrink: 0, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 9, color: "#000", cursor: "pointer" }}>{isDone && "âœ“"}</div>
                        <div style={{ fontSize: 11, color: isDone ? "rgba(255,255,255,0.5)" : "rgba(255,255,255,0.75)", textDecoration: isDone ? "line-through" : "none", flex: 1 }}>{item}</div>
                        {isCustom && (
                          <button onClick={() => {
                            if (confirm(`Delete "${item}"?`)) {
                              const updated = { ...customMilestones, [stageKey]: customMilestones[stageKey].filter((_, idx) => idx !== (i - stage.items.length)) };
                              setCustomMilestones(updated);
                              saveData("custom_milestones_v1", updated);
                            }
                          }} style={{ fontSize: 12, padding: "2px 5px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 4, color: "#ff6b6b", cursor: "pointer" }}>Ã—</button>
                        )}
                        <button onClick={() => {
                          const newTasks = { ...tasks, [key]: { ...tasks[key], skipped: !isSkipped } };
                          setTasks(newTasks);
                          setExternalTasks(newTasks);
                          saveData("lifeos_tasks_v1", newTasks);
                        }} style={{ fontSize: 9, padding: "3px 6px", background: isSkipped ? "rgba(255,255,255,0.15)" : "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.1)", borderRadius: 4, color: isSkipped ? "#c9a227" : "rgba(255,255,255,0.4)", cursor: "pointer" }}>
                          {isSkipped ? "Skipped" : "Skip"}
                        </button>
                      </div>
                    );
                  })}
                </div>
              );
            })}
          </div>

          {/* Investment Portfolio */}
          <div style={{ marginTop: 24 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10 }}>INVESTMENT PORTFOLIO</div>
            <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8, marginBottom: 16 }}>
              {INVESTMENTS.map(inv => (
                <div key={inv.label} style={{ background: `${inv.color}10`, border: `1px solid ${inv.color}25`, borderRadius: 12, padding: "12px 12px" }}>
                  <div style={{ fontSize: 18, marginBottom: 5 }}>{inv.icon}</div>
                  <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: inv.color }}>{inv.label}</div>
                  <div style={{ fontSize: 11, color: "rgba(255,255,255,0.5)", marginTop: 2 }}>{inv.target}</div>
                  <div style={{ fontSize: 10, color: inv.color, marginTop: 3, fontWeight: 600 }}>{inv.current}</div>
                </div>
              ))}
            </div>
          </div>

          {/* Net Worth Tracker */}
          <div style={{ marginTop: 24 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 13, fontWeight: 700, marginBottom: 14, color: "#c9a227" }}>ðŸ“Š Net Worth Tracker</div>
            
            {/* Assets */}
            <div style={{ marginBottom: 16 }}>
              <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", fontWeight: 700, marginBottom: 8, letterSpacing: "0.06em" }}>ASSETS</div>
              {["Roth IRA", "HSA", "401k", "Crypto", "Stocks", "Cash", "Real Estate"].map(asset => (
                <div key={asset} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 6, padding: "6px 10px", background: "rgba(255,255,255,0.02)", borderRadius: 8 }}>
                  <span style={{ fontSize: 12, color: "rgba(255,255,255,0.7)" }}>{asset}</span>
                  <input type="number" placeholder="$0" 
                    value={financialData.assets?.[asset] || ""} 
                    onChange={e => updateFinancialData("assets", asset, parseInt(e.target.value) || 0)}
                    style={{ width: 100, textAlign: "right", padding: "4px 8px", fontSize: 12, background: "rgba(255,255,255,0.05)" }} />
                </div>
              ))}
            </div>
            
            {/* Liabilities */}
            <div style={{ marginBottom: 16 }}>
              <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", fontWeight: 700, marginBottom: 8, letterSpacing: "0.06em" }}>LIABILITIES</div>
              {["Mortgage", "Student Loans", "Car Loan", "Credit Cards", "Other Debt"].map(liability => (
                <div key={liability} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 6, padding: "6px 10px", background: "rgba(255,255,255,0.02)", borderRadius: 8 }}>
                  <span style={{ fontSize: 12, color: "rgba(255,255,255,0.7)" }}>{liability}</span>
                  <input type="number" placeholder="$0" 
                    value={financialData.liabilities?.[liability] || ""} 
                    onChange={e => updateFinancialData("liabilities", liability, parseInt(e.target.value) || 0)}
                    style={{ width: 100, textAlign: "right", padding: "4px 8px", fontSize: 12, background: "rgba(255,255,255,0.05)" }} />
                </div>
              ))}
            </div>
            
            {/* Net Worth Display */}
            <div style={{ background: "rgba(201,162,39,0.1)", border: "2px solid rgba(201,162,39,0.3)", borderRadius: 12, padding: 16, marginBottom: 16 }}>
              <div>
                <div style={{ fontSize: 11, color: "rgba(201,162,39,0.7)", fontWeight: 700, letterSpacing: "0.08em", marginBottom: 4 }}>NET WORTH</div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 24, color: "#c9a227" }}>
                  ${(() => {
                    const totalAssets = Object.values(financialData.assets || {}).reduce((a, b) => a + b, 0);
                    const totalLiabilities = Object.values(financialData.liabilities || {}).reduce((a, b) => a + b, 0);
                    return (totalAssets - totalLiabilities).toLocaleString();
                  })()}
                </div>
              </div>
            </div>

            {/* Monthly Cash Flow */}
            <div style={{ marginBottom: 16 }}>
              <div style={{ fontSize: 11, color: "rgba(255,255,255,0.4)", fontWeight: 700, marginBottom: 8, letterSpacing: "0.06em" }}>MONTHLY CASH FLOW</div>
              <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10 }}>
                <div style={{ padding: "10px 12px", background: "rgba(52,211,153,0.08)", border: "1px solid rgba(52,211,153,0.2)", borderRadius: 10 }}>
                  <div style={{ fontSize: 10, color: "#34d399", fontWeight: 700, marginBottom: 4 }}>INCOME</div>
                  <input type="number" placeholder="$0" 
                    value={financialData.monthlyIncome || ""} 
                    onChange={e => {
                      setFinancialData(prev => {
                        const updated = { ...prev, monthlyIncome: parseInt(e.target.value) || 0 };
                        saveData("financial_data_v1", updated);
                        return updated;
                      });
                    }}
                    style={{ width: "100%", textAlign: "center", fontSize: 16, fontWeight: 700, background: "rgba(255,255,255,0.05)" }} />
                </div>
                <div style={{ padding: "10px 12px", background: "rgba(255,107,107,0.08)", border: "1px solid rgba(255,107,107,0.2)", borderRadius: 10 }}>
                  <div style={{ fontSize: 10, color: "#ff6b6b", fontWeight: 700, marginBottom: 4 }}>SPEND</div>
                  <input type="number" placeholder="$0" 
                    value={financialData.monthlySpend || ""} 
                    onChange={e => {
                      setFinancialData(prev => {
                        const updated = { ...prev, monthlySpend: parseInt(e.target.value) || 0 };
                        saveData("financial_data_v1", updated);
                        return updated;
                      });
                    }}
                    style={{ width: "100%", textAlign: "center", fontSize: 16, fontWeight: 700, background: "rgba(255,255,255,0.05)" }} />
                </div>
              </div>
              <div style={{ marginTop: 8, padding: "8px 12px", background: ((financialData.monthlyIncome || 0) - (financialData.monthlySpend || 0)) > 0 ? "rgba(52,211,153,0.08)" : "rgba(255,107,107,0.08)", borderRadius: 8 }}>
                <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginBottom: 2 }}>Net Monthly</div>
                <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: ((financialData.monthlyIncome || 0) - (financialData.monthlySpend || 0)) > 0 ? "#34d399" : "#ff6b6b" }}>
                  ${((financialData.monthlyIncome || 0) - (financialData.monthlySpend || 0)).toLocaleString()}
                </div>
              </div>
            </div>
          </div>

          {/* Custom Monthly Expenses */}
          <div style={{ marginTop: 24 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 13, fontWeight: 700, marginBottom: 14, color: "#c9a227" }}>ðŸ’³ Custom Monthly Expenses</div>
            <div style={{ background: "rgba(201,162,39,0.05)", border: "1px solid rgba(201,162,39,0.2)", borderRadius: 12, padding: 14 }}>
              {/* Add expense input */}
              <div style={{ display: "flex", gap: 8, marginBottom: 12 }}>
                <input 
                  id="expense-category"
                  placeholder="Category (e.g., Rent, Groceries)" 
                  style={{ flex: 2, fontSize: 12, padding: "8px 12px", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.15)", borderRadius: 8, color: "#fff" }} 
                />
                <input 
                  id="expense-amount"
                  type="number"
                  placeholder="$0" 
                  style={{ flex: 1, fontSize: 12, padding: "8px 12px", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.15)", borderRadius: 8, color: "#fff", textAlign: "center" }} 
                />
                <button onClick={() => {
                  const category = document.getElementById('expense-category').value.trim();
                  const amount = parseInt(document.getElementById('expense-amount').value) || 0;
                  if (category && amount > 0) {
                    const newExpense = { id: Date.now().toString(), category, amount };
                    const updated = [...customExpenses, newExpense];
                    setCustomExpenses(updated);
                    saveData("custom_expenses_v1", updated);
                    document.getElementById('expense-category').value = '';
                    document.getElementById('expense-amount').value = '';
                  }
                }} style={{ padding: "8px 14px", background: "#c9a227", border: "none", borderRadius: 8, color: "#000", fontWeight: 700, cursor: "pointer", fontFamily: "'Syne', sans-serif" }}>
                  + Add
                </button>
              </div>

              {/* Expense list */}
              {customExpenses.length > 0 ? (
                <>
                  {customExpenses.map(expense => (
                    <div key={expense.id} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", padding: "8px 12px", background: "rgba(255,255,255,0.03)", border: "1px solid rgba(255,255,255,0.08)", borderRadius: 8, marginBottom: 6 }}>
                      <div style={{ fontSize: 12, color: "rgba(255,255,255,0.75)" }}>{expense.category}</div>
                      <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13, color: "#c9a227" }}>
                          ${expense.amount.toLocaleString()}
                        </div>
                        <button onClick={() => {
                          if (confirm(`Delete ${expense.category}?`)) {
                            const updated = customExpenses.filter(e => e.id !== expense.id);
                            setCustomExpenses(updated);
                            saveData("custom_expenses_v1", updated);
                          }
                        }} style={{ fontSize: 14, padding: "2px 6px", background: "rgba(255,107,107,0.15)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>
                          Ã—
                        </button>
                      </div>
                    </div>
                  ))}
                  
                  {/* Total */}
                  <div style={{ marginTop: 12, paddingTop: 12, borderTop: "1px solid rgba(255,255,255,0.1)", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, fontWeight: 700, color: "rgba(255,255,255,0.5)", letterSpacing: "0.05em" }}>TOTAL MONTHLY EXPENSES</div>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, color: "#c9a227" }}>
                      ${customExpenses.reduce((sum, e) => sum + e.amount, 0).toLocaleString()}
                    </div>
                  </div>
                </>
              ) : (
                <div style={{ fontSize: 11, color: "rgba(255,255,255,0.3)", textAlign: "center", padding: "16px 0" }}>
                  No expenses added yet. Add your monthly expenses to track your budget.
                </div>
              )}
            </div>
          </div>
        </div>
      )}

      {section === "ventures" && (
        <div>
          {/* Venture areas */}
          {VENTURES.map(vent => {
            const done = countDone(vent.items);
            const isOpen = expandedCat === vent.id;
            return (
              <div key={vent.id} style={{ marginBottom: 10 }}>
                <div onClick={() => setExpandedCat(isOpen ? null : vent.id)}
                  style={{ background: `${vent.color}10`, border: `1px solid ${vent.color}25`, borderRadius: isOpen ? "14px 14px 0 0" : 14, padding: "13px 15px", cursor: "pointer", display: "flex", alignItems: "center", gap: 12 }}>
                  <span style={{ fontSize: 20 }}>{vent.icon}</span>
                  <div style={{ flex: 1 }}>
                    <div style={{ display: "flex", justifyContent: "space-between" }}>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 13, color: vent.color }}>{vent.label}</div>
                      <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 11, color: vent.color }}>{done}/{vent.items.length}</div>
                    </div>
                    <div style={{ marginTop: 5, height: 3, background: "rgba(255,255,255,0.07)", borderRadius: 2, overflow: "hidden" }}>
                      <div style={{ height: "100%", width: `${vent.items.length ? (done / vent.items.length) * 100 : 0}%`, background: vent.color, borderRadius: 2, transition: "width 0.6s" }} />
                    </div>
                  </div>
                  <div style={{ fontSize: 12, color: "rgba(255,255,255,0.3)" }}>{isOpen ? "â–²" : "â–¼"}</div>
                </div>
                {isOpen && (
                  <div style={{ background: "rgba(255,255,255,0.02)", border: `1px solid ${vent.color}15`, borderTop: "none", borderRadius: "0 0 14px 14px", padding: "6px 14px 12px" }}>
                    {vent.items.map(item => {
                      const isDone = tasks[item.id]?.done;
                      const scheduled = tasks[item.id]?.scheduledDate;
                      return (
                        <div key={item.id} style={{ position: "relative" }}>
                          <div onClick={() => toggleTask(item.id)}
                            style={{ display: "flex", alignItems: "center", gap: 10, padding: "9px 0", borderBottom: "1px solid rgba(255,255,255,0.04)", cursor: "pointer" }}>
                            <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${isDone ? vent.color : "rgba(255,255,255,0.18)"}`, background: isDone ? vent.color : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0, transition: "all 0.2s" }}>{isDone && "âœ“"}</div>
                            <div style={{ flex: 1 }}>
                              <div style={{ fontSize: 13, color: isDone ? "rgba(255,255,255,0.35)" : "#fff", textDecoration: isDone ? "line-through" : "none" }}>{item.label}</div>
                              {item.cadence && <div style={{ fontSize: 10, color: "rgba(255,255,255,0.25)", marginTop: 1 }}>{item.cadence}</div>}
                            </div>
                            <button onClick={e => { e.stopPropagation(); setShowDatePicker(showDatePicker === item.id ? null : item.id); }}
                              style={{ fontSize: 10, padding: "4px 8px", borderRadius: 8, background: scheduled ? "rgba(201,162,39,0.15)" : "rgba(255,255,255,0.05)", border: "1px solid rgba(255,255,255,0.1)", color: scheduled ? "#c9a227" : "rgba(255,255,255,0.4)", cursor: "pointer", flexShrink: 0 }}>
                              ðŸ“… {scheduled ? new Date(scheduled + "T12:00:00").toLocaleDateString("en-US", { month: "short", day: "numeric" }) : "Plan"}
                            </button>
                          </div>
                          {showDatePicker === item.id && (
                            <div style={{ position: "absolute", right: 0, top: "100%", zIndex: 1000, background: "#0a0a12", border: "1px solid rgba(201,162,39,0.3)", borderRadius: 12, padding: 12, marginTop: 4, boxShadow: "0 8px 24px rgba(0,0,0,0.5)" }}>
                              <input type="date" value={scheduled || ""} 
                                onChange={e => scheduleTask(item.id, e.target.value, item.label)}
                                style={{ fontSize: 12, padding: "6px" }} />
                              {scheduled && (
                                <button onClick={e => { e.stopPropagation(); scheduleTask(item.id, "", item.label); }} 
                                  style={{ marginLeft: 8, fontSize: 11, padding: "4px 8px", background: "rgba(255,107,107,0.2)", border: "1px solid rgba(255,107,107,0.3)", borderRadius: 6, color: "#ff6b6b", cursor: "pointer" }}>Clear</button>
                              )}
                            </div>
                          )}
                        </div>
                      );
                    })}
                    <div style={{ display: "flex", gap: 8, marginTop: 10 }}>
                      <input placeholder="Add taskâ€¦" value={newTaskText[vent.id] || ""} onChange={e => setNewTaskText(p => ({ ...p, [vent.id]: e.target.value }))}
                        onKeyDown={e => e.key === "Enter" && addTask(vent.id, newTaskText[vent.id] || "")}
                        style={{ flex: 1, fontSize: 12, padding: "8px 10px" }} />
                      <button onClick={() => addTask(vent.id, newTaskText[vent.id] || "")}
                        style={{ background: vent.color, border: "none", borderRadius: 8, padding: "8px 12px", fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 12, color: "#000", cursor: "pointer" }}>+</button>
                    </div>
                  </div>
                )}
              </div>
            );
          })}

          {/* Next Actions */}
          <div style={{ marginTop: 20, marginBottom: 20 }}>
            <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10 }}>NEXT ACTIONS</div>
            {[
              { id: "vent_crypto", label: "Research DeFi staking opportunities", cat: "Crypto" },
              { id: "vent_portfolio", label: "Rebalance portfolio allocation", cat: "Stocks" },
              { id: "vent_roth", label: "Max out Roth IRA contribution", cat: "Retirement" },
              { id: "vent_credit", label: "Optimize credit card rewards", cat: "Finance" },
            ].map(action => {
              const isDone = tasks[action.id]?.done;
              return (
                <div key={action.id} onClick={() => toggleTask(action.id)}
                  style={{ display: "flex", gap: 10, alignItems: "flex-start", padding: "11px 14px", background: isDone ? "rgba(255,255,255,0.02)" : "rgba(255,255,255,0.035)", border: `1px solid ${isDone ? "rgba(255,255,255,0.06)" : "rgba(255,255,255,0.09)"}`, borderRadius: 12, marginBottom: 7, cursor: "pointer", transition: "all 0.2s" }}>
                  <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${isDone ? "#34d399" : "rgba(255,255,255,0.2)"}`, background: isDone ? "#34d399" : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0, marginTop: 1 }}>{isDone && "âœ“"}</div>
                  <div>
                    <div style={{ fontSize: 12, color: isDone ? "rgba(255,255,255,0.3)" : "#fff", textDecoration: isDone ? "line-through" : "none", lineHeight: 1.4 }}>{action.label}</div>
                    <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)", marginTop: 2 }}>{action.cat}</div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      )}

      {/* â”€â”€ BUSINESS IDEAS â”€â”€ */}
      {section === "ideas" && (
        <div>
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 11, color: "rgba(255,255,255,0.3)", marginBottom: 16, lineHeight: 1.6 }}>
            "The best in the world have depth. They apply a mentality of granularity instead of a mindset of superficiality." â€” The 5AM Club
          </div>

          {["active", "developing", "researching", "idea"].map(stage => {
            const items = BUSINESS_IDEAS.filter(b => b.stage === stage);
            if (!items.length) return null;
            return (
              <div key={stage} style={{ marginBottom: 16 }}>
                <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.1em", color: stageColors[stage], marginBottom: 8, display: "flex", alignItems: "center", gap: 6 }}>
                  <div style={{ width: 7, height: 7, borderRadius: "50%", background: stageColors[stage] }} />
                  {stageLabels[stage].toUpperCase()} â€” {items.length} idea{items.length > 1 ? "s" : ""}
                </div>
                {items.map(biz => {
                  const isTracked = tasks["biz_" + biz.id]?.done;
                  const isFocused = ventureFocus?.activeId === ("biz_" + biz.id);
                  return (
                    <div key={biz.id} style={{ background: `${stageColors[biz.stage]}08`, border: `1px solid ${stageColors[biz.stage]}25`, borderRadius: 13, padding: "13px 14px", marginBottom: 8, display: "flex", alignItems: "center", gap: 12 }}>
                      <div style={{ fontSize: 24 }}>{biz.icon}</div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 700, fontSize: 13 }}>{biz.title}</div>
                        <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginTop: 1 }}>{biz.category}</div>
                        <div style={{ display: "inline-flex", alignItems: "center", gap: 4, marginTop: 5, background: `${stageColors[biz.stage]}18`, borderRadius: 10, padding: "2px 8px" }}>
                          <div style={{ width: 5, height: 5, borderRadius: "50%", background: stageColors[biz.stage] }} />
                          <span style={{ fontSize: 10, color: stageColors[biz.stage], fontWeight: 700 }}>{stageLabels[biz.stage]}</span>
                        </div>
                      </div>
                      <button onClick={(e) => { e.stopPropagation(); toggleVentureFocus("biz_" + biz.id); }}
                        style={{ padding: "6px 12px", borderRadius: 10, background: isFocused ? "rgba(201,162,39,0.2)" : "rgba(255,255,255,0.05)", border: `1px solid ${isFocused ? "#c9a227" : "rgba(255,255,255,0.15)"}`, color: isFocused ? "#c9a227" : "rgba(255,255,255,0.5)", fontSize: 11, fontWeight: 700, cursor: "pointer", flexShrink: 0 }}>
                        {isFocused ? "â˜… FOCUSED" : "Set Focus"}
                      </button>
                      <div onClick={() => toggleTask("biz_" + biz.id)} style={{ width: 28, height: 28, borderRadius: "50%", border: `2px solid ${isTracked ? "#34d399" : "rgba(255,255,255,0.15)"}`, background: isTracked ? "#34d399" : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 12, color: "#000", cursor: "pointer", flexShrink: 0 }}>{isTracked ? "âœ“" : "â˜…"}</div>
                    </div>
                  );
                })}
              </div>
            );
          })}

          {/* Next actions */}
          <div style={{ fontFamily: "'Syne', sans-serif", fontSize: 10, fontWeight: 700, letterSpacing: "0.12em", color: "rgba(255,255,255,0.25)", marginBottom: 10, marginTop: 6 }}>NEXT ACTIONS</div>
          {[
            { id: "bi_bluetooth_test", label: "Test SoundSeeder app for bluetooth speaker hub", biz: "Bluetooth app" },
            { id: "bi_snacks_research", label: "Research Super Snacks market & competitors", biz: "Super Snacks" },
            { id: "bi_cleanflops_proto", label: "Source UV sanitizer components for Clean Flops prototype", biz: "Clean Flops" },
            { id: "bi_consulting_niche", label: "Define consulting niche â€” cannabis/sales ops", biz: "Consulting" },
            { id: "bi_hemp_research", label: "Research hemp paper producer feasibility & capital", biz: "Hemp paper" },
            { id: "bi_eca_usp", label: "Write USP for Easy Custom Apparel", biz: "Easy Custom Apparel" },
          ].map(action => {
            const isDone = tasks[action.id]?.done;
            return (
              <div key={action.id} onClick={() => toggleTask(action.id)}
                style={{ display: "flex", gap: 10, alignItems: "flex-start", padding: "11px 14px", background: isDone ? "rgba(255,255,255,0.02)" : "rgba(255,255,255,0.035)", border: `1px solid ${isDone ? "rgba(255,255,255,0.06)" : "rgba(255,255,255,0.09)"}`, borderRadius: 12, marginBottom: 7, cursor: "pointer", transition: "all 0.2s" }}>
                <div style={{ width: 20, height: 20, borderRadius: "50%", border: `2px solid ${isDone ? "#34d399" : "rgba(255,255,255,0.2)"}`, background: isDone ? "#34d399" : "transparent", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 10, color: "#000", flexShrink: 0, marginTop: 1 }}>{isDone && "âœ“"}</div>
                <div>
                  <div style={{ fontSize: 12, color: isDone ? "rgba(255,255,255,0.3)" : "#fff", textDecoration: isDone ? "line-through" : "none", lineHeight: 1.4 }}>{action.label}</div>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)", marginTop: 2 }}>{action.biz}</div>
                </div>
              </div>
            );
          })}

          {/* Active Focus Panel */}
          {ventureFocus?.activeId && (() => {
            const vid = ventureFocus.activeId;
            const venture = ventureFocus.ventures[vid] || { status: "idea", notes: [], reading: [] };
            const bizItem = BUSINESS_IDEAS.find(b => "biz_" + b.id === vid);
            return (
              <div style={{ marginTop: 20, background: "rgba(201,162,39,0.08)", border: "2px solid rgba(201,162,39,0.3)", borderRadius: 16, padding: "16px" }}>
                <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
                  <div>
                    <div style={{ fontSize: 11, color: "#c9a227", fontWeight: 700, letterSpacing: "0.1em" }}>â˜… ACTIVE FOCUS</div>
                    <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 18, marginTop: 2 }}>{bizItem?.icon} {bizItem?.label}</div>
                  </div>
                  <button onClick={() => toggleVentureFocus(vid)} style={{ fontSize: 11, padding: "6px 12px", borderRadius: 8, background: "rgba(255,255,255,0.1)", border: "none", color: "rgba(255,255,255,0.6)", cursor: "pointer" }}>Clear</button>
                </div>
                <div style={{ marginBottom: 12 }}>
                  <div style={{ fontSize: 10, color: "rgba(255,255,255,0.4)", marginBottom: 6 }}>Status</div>
                  <select value={venture.status} onChange={e => updateVentureData(vid, { status: e.target.value })}
                    style={{ width: "100%", fontSize: 13, padding: "8px 12px" }}>
                    <option value="idea">Idea</option>
                    <option value="researching">Researching</option>
                    <option value="developing">Developing</option>
                    <option value="building">Building</option>
                    <option value="active">Active</option>
                  </select>
                </div>
                <div style={{ marginBottom: 12 }}>
                  <div style={{ fontSize: 10, fontWeight: 700, color: "rgba(255,255,255,0.4)", marginBottom: 6 }}>NOTES</div>
                  {(venture.notes || []).map((note, i) => (
                    <div key={i} style={{ fontSize: 12, padding: "8px", background: "rgba(255,255,255,0.03)", borderRadius: 8, marginBottom: 4 }}>
                      <div style={{ fontSize: 10, color: "rgba(255,255,255,0.3)" }}>{note.date}</div>
                      <div>{note.text}</div>
                    </div>
                  ))}
                  <button onClick={() => {
                    const text = prompt("Add note:");
                    if (text) updateVentureData(vid, { notes: [...(venture.notes || []), { date: todayStr(), text }] });
                  }} style={{ fontSize: 11, padding: "6px 12px", marginTop: 4 }}>+ Note</button>
                </div>
                <div>
                  <div style={{ fontSize: 10, fontWeight: 700, color: "rgba(255,255,255,0.4)", marginBottom: 6 }}>READING</div>
                  {(venture.reading || []).map((item, i) => (
                    <div key={i} style={{ display: "flex", gap: 8, marginBottom: 4 }}>
                      <input type="checkbox" checked={item.completed} onChange={() => {
                        const u = [...venture.reading]; u[i].completed = !u[i].completed;
                        updateVentureData(vid, { reading: u });
                      }} />
                      <span style={{ fontSize: 12, textDecoration: item.completed ? "line-through" : "none" }}>{item.title}</span>
                    </div>
                  ))}
                  <button onClick={() => {
                    const title = prompt("Reading:");
                    if (title) updateVentureData(vid, { reading: [...(venture.reading || []), { title, completed: false }] });
                  }} style={{ fontSize: 11, padding: "6px 12px", marginTop: 4 }}>+ Reading</button>
                </div>
              </div>
            );
          })()}
        </div>
      )}


    </div>
  );
}

  </script>
  
  <script type="text/babel">
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>